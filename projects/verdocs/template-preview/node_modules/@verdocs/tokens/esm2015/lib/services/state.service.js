/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable, Injector, Inject, PLATFORM_ID } from '@angular/core';
import { isPlatformBrowser } from '@angular/common';
import { HttpClient } from '@angular/common/http';
import { CookieService } from 'ngx-cookie';
import { JwtHelperService } from '@auth0/angular-jwt';
import { VTokenConfigToken } from '../tokens.module';
import { ReplaySubject, interval } from 'rxjs';
import { map } from 'rxjs/operators';
import * as i0 from "@angular/core";
import * as i1 from "ngx-cookie";
import * as i2 from "@angular/common/http";
/** @type {?} */
const helper = new JwtHelperService();
export class VerdocsStateService {
    /**
     * @param {?} cookieService
     * @param {?} http
     * @param {?} injector
     * @param {?} platform
     */
    constructor(cookieService, http, injector, platform) {
        this.cookieService = cookieService;
        this.http = http;
        this.injector = injector;
        this.platform = platform;
        this.timerActive = false;
        this.cookieConfig = {
            path: '/',
            domain: 'localhost',
            secure: false
        };
        this.accessList = [];
        this.decodedIdTokenSubject = new ReplaySubject();
        this.tokenConfig = this.injector.get(VTokenConfigToken);
        this.domain = this.tokenConfig.domain;
        this.init();
    }
    /**
     * @return {?}
     */
    init() {
        if (this.tokenConfig.loginURL) {
            this.loginURL = this.tokenConfig.loginURL;
        }
        if (this.tokenConfig.cookieName) {
            this.cookieName = this.tokenConfig.cookieName;
        }
        else if (this.tokenConfig.origin) {
            this.cookieName = this.tokenConfig.origin + VerdocsStateService.COOKIE_NAME_SUFFIX;
        }
        this.production = this.tokenConfig.production || false;
        this.cookieConfig.domain = this.getDomain();
        if (this.tokenConfig.production) {
            this.cookieConfig.secure = true;
        }
        this.getAccessList();
    }
    /**
     * @return {?}
     */
    getDomain() {
        if (this.production || this.domain !== 'localhost') {
            /** @type {?} */
            const address = this.domain.split('.');
            return '.' + address[address.length - 2] + '.' + address[address.length - 1];
        }
        else {
            return 'localhost';
        }
    }
    /**
     * @return {?}
     */
    watchAuthentication() {
        if (isPlatformBrowser(this.platform)) {
            if (!this.timerActive) {
                this.timerActive = true;
                this.authenticationWatcher = interval(15000).subscribe((/**
                 * @return {?}
                 */
                () => {
                    this.getAccessList();
                    if ((this.accessList.indexOf(VerdocsStateService.RACCOUNT_COOKIE_NAME) === -1 || this.accessList.indexOf(this.cookieName) === -1)) {
                        this.cookieService.removeAll();
                        window.location.href = this.getLoginURL();
                    }
                    ;
                }));
            }
        }
    }
    /**
     * @return {?}
     */
    endWatchAuthentication() {
        this.authenticationWatcher.unsubscribe();
    }
    /**
     * @return {?}
     */
    getAccountCookieObject() {
        if (isPlatformBrowser(this.platform)) {
            /** @type {?} */
            const cookie_prefix = this.tokenConfig.account_name || 'rAccount';
            /** @type {?} */
            const cookie_name = cookie_prefix + VerdocsStateService.COOKIE_NAME_SUFFIX;
            /** @type {?} */
            const cookie = this.getOtherCookieObject(cookie_name);
            return cookie;
        }
    }
    /**
     * @return {?}
     */
    getVerdocsCookieObject() {
        if (isPlatformBrowser(this.platform)) {
            /** @type {?} */
            const cookie_prefix = this.tokenConfig.verdocs_name || 'rForm';
            /** @type {?} */
            const cookie_name = cookie_prefix + VerdocsStateService.COOKIE_NAME_SUFFIX;
            /** @type {?} */
            const cookie = this.getOtherCookieObject(cookie_name);
            return cookie;
        }
    }
    /**
     * @return {?}
     */
    getAccessToken() {
        if (isPlatformBrowser(this.platform)) {
            if (this.cookieName) {
                /** @type {?} */
                const cookie = this.getOtherCookieObject(this.cookieName);
                if (cookie && cookie[VerdocsStateService.ACCESS_TOKEN_NAME]) {
                    this.accessToken = cookie[VerdocsStateService.ACCESS_TOKEN_NAME];
                    return this.accessToken;
                }
            }
        }
        return null;
    }
    /**
     * @return {?}
     */
    getVerdocsAccessToken() {
        if (isPlatformBrowser(this.platform)) {
            /** @type {?} */
            const cookie = this.getVerdocsCookieObject();
            if (cookie && cookie[VerdocsStateService.ACCESS_TOKEN_NAME]) {
                this.accessToken = cookie[VerdocsStateService.ACCESS_TOKEN_NAME];
                return this.accessToken;
            }
        }
    }
    /**
     * @return {?}
     */
    getAccountAccessToken() {
        if (isPlatformBrowser(this.platform)) {
            /** @type {?} */
            const cookie = this.getAccountCookieObject();
            if (cookie && cookie[VerdocsStateService.ACCESS_TOKEN_NAME]) {
                this.accessToken = cookie[VerdocsStateService.ACCESS_TOKEN_NAME];
                return this.accessToken;
            }
        }
    }
    /**
     * @return {?}
     */
    getIDToken() {
        if (isPlatformBrowser(this.platform)) {
            /** @type {?} */
            const cookie = this.getAccountCookieObject();
            if (cookie && cookie[VerdocsStateService.ID_TOKEN_NAME]) {
                this.idToken = cookie[VerdocsStateService.ID_TOKEN_NAME];
                this.decodedIdTokenSubject.next(helper.decodeToken(this.idToken));
                return this.idToken;
            }
        }
        return null;
    }
    /**
     * @return {?}
     */
    getLoginURL() {
        return this.loginURL;
    }
    /**
     * @param {?} state
     * @return {?}
     */
    setTimer(state) {
        this.timerActive = state;
    }
    /**
     * @return {?}
     */
    getUserId() {
        /** @type {?} */
        const idToken = this.getIDToken();
        if (!!idToken) {
            /** @type {?} */
            const idTokenContent = this.tokenToObject(idToken);
            if (idTokenContent['sub']) {
                return idTokenContent['sub'].replace('auth0|', '');
            }
            return null;
        }
        return;
    }
    /**
     * @param {?=} appName
     * @return {?}
     */
    getAppUserId(appName) {
        if (isPlatformBrowser(this.platform)) {
            if (!appName) {
                appName = VerdocsStateService.RACCOUNT_COOKIE_NAME;
            }
            /** @type {?} */
            const cookie = this.cookieService.getObject(appName);
            /** @type {?} */
            let idToken;
            if (cookie && cookie[VerdocsStateService.ID_TOKEN_NAME]) {
                idToken = cookie[VerdocsStateService.ID_TOKEN_NAME];
                /** @type {?} */
                const idTokenContent = this.tokenToObject(idToken);
                if (idTokenContent['sub']) {
                    return idTokenContent['sub'].replace('auth0|', '');
                }
            }
            return null;
        }
        return;
    }
    /**
     * @param {?} key
     * @param {?} value
     * @param {?=} cookieName
     * @return {?}
     */
    updateCookie(key, value, cookieName) {
        if (isPlatformBrowser(this.platform)) {
            /** @type {?} */
            const cName = cookieName ? cookieName : this.cookieName;
            this.cookieConfig.domain = this.getDomain();
            if (window && window.location && location.protocol === 'https:') {
                this.cookieConfig.secure = true;
            }
            /** @type {?} */
            let rAccountCookie = this.getrAccountCookieObject();
            /** @type {?} */
            let otherCookie = this.getOtherCookieObject(cName);
            /** @type {?} */
            let cookie;
            if (!!cName && !!key && !!value) {
                if (cName === VerdocsStateService.RACCOUNT_COOKIE_NAME && !!rAccountCookie) {
                    rAccountCookie[key] = value;
                    cookie = rAccountCookie;
                }
                else if (!!otherCookie) {
                    otherCookie[key] = value;
                    cookie = otherCookie;
                }
                this.cookieService.putObject(cName, cookie, this.cookieConfig);
            }
        }
    }
    /**
     * @param {?} rSecureBackend
     * @return {?}
     */
    updateTokens(rSecureBackend) {
        if (isPlatformBrowser(this.platform)) {
            return this.getTokens(rSecureBackend).pipe(map((/**
             * @param {?} tokens
             * @return {?}
             */
            (tokens) => {
                for (let x = 0; x < tokens.length; x++) {
                    if (tokens[x].clientName === 'rAccount') {
                        this.updateCookie(VerdocsStateService.ID_TOKEN_NAME, tokens[x].idToken, tokens[x].clientName + VerdocsStateService.COOKIE_NAME_SUFFIX);
                        this.decodedIdTokenSubject.next(helper.decodeToken(tokens[x].idToken));
                    }
                    this.updateCookie(VerdocsStateService.ACCESS_TOKEN_NAME, tokens[x].accessToken, tokens[x].clientName + VerdocsStateService.COOKIE_NAME_SUFFIX);
                }
                return tokens;
            })));
        }
    }
    /**
     * @return {?}
     */
    hasCookie() {
        return !!this.cookieService.get(this.cookieName);
    }
    /**
     * @return {?}
     */
    getAccessList() {
        if (isPlatformBrowser(this.platform)) {
            this.getAllCookies();
            this.accessList = [];
            for (const cookie in this.cookies) {
                if (cookie.indexOf(VerdocsStateService.COOKIE_NAME_SUFFIX) !== -1) {
                    this.accessList.push(cookie);
                }
            }
            return this.accessList;
        }
    }
    /**
     * @return {?}
     */
    getEmailVerification() {
        if (isPlatformBrowser(this.platform)) {
            /** @type {?} */
            const idToken = this.getIDToken();
            if (!!idToken) {
                /** @type {?} */
                const idTokenContent = this.tokenToObject(idToken);
                return idTokenContent['email_verified'];
            }
            return false;
        }
    }
    /**
     * @param {?} clientName
     * @return {?}
     */
    hasAccessTo(clientName) {
        return this.accessList.indexOf(clientName) !== -1;
    }
    /**
     * @param {?} key
     * @param {?} value
     * @return {?}
     */
    storeOtherCookie(key, value) {
        if (isPlatformBrowser(this.platform)) {
            this.setCookie(key, value);
        }
    }
    /**
     * @param {?} key
     * @return {?}
     */
    getOtherCookie(key) {
        if (isPlatformBrowser(this.platform)) {
            try {
                if (key) {
                    /** @type {?} */
                    const value = this.cookieService.getObject(key);
                    return value;
                }
                else {
                    return null;
                }
            }
            catch (err) {
                console.error('Cannot return cookie:', err);
                return null;
            }
        }
    }
    /**
     * @param {?} key
     * @return {?}
     */
    getRCookie(key) {
        if (isPlatformBrowser(this.platform)) {
            return this.cookieService.get(key);
        }
    }
    /**
     * @param {?} key
     * @return {?}
     */
    getOtherCookieObject(key) {
        try {
            if (!!key) {
                if (isPlatformBrowser(this.platform)) {
                    return this.cookieService.getObject(key);
                }
            }
            return null;
        }
        catch (err) {
            if (key !== VerdocsStateService.SIGNER_TOKEN_COOKIE_NAME) {
                console.error('Cannot get cookie: ', err);
            }
            return null;
        }
    }
    /**
     * @param {?} key
     * @return {?}
     */
    removeRCookie(key) {
        if (isPlatformBrowser(this.platform)) {
            this.cookieService.remove(key, this.cookieConfig);
        }
    }
    /**
     * @return {?}
     */
    removeRCookies() {
        if (isPlatformBrowser(this.platform)) {
            if (this.accessList.length > 0) {
                for (const key of this.accessList) {
                    this.removeRCookie(key);
                }
            }
            ;
        }
    }
    /**
     * @return {?}
     */
    removeIntercomCookie() {
        if (isPlatformBrowser(this.platform)) {
            for (const cookie in this.cookies) {
                if (cookie.indexOf('intercom') !== -1) {
                    this.removeRCookie(cookie);
                }
            }
        }
    }
    /**
     * @param {?} tokens
     * @return {?}
     */
    setTokens(tokens) {
        if (isPlatformBrowser(this.platform)) {
            if (tokens && tokens.length > 0) {
                for (const token of tokens) {
                    if (token.clientName === 'rAccount') {
                        this.updateCookie(VerdocsStateService.ID_TOKEN_NAME, token.idToken, token.clientName + VerdocsStateService.COOKIE_NAME_SUFFIX);
                        this.decodedIdTokenSubject.next(helper.decodeToken(token.idToken));
                    }
                    this.updateCookie(VerdocsStateService.ACCESS_TOKEN_NAME, token.accessToken, token.clientName + VerdocsStateService.COOKIE_NAME_SUFFIX);
                }
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    getrAccountCookieObject() {
        if (isPlatformBrowser(this.platform)) {
            try {
                if (this.cookieName && this.cookieService.get(VerdocsStateService.RACCOUNT_COOKIE_NAME)) {
                    /** @type {?} */
                    const cookie = this.cookieService.getObject(VerdocsStateService.RACCOUNT_COOKIE_NAME);
                    return cookie;
                }
                return null;
            }
            catch (err) {
                return null;
            }
        }
    }
    /**
     * @private
     * @return {?}
     */
    getAllCookies() {
        if (isPlatformBrowser(this.platform)) {
            this.cookies = this.cookieService.getAll();
        }
    }
    /**
     * @private
     * @param {?} token
     * @return {?}
     */
    tokenToObject(token) {
        if (token) {
            /** @type {?} */
            const base64Url = token.split('.')[1];
            /** @type {?} */
            var base64 = base64Url.replace('-', '+').replace('_', '/');
            return JSON.parse(window.atob(base64));
        }
        return null;
    }
    /**
     * @private
     * @param {?} cookieName
     * @param {?} cookieValue
     * @return {?}
     */
    setCookie(cookieName, cookieValue) {
        if (isPlatformBrowser(this.platform)) {
            this.cookieService.put(cookieName, cookieValue, this.cookieConfig);
        }
    }
    /**
     * @private
     * @param {?} rSecureBackend
     * @return {?}
     */
    getTokens(rSecureBackend) {
        return this.http.get(rSecureBackend + '/token');
    }
    /**
     * @return {?}
     */
    getRAccountRoles() {
        if (isPlatformBrowser(this.platform)) {
            /** @type {?} */
            const cookie = this.cookieService.getObject(VerdocsStateService.RACCOUNT_COOKIE_NAME);
            if (!!cookie) {
                try {
                    /** @type {?} */
                    const accessToken = cookie[VerdocsStateService.ACCESS_TOKEN_NAME];
                    /** @type {?} */
                    const tokenObject = this.tokenToObject(accessToken);
                    return tokenObject[`${VerdocsStateService.TOKEN_NAMESPACE}/roles`];
                }
                catch (err) {
                    console.error(err);
                }
            }
            else {
                return null;
            }
        }
    }
    /**
     * @return {?}
     */
    getPlans() {
        if (isPlatformBrowser(this.platform)) {
            /** @type {?} */
            const cookie = this.cookieService.getObject(VerdocsStateService.RACCOUNT_COOKIE_NAME);
            if (!!cookie) {
                try {
                    /** @type {?} */
                    const accessToken = cookie[VerdocsStateService.ACCESS_TOKEN_NAME];
                    /** @type {?} */
                    const tokenObject = this.tokenToObject(accessToken);
                    return tokenObject[`${VerdocsStateService.TOKEN_NAMESPACE}/plans`];
                }
                catch (err) {
                    console.error(err);
                }
            }
            else {
                return null;
            }
        }
    }
}
VerdocsStateService.RACCOUNT_COOKIE_NAME = 'rAccount_Verdocs';
VerdocsStateService.SIGNER_TOKEN_COOKIE_NAME = 'signer_token';
VerdocsStateService.COOKIE_NAME_SUFFIX = '_Verdocs';
VerdocsStateService.ACCESS_TOKEN_NAME = 'accessToken';
VerdocsStateService.ID_TOKEN_NAME = 'idToken';
VerdocsStateService.TOKEN_NAMESPACE = 'https://verdocs.com';
VerdocsStateService.decorators = [
    { type: Injectable, args: [{
                providedIn: "root"
            },] }
];
/** @nocollapse */
VerdocsStateService.ctorParameters = () => [
    { type: CookieService },
    { type: HttpClient },
    { type: Injector },
    { type: undefined, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] }
];
/** @nocollapse */ VerdocsStateService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function VerdocsStateService_Factory() { return new VerdocsStateService(i0.ɵɵinject(i1.CookieService), i0.ɵɵinject(i2.HttpClient), i0.ɵɵinject(i0.INJECTOR), i0.ɵɵinject(i0.PLATFORM_ID)); }, token: VerdocsStateService, providedIn: "root" });
if (false) {
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.RACCOUNT_COOKIE_NAME;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.SIGNER_TOKEN_COOKIE_NAME;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.COOKIE_NAME_SUFFIX;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.ACCESS_TOKEN_NAME;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.ID_TOKEN_NAME;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.TOKEN_NAMESPACE;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.loginURL;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.cookieName;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.production;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.accessToken;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.idToken;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.timerActive;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.domain;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.cookieConfig;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.cookies;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.tokenConfig;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.authenticationWatcher;
    /** @type {?} */
    VerdocsStateService.prototype.accessList;
    /** @type {?} */
    VerdocsStateService.prototype.decodedIdTokenSubject;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.cookieService;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    VerdocsStateService.prototype.platform;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhdGUuc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B2ZXJkb2NzL3Rva2Vucy8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy9zdGF0ZS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzFFLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQ3BELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUNsRCxPQUFPLEVBQUUsYUFBYSxFQUFpQixNQUFNLFlBQVksQ0FBQztBQUMxRCxPQUFPLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxvQkFBb0IsQ0FBQztBQUN0RCxPQUFPLEVBQUUsaUJBQWlCLEVBQWdCLE1BQU0sa0JBQWtCLENBQUM7QUFDbkUsT0FBTyxFQUFFLGFBQWEsRUFBZ0IsUUFBUSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzdELE9BQU8sRUFBRSxHQUFHLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQzs7Ozs7TUFFL0IsTUFBTSxHQUFHLElBQUksZ0JBQWdCLEVBQUU7QUFLckMsTUFBTSxPQUFPLG1CQUFtQjs7Ozs7OztJQTJCOUIsWUFDVSxhQUE0QixFQUM1QixJQUFnQixFQUNoQixRQUFrQixFQUNHLFFBQVE7UUFIN0Isa0JBQWEsR0FBYixhQUFhLENBQWU7UUFDNUIsU0FBSSxHQUFKLElBQUksQ0FBWTtRQUNoQixhQUFRLEdBQVIsUUFBUSxDQUFVO1FBQ0csYUFBUSxHQUFSLFFBQVEsQ0FBQTtRQWxCL0IsZ0JBQVcsR0FBRyxLQUFLLENBQUM7UUFFcEIsaUJBQVksR0FBa0I7WUFDcEMsSUFBSSxFQUFFLEdBQUc7WUFDVCxNQUFNLEVBQUUsV0FBVztZQUNuQixNQUFNLEVBQUUsS0FBSztTQUNkLENBQUE7UUFLTSxlQUFVLEdBQWEsRUFBRSxDQUFDO1FB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Ozs7OztJQUNELHNDQUFnQjs7Ozs7SUFDaEIsMENBQWlDOzs7OztJQUNqQyxvREFBNEM7O0lBRTVDLHlDQUFpQzs7SUFDakMsb0RBQXdEOzs7OztJQUd0RCw0Q0FBb0M7Ozs7O0lBQ3BDLG1DQUF3Qjs7Ozs7SUFDeEIsdUNBQTBCOzs7OztJQUMxQix1Q0FBcUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlLCBJbmplY3RvciwgSW5qZWN0LCBQTEFURk9STV9JRCB9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgaXNQbGF0Zm9ybUJyb3dzZXIgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHsgSHR0cENsaWVudCB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbi9odHRwJztcbmltcG9ydCB7IENvb2tpZVNlcnZpY2UsIENvb2tpZU9wdGlvbnMgfSBmcm9tICduZ3gtY29va2llJztcbmltcG9ydCB7IEp3dEhlbHBlclNlcnZpY2UgfSBmcm9tICdAYXV0aDAvYW5ndWxhci1qd3QnO1xuaW1wb3J0IHsgVlRva2VuQ29uZmlnVG9rZW4sIFZUb2tlbkNvbmZpZyB9IGZyb20gJy4uL3Rva2Vucy5tb2R1bGUnO1xuaW1wb3J0IHsgUmVwbGF5U3ViamVjdCwgU3Vic2NyaXB0aW9uLCBpbnRlcnZhbCB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgbWFwIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuXG5jb25zdCBoZWxwZXIgPSBuZXcgSnd0SGVscGVyU2VydmljZSgpO1xuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46IFwicm9vdFwiXG59KVxuZXhwb3J0IGNsYXNzIFZlcmRvY3NTdGF0ZVNlcnZpY2Uge1xuICBwcml2YXRlIHN0YXRpYyBSQUNDT1VOVF9DT09LSUVfTkFNRSA9ICdyQWNjb3VudF9WZXJkb2NzJztcbiAgcHJpdmF0ZSBzdGF0aWMgU0lHTkVSX1RPS0VOX0NPT0tJRV9OQU1FID0gJ3NpZ25lcl90b2tlbidcbiAgcHJpdmF0ZSBzdGF0aWMgQ09PS0lFX05BTUVfU1VGRklYID0gJ19WZXJkb2NzJztcbiAgcHJpdmF0ZSBzdGF0aWMgQUNDRVNTX1RPS0VOX05BTUUgPSAnYWNjZXNzVG9rZW4nO1xuICBwcml2YXRlIHN0YXRpYyBJRF9UT0tFTl9OQU1FID0gJ2lkVG9rZW4nO1xuICBwcml2YXRlIHN0YXRpYyBUT0tFTl9OQU1FU1BBQ0UgPSAnaHR0cHM6Ly92ZXJkb2NzLmNvbSc7XG5cbiAgcHJpdmF0ZSBsb2dpblVSTDogc3RyaW5nO1xuICBwcml2YXRlIGNvb2tpZU5hbWU6IHN0cmluZztcbiAgcHJpdmF0ZSBwcm9kdWN0aW9uOiBib29sZWFuO1xuICBwcml2YXRlIGFjY2Vzc1Rva2VuOiBzdHJpbmc7XG4gIHByaXZhdGUgaWRUb2tlbjogc3RyaW5nO1xuICBwcml2YXRlIHRpbWVyQWN0aXZlID0gZmFsc2U7XG4gIHByaXZhdGUgZG9tYWluOiBzdHJpbmc7XG4gIHByaXZhdGUgY29va2llQ29uZmlnOiBDb29raWVPcHRpb25zID0ge1xuICAgIHBhdGg6ICcvJyxcbiAgICBkb21haW46ICdsb2NhbGhvc3QnLFxuICAgIHNlY3VyZTogZmFsc2VcbiAgfVxuICBwcml2YXRlIGNvb2tpZXM7XG4gIHByaXZhdGUgdG9rZW5Db25maWc6IFZUb2tlbkNvbmZpZ1xuICBwcml2YXRlIGF1dGhlbnRpY2F0aW9uV2F0Y2hlcjogU3Vic2NyaXB0aW9uO1xuXG4gIHB1YmxpYyBhY2Nlc3NMaXN0OiBzdHJpbmdbXSA9IFtdO1xuICBwdWJsaWMgZGVjb2RlZElkVG9rZW5TdWJqZWN0ID0gbmV3IFJlcGxheVN1YmplY3Q8YW55PigpO1xuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgY29va2llU2VydmljZTogQ29va2llU2VydmljZSxcbiAgICBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQsXG4gICAgcHJpdmF0ZSBpbmplY3RvcjogSW5qZWN0b3IsXG4gICAgQEluamVjdChQTEFURk9STV9JRCkgcHJpdmF0ZSBwbGF0Zm9ybVxuICApIHtcbiAgICB0aGlzLnRva2VuQ29uZmlnID0gdGhpcy5pbmplY3Rvci5nZXQoVlRva2VuQ29uZmlnVG9rZW4pO1xuICAgIHRoaXMuZG9tYWluID0gdGhpcy50b2tlbkNvbmZpZy5kb21haW47XG4gICAgdGhpcy5pbml0KCk7XG5cbiAgfVxuXG4gIGluaXQoKSB7XG4gICAgaWYgKHRoaXMudG9rZW5Db25maWcubG9naW5VUkwpIHtcbiAgICAgIHRoaXMubG9naW5VUkwgPSB0aGlzLnRva2VuQ29uZmlnLmxvZ2luVVJMO1xuICAgIH1cbiAgICBpZiAodGhpcy50b2tlbkNvbmZpZy5jb29raWVOYW1lKSB7XG4gICAgICB0aGlzLmNvb2tpZU5hbWUgPSB0aGlzLnRva2VuQ29uZmlnLmNvb2tpZU5hbWU7XG4gICAgfSBlbHNlIGlmICh0aGlzLnRva2VuQ29uZmlnLm9yaWdpbikge1xuICAgICAgdGhpcy5jb29raWVOYW1lID0gdGhpcy50b2tlbkNvbmZpZy5vcmlnaW4gKyBWZXJkb2NzU3RhdGVTZXJ2aWNlLkNPT0tJRV9OQU1FX1NVRkZJWDtcbiAgICB9XG4gICAgdGhpcy5wcm9kdWN0aW9uID0gdGhpcy50b2tlbkNvbmZpZy5wcm9kdWN0aW9uIHx8IGZhbHNlO1xuICAgIHRoaXMuY29va2llQ29uZmlnLmRvbWFpbiA9IHRoaXMuZ2V0RG9tYWluKCk7XG4gICAgaWYgKHRoaXMudG9rZW5Db25maWcucHJvZHVjdGlvbikge1xuICAgICAgdGhpcy5jb29raWVDb25maWcuc2VjdXJlID0gdHJ1ZTtcbiAgICB9XG4gICAgdGhpcy5nZXRBY2Nlc3NMaXN0KCk7XG4gIH1cblxuICBnZXREb21haW4oKSB7XG4gICAgaWYgKHRoaXMucHJvZHVjdGlvbiB8fCB0aGlzLmRvbWFpbiAhPT0gJ2xvY2FsaG9zdCcpIHtcbiAgICAgIGNvbnN0IGFkZHJlc3MgPSB0aGlzLmRvbWFpbi5zcGxpdCgnLicpO1xuICAgICAgcmV0dXJuICcuJyArIGFkZHJlc3NbYWRkcmVzcy5sZW5ndGggLSAyXSArICcuJyArIGFkZHJlc3NbYWRkcmVzcy5sZW5ndGggLSAxXTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICdsb2NhbGhvc3QnO1xuICAgIH1cbiAgfVxuXG4gIHdhdGNoQXV0aGVudGljYXRpb24oKSB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm0pKSB7XG4gICAgICBpZiAoIXRoaXMudGltZXJBY3RpdmUpIHtcbiAgICAgICAgdGhpcy50aW1lckFjdGl2ZSA9IHRydWU7XG4gICAgICAgIHRoaXMuYXV0aGVudGljYXRpb25XYXRjaGVyID0gaW50ZXJ2YWwoMTUwMDApLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICAgICAgdGhpcy5nZXRBY2Nlc3NMaXN0KCk7XG4gICAgICAgICAgaWYgKCh0aGlzLmFjY2Vzc0xpc3QuaW5kZXhPZihWZXJkb2NzU3RhdGVTZXJ2aWNlLlJBQ0NPVU5UX0NPT0tJRV9OQU1FKSA9PT0gLTEgfHwgdGhpcy5hY2Nlc3NMaXN0LmluZGV4T2YodGhpcy5jb29raWVOYW1lKSA9PT0gLTEpKSB7XG4gICAgICAgICAgICB0aGlzLmNvb2tpZVNlcnZpY2UucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IHRoaXMuZ2V0TG9naW5VUkwoKTtcbiAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBlbmRXYXRjaEF1dGhlbnRpY2F0aW9uKCkge1xuICAgIHRoaXMuYXV0aGVudGljYXRpb25XYXRjaGVyLnVuc3Vic2NyaWJlKCk7XG4gIH1cblxuICBnZXRBY2NvdW50Q29va2llT2JqZWN0KCkge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgY29uc3QgY29va2llX3ByZWZpeCA9IHRoaXMudG9rZW5Db25maWcuYWNjb3VudF9uYW1lIHx8ICdyQWNjb3VudCc7XG4gICAgICBjb25zdCBjb29raWVfbmFtZSA9IGNvb2tpZV9wcmVmaXggKyBWZXJkb2NzU3RhdGVTZXJ2aWNlLkNPT0tJRV9OQU1FX1NVRkZJWDtcbiAgICAgIGNvbnN0IGNvb2tpZSA9IHRoaXMuZ2V0T3RoZXJDb29raWVPYmplY3QoY29va2llX25hbWUpO1xuICAgICAgcmV0dXJuIGNvb2tpZTtcbiAgICB9XG4gIH1cbiAgZ2V0VmVyZG9jc0Nvb2tpZU9iamVjdCgpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIGNvbnN0IGNvb2tpZV9wcmVmaXggPSB0aGlzLnRva2VuQ29uZmlnLnZlcmRvY3NfbmFtZSB8fCAnckZvcm0nO1xuICAgICAgY29uc3QgY29va2llX25hbWUgPSBjb29raWVfcHJlZml4ICsgVmVyZG9jc1N0YXRlU2VydmljZS5DT09LSUVfTkFNRV9TVUZGSVg7XG4gICAgICBjb25zdCBjb29raWUgPSB0aGlzLmdldE90aGVyQ29va2llT2JqZWN0KGNvb2tpZV9uYW1lKTtcbiAgICAgIHJldHVybiBjb29raWU7XG4gICAgfVxuICB9XG5cbiAgZ2V0QWNjZXNzVG9rZW4oKSB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm0pKSB7XG4gICAgICBpZiAodGhpcy5jb29raWVOYW1lKSB7XG4gICAgICAgIGNvbnN0IGNvb2tpZSA9IHRoaXMuZ2V0T3RoZXJDb29raWVPYmplY3QodGhpcy5jb29raWVOYW1lKTtcbiAgICAgICAgaWYgKGNvb2tpZSAmJiBjb29raWVbVmVyZG9jc1N0YXRlU2VydmljZS5BQ0NFU1NfVE9LRU5fTkFNRV0pIHtcbiAgICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gY29va2llW1ZlcmRvY3NTdGF0ZVNlcnZpY2UuQUNDRVNTX1RPS0VOX05BTUVdXG4gICAgICAgICAgcmV0dXJuIHRoaXMuYWNjZXNzVG9rZW47XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGdldFZlcmRvY3NBY2Nlc3NUb2tlbigpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIGNvbnN0IGNvb2tpZSA9IHRoaXMuZ2V0VmVyZG9jc0Nvb2tpZU9iamVjdCgpO1xuICAgICAgaWYgKGNvb2tpZSAmJiBjb29raWVbVmVyZG9jc1N0YXRlU2VydmljZS5BQ0NFU1NfVE9LRU5fTkFNRV0pIHtcbiAgICAgICAgdGhpcy5hY2Nlc3NUb2tlbiA9IGNvb2tpZVtWZXJkb2NzU3RhdGVTZXJ2aWNlLkFDQ0VTU19UT0tFTl9OQU1FXTtcbiAgICAgICAgcmV0dXJuIHRoaXMuYWNjZXNzVG9rZW47XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0QWNjb3VudEFjY2Vzc1Rva2VuKCkge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgY29uc3QgY29va2llID0gdGhpcy5nZXRBY2NvdW50Q29va2llT2JqZWN0KCk7XG4gICAgICBpZiAoY29va2llICYmIGNvb2tpZVtWZXJkb2NzU3RhdGVTZXJ2aWNlLkFDQ0VTU19UT0tFTl9OQU1FXSkge1xuICAgICAgICB0aGlzLmFjY2Vzc1Rva2VuID0gY29va2llW1ZlcmRvY3NTdGF0ZVNlcnZpY2UuQUNDRVNTX1RPS0VOX05BTUVdO1xuICAgICAgICByZXR1cm4gdGhpcy5hY2Nlc3NUb2tlbjtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBnZXRJRFRva2VuKCkge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgY29uc3QgY29va2llID0gdGhpcy5nZXRBY2NvdW50Q29va2llT2JqZWN0KCk7XG4gICAgICBpZiAoY29va2llICYmIGNvb2tpZVtWZXJkb2NzU3RhdGVTZXJ2aWNlLklEX1RPS0VOX05BTUVdKSB7XG4gICAgICAgIHRoaXMuaWRUb2tlbiA9IGNvb2tpZVtWZXJkb2NzU3RhdGVTZXJ2aWNlLklEX1RPS0VOX05BTUVdXG4gICAgICAgIHRoaXMuZGVjb2RlZElkVG9rZW5TdWJqZWN0Lm5leHQoaGVscGVyLmRlY29kZVRva2VuKHRoaXMuaWRUb2tlbikpO1xuICAgICAgICByZXR1cm4gdGhpcy5pZFRva2VuO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGdldExvZ2luVVJMKCkge1xuICAgIHJldHVybiB0aGlzLmxvZ2luVVJMO1xuICB9XG5cbiAgc2V0VGltZXIoc3RhdGU6IGJvb2xlYW4pIHtcbiAgICB0aGlzLnRpbWVyQWN0aXZlID0gc3RhdGU7XG4gIH1cblxuICBwdWJsaWMgZ2V0VXNlcklkKCk6IHN0cmluZyB8IG51bGwge1xuICAgIGNvbnN0IGlkVG9rZW4gPSB0aGlzLmdldElEVG9rZW4oKTtcbiAgICBpZiAoISFpZFRva2VuKSB7XG4gICAgICBjb25zdCBpZFRva2VuQ29udGVudCA9IHRoaXMudG9rZW5Ub09iamVjdChpZFRva2VuKTtcbiAgICAgIGlmIChpZFRva2VuQ29udGVudFsnc3ViJ10pIHtcbiAgICAgICAgcmV0dXJuIGlkVG9rZW5Db250ZW50WydzdWInXS5yZXBsYWNlKCdhdXRoMHwnLCAnJyk7XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgcHVibGljIGdldEFwcFVzZXJJZChhcHBOYW1lPzogc3RyaW5nKTogc3RyaW5nIHwgbnVsbCB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm0pKSB7XG4gICAgICBpZiAoIWFwcE5hbWUpIHtcbiAgICAgICAgYXBwTmFtZSA9IFZlcmRvY3NTdGF0ZVNlcnZpY2UuUkFDQ09VTlRfQ09PS0lFX05BTUU7XG4gICAgICB9XG4gICAgICBjb25zdCBjb29raWUgPSB0aGlzLmNvb2tpZVNlcnZpY2UuZ2V0T2JqZWN0KGFwcE5hbWUpO1xuICAgICAgbGV0IGlkVG9rZW47XG4gICAgICBpZiAoY29va2llICYmIGNvb2tpZVtWZXJkb2NzU3RhdGVTZXJ2aWNlLklEX1RPS0VOX05BTUVdKSB7XG4gICAgICAgIGlkVG9rZW4gPSBjb29raWVbVmVyZG9jc1N0YXRlU2VydmljZS5JRF9UT0tFTl9OQU1FXTtcbiAgICAgICAgY29uc3QgaWRUb2tlbkNvbnRlbnQgPSB0aGlzLnRva2VuVG9PYmplY3QoaWRUb2tlbik7XG4gICAgICAgIGlmIChpZFRva2VuQ29udGVudFsnc3ViJ10pIHtcbiAgICAgICAgICByZXR1cm4gaWRUb2tlbkNvbnRlbnRbJ3N1YiddLnJlcGxhY2UoJ2F1dGgwfCcsICcnKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIHJldHVybjtcbiAgfVxuXG4gIHVwZGF0ZUNvb2tpZShrZXk6IHN0cmluZywgdmFsdWU6IHN0cmluZywgY29va2llTmFtZT86IHN0cmluZykge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgY29uc3QgY05hbWUgPSBjb29raWVOYW1lID8gY29va2llTmFtZSA6IHRoaXMuY29va2llTmFtZTtcbiAgICAgIHRoaXMuY29va2llQ29uZmlnLmRvbWFpbiA9IHRoaXMuZ2V0RG9tYWluKCk7XG4gICAgICBpZiAod2luZG93ICYmIHdpbmRvdy5sb2NhdGlvbiAmJiBsb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2h0dHBzOicpIHtcbiAgICAgICAgdGhpcy5jb29raWVDb25maWcuc2VjdXJlID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGxldCByQWNjb3VudENvb2tpZSA9IHRoaXMuZ2V0ckFjY291bnRDb29raWVPYmplY3QoKTtcbiAgICAgIGxldCBvdGhlckNvb2tpZSA9IHRoaXMuZ2V0T3RoZXJDb29raWVPYmplY3QoY05hbWUpO1xuICAgICAgbGV0IGNvb2tpZTtcbiAgICAgIGlmICghIWNOYW1lICYmICEha2V5ICYmICEhdmFsdWUpIHtcbiAgICAgICAgaWYgKGNOYW1lID09PSBWZXJkb2NzU3RhdGVTZXJ2aWNlLlJBQ0NPVU5UX0NPT0tJRV9OQU1FICYmICEhckFjY291bnRDb29raWUpIHtcbiAgICAgICAgICByQWNjb3VudENvb2tpZVtrZXldID0gdmFsdWU7XG4gICAgICAgICAgY29va2llID0gckFjY291bnRDb29raWU7XG4gICAgICAgIH0gZWxzZSBpZiAoISFvdGhlckNvb2tpZSkge1xuICAgICAgICAgIG90aGVyQ29va2llW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgICBjb29raWUgPSBvdGhlckNvb2tpZTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLmNvb2tpZVNlcnZpY2UucHV0T2JqZWN0KGNOYW1lLCBjb29raWUsIHRoaXMuY29va2llQ29uZmlnKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB1cGRhdGVUb2tlbnMoclNlY3VyZUJhY2tlbmQpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFRva2VucyhyU2VjdXJlQmFja2VuZCkucGlwZShcbiAgICAgICAgbWFwKCh0b2tlbnM6IGFueVtdKSA9PiB7XG4gICAgICAgICAgZm9yIChsZXQgeCA9IDA7IHggPCB0b2tlbnMubGVuZ3RoOyB4KyspIHtcbiAgICAgICAgICAgIGlmICh0b2tlbnNbeF0uY2xpZW50TmFtZSA9PT0gJ3JBY2NvdW50Jykge1xuICAgICAgICAgICAgICB0aGlzLnVwZGF0ZUNvb2tpZShWZXJkb2NzU3RhdGVTZXJ2aWNlLklEX1RPS0VOX05BTUUsIHRva2Vuc1t4XS5pZFRva2VuLCB0b2tlbnNbeF0uY2xpZW50TmFtZSArIFZlcmRvY3NTdGF0ZVNlcnZpY2UuQ09PS0lFX05BTUVfU1VGRklYKTtcbiAgICAgICAgICAgICAgdGhpcy5kZWNvZGVkSWRUb2tlblN1YmplY3QubmV4dChoZWxwZXIuZGVjb2RlVG9rZW4odG9rZW5zW3hdLmlkVG9rZW4pKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29va2llKFZlcmRvY3NTdGF0ZVNlcnZpY2UuQUNDRVNTX1RPS0VOX05BTUUsIHRva2Vuc1t4XS5hY2Nlc3NUb2tlbiwgdG9rZW5zW3hdLmNsaWVudE5hbWUgKyBWZXJkb2NzU3RhdGVTZXJ2aWNlLkNPT0tJRV9OQU1FX1NVRkZJWCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB0b2tlbnM7XG4gICAgICAgIH0pXG4gICAgICApO1xuICAgIH1cbiAgfVxuXG4gIGhhc0Nvb2tpZSgpIHtcbiAgICByZXR1cm4gISF0aGlzLmNvb2tpZVNlcnZpY2UuZ2V0KHRoaXMuY29va2llTmFtZSk7XG4gIH1cblxuICBnZXRBY2Nlc3NMaXN0KCkge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgdGhpcy5nZXRBbGxDb29raWVzKCk7XG4gICAgICB0aGlzLmFjY2Vzc0xpc3QgPSBbXTtcbiAgICAgIGZvciAoY29uc3QgY29va2llIGluIHRoaXMuY29va2llcykge1xuICAgICAgICBpZiAoY29va2llLmluZGV4T2YoVmVyZG9jc1N0YXRlU2VydmljZS5DT09LSUVfTkFNRV9TVUZGSVgpICE9PSAtMSkge1xuICAgICAgICAgIHRoaXMuYWNjZXNzTGlzdC5wdXNoKGNvb2tpZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0aGlzLmFjY2Vzc0xpc3Q7XG4gICAgfVxuICB9XG5cbiAgZ2V0RW1haWxWZXJpZmljYXRpb24oKTogYm9vbGVhbiB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm0pKSB7XG4gICAgICBjb25zdCBpZFRva2VuID0gdGhpcy5nZXRJRFRva2VuKCk7XG4gICAgICBpZiAoISFpZFRva2VuKSB7XG4gICAgICAgIGNvbnN0IGlkVG9rZW5Db250ZW50ID0gdGhpcy50b2tlblRvT2JqZWN0KGlkVG9rZW4pO1xuICAgICAgICByZXR1cm4gaWRUb2tlbkNvbnRlbnRbJ2VtYWlsX3ZlcmlmaWVkJ107XG4gICAgICB9XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9XG5cbiAgaGFzQWNjZXNzVG8oY2xpZW50TmFtZTogc3RyaW5nKSB7XG4gICAgcmV0dXJuIHRoaXMuYWNjZXNzTGlzdC5pbmRleE9mKGNsaWVudE5hbWUpICE9PSAtMTtcbiAgfVxuXG4gIHN0b3JlT3RoZXJDb29raWUoa2V5LCB2YWx1ZSkge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgdGhpcy5zZXRDb29raWUoa2V5LCB2YWx1ZSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0T3RoZXJDb29raWUoa2V5KSB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm0pKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoa2V5KSB7XG4gICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLmNvb2tpZVNlcnZpY2UuZ2V0T2JqZWN0KGtleSk7XG4gICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignQ2Fubm90IHJldHVybiBjb29raWU6JywgZXJyKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0UkNvb2tpZShrZXk6IHN0cmluZykge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgcmV0dXJuIHRoaXMuY29va2llU2VydmljZS5nZXQoa2V5KTtcbiAgICB9XG4gIH1cblxuICBnZXRPdGhlckNvb2tpZU9iamVjdChrZXkpIHtcbiAgICB0cnkge1xuICAgICAgaWYgKCEha2V5KSB7XG4gICAgICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgICAgIHJldHVybiB0aGlzLmNvb2tpZVNlcnZpY2UuZ2V0T2JqZWN0KGtleSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBudWxsO1xuICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgaWYgKGtleSAhPT0gVmVyZG9jc1N0YXRlU2VydmljZS5TSUdORVJfVE9LRU5fQ09PS0lFX05BTUUpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignQ2Fubm90IGdldCBjb29raWU6ICcsIGVycik7XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gIH1cblxuICByZW1vdmVSQ29va2llKGtleSkge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgdGhpcy5jb29raWVTZXJ2aWNlLnJlbW92ZShrZXksIHRoaXMuY29va2llQ29uZmlnKTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVSQ29va2llcygpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIGlmICh0aGlzLmFjY2Vzc0xpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICBmb3IgKGNvbnN0IGtleSBvZiB0aGlzLmFjY2Vzc0xpc3QpIHtcbiAgICAgICAgICB0aGlzLnJlbW92ZVJDb29raWUoa2V5KTtcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH1cblxuICByZW1vdmVJbnRlcmNvbUNvb2tpZSgpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIGZvciAoY29uc3QgY29va2llIGluIHRoaXMuY29va2llcykge1xuICAgICAgICBpZiAoY29va2llLmluZGV4T2YoJ2ludGVyY29tJykgIT09IC0xKSB7XG4gICAgICAgICAgdGhpcy5yZW1vdmVSQ29va2llKGNvb2tpZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBzZXRUb2tlbnModG9rZW5zKSB7XG4gICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm0pKSB7XG4gICAgICBpZiAodG9rZW5zICYmIHRva2Vucy5sZW5ndGggPiAwKSB7XG4gICAgICAgIGZvciAoY29uc3QgdG9rZW4gb2YgdG9rZW5zKSB7XG4gICAgICAgICAgaWYgKHRva2VuLmNsaWVudE5hbWUgPT09ICdyQWNjb3VudCcpIHtcbiAgICAgICAgICAgIHRoaXMudXBkYXRlQ29va2llKFZlcmRvY3NTdGF0ZVNlcnZpY2UuSURfVE9LRU5fTkFNRSwgdG9rZW4uaWRUb2tlbiwgdG9rZW4uY2xpZW50TmFtZSArIFZlcmRvY3NTdGF0ZVNlcnZpY2UuQ09PS0lFX05BTUVfU1VGRklYKTtcbiAgICAgICAgICAgIHRoaXMuZGVjb2RlZElkVG9rZW5TdWJqZWN0Lm5leHQoaGVscGVyLmRlY29kZVRva2VuKHRva2VuLmlkVG9rZW4pKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGhpcy51cGRhdGVDb29raWUoVmVyZG9jc1N0YXRlU2VydmljZS5BQ0NFU1NfVE9LRU5fTkFNRSwgdG9rZW4uYWNjZXNzVG9rZW4sIHRva2VuLmNsaWVudE5hbWUgKyBWZXJkb2NzU3RhdGVTZXJ2aWNlLkNPT0tJRV9OQU1FX1NVRkZJWCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldHJBY2NvdW50Q29va2llT2JqZWN0KCkge1xuICAgIGlmIChpc1BsYXRmb3JtQnJvd3Nlcih0aGlzLnBsYXRmb3JtKSkge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKHRoaXMuY29va2llTmFtZSAmJiB0aGlzLmNvb2tpZVNlcnZpY2UuZ2V0KFZlcmRvY3NTdGF0ZVNlcnZpY2UuUkFDQ09VTlRfQ09PS0lFX05BTUUpKSB7XG4gICAgICAgICAgY29uc3QgY29va2llID0gdGhpcy5jb29raWVTZXJ2aWNlLmdldE9iamVjdChWZXJkb2NzU3RhdGVTZXJ2aWNlLlJBQ0NPVU5UX0NPT0tJRV9OQU1FKTtcbiAgICAgICAgICByZXR1cm4gY29va2llO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHByaXZhdGUgZ2V0QWxsQ29va2llcygpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIHRoaXMuY29va2llcyA9IHRoaXMuY29va2llU2VydmljZS5nZXRBbGwoKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIHRva2VuVG9PYmplY3QodG9rZW4pIHtcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIGNvbnN0IGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2Uod2luZG93LmF0b2IoYmFzZTY0KSk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbiAgcHJpdmF0ZSBzZXRDb29raWUoY29va2llTmFtZSwgY29va2llVmFsdWUpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIHRoaXMuY29va2llU2VydmljZS5wdXQoY29va2llTmFtZSwgY29va2llVmFsdWUsIHRoaXMuY29va2llQ29uZmlnKTtcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGdldFRva2VucyhyU2VjdXJlQmFja2VuZCkge1xuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHJTZWN1cmVCYWNrZW5kICsgJy90b2tlbicpXG4gIH1cblxuICBwdWJsaWMgZ2V0UkFjY291bnRSb2xlcygpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIGNvbnN0IGNvb2tpZSA9IHRoaXMuY29va2llU2VydmljZS5nZXRPYmplY3QoVmVyZG9jc1N0YXRlU2VydmljZS5SQUNDT1VOVF9DT09LSUVfTkFNRSk7XG4gICAgICBpZiAoISFjb29raWUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGNvb2tpZVtWZXJkb2NzU3RhdGVTZXJ2aWNlLkFDQ0VTU19UT0tFTl9OQU1FXTtcbiAgICAgICAgICBjb25zdCB0b2tlbk9iamVjdCA9IHRoaXMudG9rZW5Ub09iamVjdChhY2Nlc3NUb2tlbik7XG4gICAgICAgICAgcmV0dXJuIHRva2VuT2JqZWN0W2Ake1ZlcmRvY3NTdGF0ZVNlcnZpY2UuVE9LRU5fTkFNRVNQQUNFfS9yb2xlc2BdO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHB1YmxpYyBnZXRQbGFucygpIHtcbiAgICBpZiAoaXNQbGF0Zm9ybUJyb3dzZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIGNvbnN0IGNvb2tpZSA9IHRoaXMuY29va2llU2VydmljZS5nZXRPYmplY3QoVmVyZG9jc1N0YXRlU2VydmljZS5SQUNDT1VOVF9DT09LSUVfTkFNRSk7XG4gICAgICBpZiAoISFjb29raWUpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBhY2Nlc3NUb2tlbiA9IGNvb2tpZVtWZXJkb2NzU3RhdGVTZXJ2aWNlLkFDQ0VTU19UT0tFTl9OQU1FXTtcbiAgICAgICAgICBjb25zdCB0b2tlbk9iamVjdCA9IHRoaXMudG9rZW5Ub09iamVjdChhY2Nlc3NUb2tlbik7XG4gICAgICAgICAgcmV0dXJuIHRva2VuT2JqZWN0W2Ake1ZlcmRvY3NTdGF0ZVNlcnZpY2UuVE9LRU5fTkFNRVNQQUNFfS9wbGFuc2BdO1xuICAgICAgICB9IGNhdGNoIChlcnIpIHtcbiAgICAgICAgICBjb25zb2xlLmVycm9yKGVycik7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19