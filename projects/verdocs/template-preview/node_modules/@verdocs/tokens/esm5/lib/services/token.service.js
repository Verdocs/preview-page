/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { VerdocsStateService } from './state.service';
import * as i0 from "@angular/core";
import * as i1 from "./state.service";
var VerdocsTokenObjectService = /** @class */ (function () {
    function VerdocsTokenObjectService(stateService) {
        this.stateService = stateService;
    }
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getAccessToken = /**
     * @return {?}
     */
    function () {
        return this.tokenToObject(this.stateService.getAccessToken());
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getIDToken = /**
     * @return {?}
     */
    function () {
        return this.tokenToObject(this.stateService.getIDToken());
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getAccountAccessToken = /**
     * @return {?}
     */
    function () {
        return this.tokenToObject(this.stateService.getAccountAccessToken());
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getVerdocsAccessToken = /**
     * @return {?}
     */
    function () {
        return this.tokenToObject(this.stateService.getVerdocsAccessToken());
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getProfile = /**
     * @return {?}
     */
    function () {
        return this.getIDToken() ? this.getIDToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/profile"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getPermissions = /**
     * @return {?}
     */
    function () {
        return this.getAccessToken() ? this.getAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/permissions"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getAccountPermissions = /**
     * @return {?}
     */
    function () {
        return this.getAccountAccessToken() ? this.getAccountAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/permissions"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getVerdocsPermissions = /**
     * @return {?}
     */
    function () {
        return this.getVerdocsAccessToken() ? this.getVerdocsAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/permissions"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getPlans = /**
     * @return {?}
     */
    function () {
        return this.getAccessToken() ? this.getAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/plans"] : this.getAccountPlans() ? this.getAccountPlans() : this.getVerdocsPlans() ? this.getVerdocsPlans() : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getOrganizationID = /**
     * @return {?}
     */
    function () {
        return this.getAccountAccessToken() ? this.getAccountAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/organization_id"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getAccountPlans = /**
     * @return {?}
     */
    function () {
        return this.getAccountAccessToken() ? this.getAccountAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/plans"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getVerdocsPlans = /**
     * @return {?}
     */
    function () {
        return this.getVerdocsAccessToken() ? this.getVerdocsAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/plans"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getRoles = /**
     * @return {?}
     */
    function () {
        return this.getAccessToken() ? this.getAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/roles"] : this.getAccountRoles() ? this.getAccountRoles() : this.getVerdocsRoles() ? this.getVerdocsRoles() : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getAccountRoles = /**
     * @return {?}
     */
    function () {
        return this.getAccountAccessToken() ? this.getAccountAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/roles"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getVerdocsRoles = /**
     * @return {?}
     */
    function () {
        return this.getVerdocsAccessToken() ? this.getVerdocsAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/roles"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getProfileID = /**
     * @return {?}
     */
    function () {
        return this.getAccessToken() ? this.getAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/profile_id"] : this.getAccountAccessToken() ? this.getAccountAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/profile_id"] : this.getVerdocsAccessToken() ? this.getVerdocsAccessToken()[VerdocsTokenObjectService.TOKEN_NAMESPACE + "/profile_id"] : null;
    };
    /**
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.getUserID = /**
     * @return {?}
     */
    function () {
        /** @type {?} */
        var sub = this.getAccessToken()['sub'] || this.getAccountAccessToken()['sub'];
        /** @type {?} */
        var idStart = sub.indexOf('|') + 1;
        return this.getAccessToken()['sub'].slice(idStart);
    };
    /**
     * @param {?} token
     * @return {?}
     */
    VerdocsTokenObjectService.prototype.tokenToObject = /**
     * @param {?} token
     * @return {?}
     */
    function (token) {
        if (token) {
            /** @type {?} */
            var base64Url = token.split('.')[1];
            /** @type {?} */
            var base64 = base64Url.replace('-', '+').replace('_', '/');
            return JSON.parse(window.atob(base64));
        }
        return null;
    };
    VerdocsTokenObjectService.TOKEN_NAMESPACE = 'https://verdocs.com';
    VerdocsTokenObjectService.decorators = [
        { type: Injectable, args: [{
                    providedIn: "root"
                },] }
    ];
    /** @nocollapse */
    VerdocsTokenObjectService.ctorParameters = function () { return [
        { type: VerdocsStateService }
    ]; };
    /** @nocollapse */ VerdocsTokenObjectService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function VerdocsTokenObjectService_Factory() { return new VerdocsTokenObjectService(i0.ɵɵinject(i1.VerdocsStateService)); }, token: VerdocsTokenObjectService, providedIn: "root" });
    return VerdocsTokenObjectService;
}());
export { VerdocsTokenObjectService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    VerdocsTokenObjectService.TOKEN_NAMESPACE;
    /**
     * @type {?}
     * @private
     */
    VerdocsTokenObjectService.prototype.stateService;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidG9rZW4uc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiJuZzovL0B2ZXJkb2NzL3Rva2Vucy8iLCJzb3VyY2VzIjpbImxpYi9zZXJ2aWNlcy90b2tlbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBRTNDLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLGlCQUFpQixDQUFDOzs7QUFFdEQ7SUFLRSxtQ0FDVSxZQUFpQztRQUFqQyxpQkFBWSxHQUFaLFlBQVksQ0FBcUI7SUFDdkMsQ0FBQzs7OztJQUVMLGtEQUFjOzs7SUFBZDtRQUNFLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUM7SUFDaEUsQ0FBQzs7OztJQUNELDhDQUFVOzs7SUFBVjtRQUNFLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUM7SUFDNUQsQ0FBQzs7OztJQUVELHlEQUFxQjs7O0lBQXJCO1FBQ0UsT0FBTyxJQUFJLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxDQUFDO0lBQ3ZFLENBQUM7Ozs7SUFFRCx5REFBcUI7OztJQUFyQjtRQUNFLE9BQU8sSUFBSSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLHFCQUFxQixFQUFFLENBQUMsQ0FBQztJQUN2RSxDQUFDOzs7O0lBRUQsOENBQVU7OztJQUFWO1FBQ0UsT0FBTyxJQUFJLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBSSx5QkFBeUIsQ0FBQyxlQUFlLGFBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDOUcsQ0FBQzs7OztJQUVELGtEQUFjOzs7SUFBZDtRQUNFLE9BQU8sSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUkseUJBQXlCLENBQUMsZUFBZSxpQkFBYyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUMxSCxDQUFDOzs7O0lBRUQseURBQXFCOzs7SUFBckI7UUFDRSxPQUFPLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBSSx5QkFBeUIsQ0FBQyxlQUFlLGlCQUFjLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQ3hJLENBQUM7Ozs7SUFFRCx5REFBcUI7OztJQUFyQjtRQUNFLE9BQU8sSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFJLHlCQUF5QixDQUFDLGVBQWUsaUJBQWMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDeEksQ0FBQzs7OztJQUVELDRDQUFROzs7SUFBUjtRQUNFLE9BQU8sSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUkseUJBQXlCLENBQUMsZUFBZSxXQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDeE4sQ0FBQzs7OztJQUVELHFEQUFpQjs7O0lBQWpCO1FBQ0UsT0FBTyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUkseUJBQXlCLENBQUMsZUFBZSxxQkFBa0IsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDNUksQ0FBQzs7OztJQUVELG1EQUFlOzs7SUFBZjtRQUNFLE9BQU8sSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFJLHlCQUF5QixDQUFDLGVBQWUsV0FBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUNsSSxDQUFDOzs7O0lBRUQsbURBQWU7OztJQUFmO1FBQ0UsT0FBTyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUkseUJBQXlCLENBQUMsZUFBZSxXQUFRLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQ2xJLENBQUM7Ozs7SUFFRCw0Q0FBUTs7O0lBQVI7UUFDRSxPQUFPLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFJLHlCQUF5QixDQUFDLGVBQWUsV0FBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLGVBQWUsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsZUFBZSxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQ3hOLENBQUM7Ozs7SUFFRCxtREFBZTs7O0lBQWY7UUFDRSxPQUFPLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBSSx5QkFBeUIsQ0FBQyxlQUFlLFdBQVEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7SUFDbEksQ0FBQzs7OztJQUVELG1EQUFlOzs7SUFBZjtRQUNFLE9BQU8sSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFJLHlCQUF5QixDQUFDLGVBQWUsV0FBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUNsSSxDQUFDOzs7O0lBRUQsZ0RBQVk7OztJQUFaO1FBQ0UsT0FBTyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBSSx5QkFBeUIsQ0FBQyxlQUFlLGdCQUFhLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxxQkFBcUIsRUFBRSxDQUFJLHlCQUF5QixDQUFDLGVBQWUsZ0JBQWEsQ0FBQyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMscUJBQXFCLEVBQUUsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUkseUJBQXlCLENBQUMsZUFBZSxnQkFBYSxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQztJQUMzVyxDQUFDOzs7O0lBRUQsNkNBQVM7OztJQUFUOztZQUNRLEdBQUcsR0FBRyxJQUFJLENBQUMsY0FBYyxFQUFFLENBQUMsS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDLHFCQUFxQixFQUFFLENBQUMsS0FBSyxDQUFDOztZQUN6RSxPQUFPLEdBQUcsR0FBRyxDQUFDLE9BQU8sQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDO1FBQ3BDLE9BQU8sSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQztJQUNyRCxDQUFDOzs7OztJQUVELGlEQUFhOzs7O0lBQWIsVUFBYyxLQUFLO1FBQ2pCLElBQUksS0FBSyxFQUFFOztnQkFDSCxTQUFTLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDLENBQUM7O2dCQUNqQyxNQUFNLEdBQUcsU0FBUyxDQUFDLE9BQU8sQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLENBQUMsT0FBTyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7WUFDMUQsT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQztTQUN4QztRQUNELE9BQU8sSUFBSSxDQUFDO0lBQ2QsQ0FBQztJQWpGYyx5Q0FBZSxHQUFHLHFCQUFxQixDQUFDOztnQkFKeEQsVUFBVSxTQUFDO29CQUNWLFVBQVUsRUFBRSxNQUFNO2lCQUNuQjs7OztnQkFKUSxtQkFBbUI7OztvQ0FGNUI7Q0EyRkMsQUF2RkQsSUF1RkM7U0FwRlkseUJBQXlCOzs7Ozs7SUFDcEMsMENBQXVEOzs7OztJQUVyRCxpREFBeUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7IFZlcmRvY3NTdGF0ZVNlcnZpY2UgfSBmcm9tICcuL3N0YXRlLnNlcnZpY2UnO1xuXG5ASW5qZWN0YWJsZSh7XG4gIHByb3ZpZGVkSW46IFwicm9vdFwiXG59KVxuZXhwb3J0IGNsYXNzIFZlcmRvY3NUb2tlbk9iamVjdFNlcnZpY2Uge1xuICBwcml2YXRlIHN0YXRpYyBUT0tFTl9OQU1FU1BBQ0UgPSAnaHR0cHM6Ly92ZXJkb2NzLmNvbSc7XG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgc3RhdGVTZXJ2aWNlOiBWZXJkb2NzU3RhdGVTZXJ2aWNlLFxuICApIHsgfVxuXG4gIGdldEFjY2Vzc1Rva2VuKCkge1xuICAgIHJldHVybiB0aGlzLnRva2VuVG9PYmplY3QodGhpcy5zdGF0ZVNlcnZpY2UuZ2V0QWNjZXNzVG9rZW4oKSk7XG4gIH1cbiAgZ2V0SURUb2tlbigpIHtcbiAgICByZXR1cm4gdGhpcy50b2tlblRvT2JqZWN0KHRoaXMuc3RhdGVTZXJ2aWNlLmdldElEVG9rZW4oKSk7XG4gIH1cblxuICBnZXRBY2NvdW50QWNjZXNzVG9rZW4oKSB7XG4gICAgcmV0dXJuIHRoaXMudG9rZW5Ub09iamVjdCh0aGlzLnN0YXRlU2VydmljZS5nZXRBY2NvdW50QWNjZXNzVG9rZW4oKSk7XG4gIH1cblxuICBnZXRWZXJkb2NzQWNjZXNzVG9rZW4oKSB7XG4gICAgcmV0dXJuIHRoaXMudG9rZW5Ub09iamVjdCh0aGlzLnN0YXRlU2VydmljZS5nZXRWZXJkb2NzQWNjZXNzVG9rZW4oKSk7XG4gIH1cblxuICBnZXRQcm9maWxlKCkge1xuICAgIHJldHVybiB0aGlzLmdldElEVG9rZW4oKSA/IHRoaXMuZ2V0SURUb2tlbigpW2Ake1ZlcmRvY3NUb2tlbk9iamVjdFNlcnZpY2UuVE9LRU5fTkFNRVNQQUNFfS9wcm9maWxlYF0gOiBudWxsO1xuICB9XG5cbiAgZ2V0UGVybWlzc2lvbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QWNjZXNzVG9rZW4oKSA/IHRoaXMuZ2V0QWNjZXNzVG9rZW4oKVtgJHtWZXJkb2NzVG9rZW5PYmplY3RTZXJ2aWNlLlRPS0VOX05BTUVTUEFDRX0vcGVybWlzc2lvbnNgXSA6IG51bGw7XG4gIH1cblxuICBnZXRBY2NvdW50UGVybWlzc2lvbnMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QWNjb3VudEFjY2Vzc1Rva2VuKCkgPyB0aGlzLmdldEFjY291bnRBY2Nlc3NUb2tlbigpW2Ake1ZlcmRvY3NUb2tlbk9iamVjdFNlcnZpY2UuVE9LRU5fTkFNRVNQQUNFfS9wZXJtaXNzaW9uc2BdIDogbnVsbDtcbiAgfVxuICBcbiAgZ2V0VmVyZG9jc1Blcm1pc3Npb25zKCkge1xuICAgIHJldHVybiB0aGlzLmdldFZlcmRvY3NBY2Nlc3NUb2tlbigpID8gdGhpcy5nZXRWZXJkb2NzQWNjZXNzVG9rZW4oKVtgJHtWZXJkb2NzVG9rZW5PYmplY3RTZXJ2aWNlLlRPS0VOX05BTUVTUEFDRX0vcGVybWlzc2lvbnNgXSA6IG51bGw7XG4gIH1cblxuICBnZXRQbGFucygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBY2Nlc3NUb2tlbigpID8gdGhpcy5nZXRBY2Nlc3NUb2tlbigpW2Ake1ZlcmRvY3NUb2tlbk9iamVjdFNlcnZpY2UuVE9LRU5fTkFNRVNQQUNFfS9wbGFuc2BdIDogdGhpcy5nZXRBY2NvdW50UGxhbnMoKSA/IHRoaXMuZ2V0QWNjb3VudFBsYW5zKCkgOiB0aGlzLmdldFZlcmRvY3NQbGFucygpID8gdGhpcy5nZXRWZXJkb2NzUGxhbnMoKSA6IG51bGw7XG4gIH1cblxuICBnZXRPcmdhbml6YXRpb25JRCgpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBY2NvdW50QWNjZXNzVG9rZW4oKSA/IHRoaXMuZ2V0QWNjb3VudEFjY2Vzc1Rva2VuKClbYCR7VmVyZG9jc1Rva2VuT2JqZWN0U2VydmljZS5UT0tFTl9OQU1FU1BBQ0V9L29yZ2FuaXphdGlvbl9pZGBdIDogbnVsbDtcbiAgfVxuXG4gIGdldEFjY291bnRQbGFucygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBY2NvdW50QWNjZXNzVG9rZW4oKSA/IHRoaXMuZ2V0QWNjb3VudEFjY2Vzc1Rva2VuKClbYCR7VmVyZG9jc1Rva2VuT2JqZWN0U2VydmljZS5UT0tFTl9OQU1FU1BBQ0V9L3BsYW5zYF0gOiBudWxsO1xuICB9XG5cbiAgZ2V0VmVyZG9jc1BsYW5zKCkge1xuICAgIHJldHVybiB0aGlzLmdldFZlcmRvY3NBY2Nlc3NUb2tlbigpID8gdGhpcy5nZXRWZXJkb2NzQWNjZXNzVG9rZW4oKVtgJHtWZXJkb2NzVG9rZW5PYmplY3RTZXJ2aWNlLlRPS0VOX05BTUVTUEFDRX0vcGxhbnNgXSA6IG51bGw7XG4gIH1cblxuICBnZXRSb2xlcygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRBY2Nlc3NUb2tlbigpID8gdGhpcy5nZXRBY2Nlc3NUb2tlbigpW2Ake1ZlcmRvY3NUb2tlbk9iamVjdFNlcnZpY2UuVE9LRU5fTkFNRVNQQUNFfS9yb2xlc2BdIDogdGhpcy5nZXRBY2NvdW50Um9sZXMoKSA/IHRoaXMuZ2V0QWNjb3VudFJvbGVzKCkgOiB0aGlzLmdldFZlcmRvY3NSb2xlcygpID8gdGhpcy5nZXRWZXJkb2NzUm9sZXMoKSA6IG51bGw7XG4gIH1cblxuICBnZXRBY2NvdW50Um9sZXMoKSB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0QWNjb3VudEFjY2Vzc1Rva2VuKCkgPyB0aGlzLmdldEFjY291bnRBY2Nlc3NUb2tlbigpW2Ake1ZlcmRvY3NUb2tlbk9iamVjdFNlcnZpY2UuVE9LRU5fTkFNRVNQQUNFfS9yb2xlc2BdIDogbnVsbDtcbiAgfVxuXG4gIGdldFZlcmRvY3NSb2xlcygpIHtcbiAgICByZXR1cm4gdGhpcy5nZXRWZXJkb2NzQWNjZXNzVG9rZW4oKSA/IHRoaXMuZ2V0VmVyZG9jc0FjY2Vzc1Rva2VuKClbYCR7VmVyZG9jc1Rva2VuT2JqZWN0U2VydmljZS5UT0tFTl9OQU1FU1BBQ0V9L3JvbGVzYF0gOiBudWxsO1xuICB9XG5cbiAgZ2V0UHJvZmlsZUlEKCkge1xuICAgIHJldHVybiB0aGlzLmdldEFjY2Vzc1Rva2VuKCkgPyB0aGlzLmdldEFjY2Vzc1Rva2VuKClbYCR7VmVyZG9jc1Rva2VuT2JqZWN0U2VydmljZS5UT0tFTl9OQU1FU1BBQ0V9L3Byb2ZpbGVfaWRgXSA6IHRoaXMuZ2V0QWNjb3VudEFjY2Vzc1Rva2VuKCkgPyB0aGlzLmdldEFjY291bnRBY2Nlc3NUb2tlbigpW2Ake1ZlcmRvY3NUb2tlbk9iamVjdFNlcnZpY2UuVE9LRU5fTkFNRVNQQUNFfS9wcm9maWxlX2lkYF0gOiB0aGlzLmdldFZlcmRvY3NBY2Nlc3NUb2tlbigpID8gdGhpcy5nZXRWZXJkb2NzQWNjZXNzVG9rZW4oKVtgJHtWZXJkb2NzVG9rZW5PYmplY3RTZXJ2aWNlLlRPS0VOX05BTUVTUEFDRX0vcHJvZmlsZV9pZGBdIDogbnVsbDtcbiAgfVxuXG4gIGdldFVzZXJJRCgpIHtcbiAgICBjb25zdCBzdWIgPSB0aGlzLmdldEFjY2Vzc1Rva2VuKClbJ3N1YiddIHx8IHRoaXMuZ2V0QWNjb3VudEFjY2Vzc1Rva2VuKClbJ3N1YiddO1xuICAgIGNvbnN0IGlkU3RhcnQgPSBzdWIuaW5kZXhPZignfCcpICsgMTtcbiAgICByZXR1cm4gdGhpcy5nZXRBY2Nlc3NUb2tlbigpWydzdWInXS5zbGljZShpZFN0YXJ0KTtcbiAgfVxuXG4gIHRva2VuVG9PYmplY3QodG9rZW4pIHtcbiAgICBpZiAodG9rZW4pIHtcbiAgICAgIGNvbnN0IGJhc2U2NFVybCA9IHRva2VuLnNwbGl0KCcuJylbMV07XG4gICAgICB2YXIgYmFzZTY0ID0gYmFzZTY0VXJsLnJlcGxhY2UoJy0nLCAnKycpLnJlcGxhY2UoJ18nLCAnLycpO1xuICAgICAgcmV0dXJuIEpTT04ucGFyc2Uod2luZG93LmF0b2IoYmFzZTY0KSk7XG4gICAgfVxuICAgIHJldHVybiBudWxsO1xuICB9XG5cbn1cbiJdfQ==