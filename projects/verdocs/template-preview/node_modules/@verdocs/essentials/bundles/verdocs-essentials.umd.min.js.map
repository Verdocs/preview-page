{"version":3,"sources":["../../../../node_modules/tslib/tslib.es6.js","ng://@verdocs/essentials/lib/models/dynamic-field.model.ts","ng://@verdocs/essentials/lib/functions/viewer-fields.ts","ng://@verdocs/essentials/lib/functions/conversion.ts","ng://@verdocs/essentials/lib/functions/builder-fields.ts","ng://@verdocs/essentials/lib/functions/builder-page.ts","ng://@verdocs/essentials/lib/functions/filter.ts","ng://@verdocs/essentials/lib/functions/utils.ts","ng://@verdocs/essentials/lib/snackbar/snackbar.service.ts","ng://@verdocs/essentials/lib/builder/browser-to-iText.service.ts","ng://@verdocs/essentials/lib/builder/builder-data.service.ts","ng://@verdocs/essentials/lib/builder/builder-settings.service.ts","ng://@verdocs/essentials/lib/fields/conversion.service.ts","ng://@verdocs/essentials/lib/fields/envelope-signature.service.ts","ng://@verdocs/essentials/lib/fields/envelope-view.service.ts","ng://@verdocs/essentials/lib/fields/page.service.ts","ng://@verdocs/essentials/lib/modal/modal.service.ts","ng://@verdocs/essentials/lib/dialogs/error-dialogs/four-oh-one.dialog.ts","ng://@verdocs/essentials/lib/dialogs/plan-dialogs/plans-dialog.component.ts","ng://@verdocs/essentials/lib/error-dialogs/error-dialog.service.ts","ng://@verdocs/essentials/lib/guards/guard.service.ts","ng://@verdocs/essentials/lib/essentials.module.ts","ng://@verdocs/essentials/lib/account/account.service.ts"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","__assign","assign","t","s","i","n","arguments","length","call","apply","__rest","e","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","target","key","desc","c","r","getOwnPropertyDescriptor","Reflect","decorate","defineProperty","__param","paramIndex","decorator","__metadata","metadataKey","metadataValue","metadata","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","rejected","result","done","then","__generator","body","f","y","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","v","op","TypeError","pop","push","__exportStar","m","exports","__values","o","__read","ar","error","__spread","concat","__spreadArrays","il","k","a","j","jl","__await","__asyncGenerator","asyncIterator","q","resume","fulfill","settle","shift","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__importStar","mod","__esModule","default","__importDefault","field_params","required","order","undefined","controlType","validator","maxLength","showCounter","prepared","recipientRole","options","field_name","min_checked","max_checked","temp_sig","sig_id","temp_int","int_id","dirty","full_name","url","name","buildFields","fields","mode","role","_fields","setting","fieldIndex","field","keyNameSuffix","type","toLowerCase","fieldValues","DynamicField","getFieldsMap","pageNum","fieldsMap","option_id","field_pageNum","field_field_index","updateElementStyles","browserType","x","findIndex","getInputStyle","generateCheckboxLabel","inputStyle","height","width","background","font_size","fontSize","getLetterSpacing","color","upperCase","leading","rescale","labelStyle","position","top","left","cursor","backgroundColor","border","prepareFieldsForSigner","getDefaultHeight","getDefaultWidth","getRTop","fieldHeight","iTextHeight","yRatio","getRLeft","ratio","getRValue","getUIFieldStyling","style","bottom","blobToBase64","image","fileReader","FileReader","onerror","DOMException","onload","readAsDataURL","setRatio","pages","pdfPages","xRatio","constructPages","roles","fieldPages","groupFields","constructGroupFields","fieldCopy","copyIndex","generateInitialStyle","generateStyle","generateGroupLabel","role_name","optionsLength","checked","selected","id","optionIndex","initialStyle","getRoleColor","letterSpacing","convertToUIRatio","lineHeight","index","getRGBA","rgba","nameToRGBA","isInView","scrollTop","pageTop","pageHeight","window","headerHeight","innerWidth","viewportHeight","innerHeight","topOfPageIsInView","middleOfPageIsInView","bottomOfPageIsInView","pageBottom","timePeriod","endDate","Date","getTime","today","month","getMonth","year","getFullYear","startDate","start_time","toISOString","end_time","regParse","string","JSON","parse","prefix","substring","eval","slice","dataURLtoBlob","dataUrl","arr","split","bstr","atob","u8arr","Uint8Array","charCodeAt","Blob","printPdfUrl","pdfUrl","printJS","console","SnackbarService","snackbar","platform","initConfig","duration","isPlatformBrowser","verticalPosition","horizontalPosition","open","message","action","config","dismiss","Injectable","MatSnackBar","Inject","args","PLATFORM_ID","BrowserToiTextService","detectBrowser","isFirefox","isOpera","addons","navigator","userAgent","isSafari","test","pushNotification","toString","isIE","document","isEdge","isChrome","webstore","isBlink","BuilderDataService","http","router","templatesService","templateGuard","snackbarService","eventTracker","injector","_this","recipients","templateSubject","ReplaySubject","hasFields","templateNameSubject","templatePagesSubject","recipientsSubject","activeRecipientSubject","scrollInfoSubject","screenInfoSubject","newTypeSubject","Subject","newOptionSubject","duplicateFieldSubject","saveStatusSubject","renderedSubject","activeFieldIndexSubject","numberOfRolesSubject","numberOfSequenceSubject","hasFieldsSubject","_config_token","get","EssentialsConfigToken","rForm_backend_url","subscribe","template","templateName","createTemplate","template_body","post","pipe","map","res","updateLocalTemplateData","templatePages","updateTemplate","updateTemplateObservable","updateTemplateName","updateLocalTemplate","createSnackBar","err","getTemplateObservable","templateId","getTemplate","toPromise","sortRoles","watchForUpdatedTemplate","sort","sequence","checkForFields","uploadTemplateDocument","file","formdata","FormData","append","req","HttpRequest","reportProgress","request","catchError","observableThrowError","getTemplateDocument","templateDoc","getAllTemplateDocumentsObservable","docs","getTemplateDocumentFile","getTemplateDocumentPDFObservable","pdf","URL","createObjectURL","setTemplateDocument","templateDocument","addTemplatePage","page_number","document_id","addTemplatePages","pageNums","from","mergeMap","page","delay","deleteTemplateField","fieldName","delete","trim","roleIndex","roleFieldIndex","splice","deleteTemplateFields","fieldNames","fieldNames_1","tslib_1.__values","fieldNames_1_1","addTemplateField","newField","template_id","createEvent","category","getTemplateOwnerInfo","updateTemplateField","oldName","put","page_sequence","updateRoleField","updated_field","role_index","old_name","field_index","updateDropdownField","deleteSequence","sequence_number","prepareFieldDuplication","roles_1","roles_1_1","title","buttonTitle","editDocsUrl","editRolesUrl","editTemplateUrl","previewTemplateUrl","addFieldRole","fieldId","roleId","fieldRoleInfo","stringify","field_id","role_id","fieldRole","addRole","templateBackend","roleRequests","forEach","forkJoin","savedRoles","savedRolesWithFields","newRole","of","addCheckboxGroup","addRadioGroup","getRolesInSequence","rolesInSequence","sequenceIndex","deleteRole","roleName","remove","fields_1","fields_1_1","deleteRoles","roleNames","deleteCalls","filter","updateRoles","updateCalls","email","delegator","phone","updateFullName","updatedField","setActiveFieldIndex","activeFieldIndex","autoAddSigner","_a","setTimeout","openTemplate","canUserPreview","navigate","canUserEdit","canPerformAction","TemplateActions","WRITE","canPreview","hasPermission","READ","canPerform","signers","signers_1","signers_1_1","signer","HttpClient","Router","TemplatesService","TemplatesGuardService","EventTrackerService","Injector","BuilderService","sideNavStateSubject","recipientSideNavStateSubject","initiateAutofocus","recipientAutoFocus","deleteRoleSubject","hasActiveRoleSubject","toggleSideNav","sideNavState","toggleRecipientSideNav","recipientSideNavState","openSideNav","openRecipientSideNav","closeSideNav","closeRecipientSideNav","setActiveRole","activeRole","getSideNavState","getRecipientSideNavState","ConversionService","ITextWidth","ITextHeight","XRatio","YRatio","a3Portrait","a3Landscape","a4Portrait","a4Landscape","a5Portrait","a5Landscape","letterPortrait","letterLandscape","legalPortrait","legalLandscape","portraitSizes","landscapeSizes","rFormWidth","rFormHeight","pageCache","setRValue","setPageCache","setXRatio","setYRatio","getITextLeft","getITextBottomFromRTop","getITextBottom","getUIFieldSetting","uuid","placeholder","account_id","currency","payment_fee_type","amount","if_transfer_fee","updateITextValues","newHeight","newWidth","SignatureService","httpClient","envelopeSvc","vTokenStateService","workingField","FieldData","fName","_total","_recipient","_showSig","_signedFields","BehaviorSubject","_envId","_rName","signImgSubject","initialImgSubject","initialIdSubject","signatureIdSubject","signedFields","_rForm_backend_url","envUrl","setWorkingPayment","payment","workingPayment","updateFields","postSignatureBlob","blobFile","signatureBlob","formData","response","postInitialBlob","initialBlob","toggleSig","bool","setSigId","signatureId","setInitialId","initialId","setSignImg","signImg","getSignImg","setInitialImg","initialImg","getInitialImg","putSignatureField","envelopeId","getPublicIp","ipAddress","ip_address","putInitialField","updateEnvelopeField","ifPrepared","getEnvelopeFieldValue","putEnvelopeField","isPrepared","updateGroupedField","prepareEnvelopeField","setPrepared","fieldType","fieldResponse","jsonp","catch","updateCurrentField","vName","setCurrentFields","currentFields","errorMessages","setEnvId","setrName","rName","getSignatureUrl","data","blob","setSignatureData","setInitialData","updateSigned","updateInitialed","setSignatureId","setRecipient","recipient","setTotal","DocumentsService","VerdocsStateService","EnvelopeViewService","signatureService","recipientSubject","jumpCoordinateSubject","fieldTypeSubject","pdfUrlSubject","pdfBlobSubject","toggleNextSubject","viewModeSubject","agreedSubject","attachmentsSubject","formValiditySubject","requestFormValiditySubject","setMode","setSignatureService","requestFormValidity","setFormValidityData","ifBelongsToPreparer","ifBelongsToCurrentRecipient","Noindex","Index","Follow","Noimageindex","None","Noarchive","Nocache","Nosnippet","PageService","titleService","meta","rendererFactory","activatedRoute","tokenObject","segmentIsInitialized","lazyTitle","inti","initializeSegment","additionalSetupForWidgets","events","event","NavigationEnd","route","targetRoute","firstChild","switchMap","setTitleAndRecord","pageName","newTitle","cookie","includes","rForm_cookie_name","setTitle","setMetaProperty","property","content","getMetaTagProperty","updateTag","addTag","removeTag","setMetaName","setOpenGraphMeta","description","setRobotMeta","robot_values","_i","parameters","robot_parameters","setCanonicalUrl","tag","href","setDescriptionMeta","getMetaTag","getTag","analytics_1","idTokenSubscription_1","decodedIdTokenSubject","decodedIdToken","unsubscribe","reset","profile","getProfile","identify","sub","userId","Verdoc plan","planType","Organization plan","Current Profile Id","getProfileID","Current Company","organization","company","organization_id","Intercom","hideDefaultLauncher","robotEnum","Robots","product","productName","plan","getPlans","find","forceCreation","renderer","createRenderer","encapsulation","ViewEncapsulation","styles","link","createElement","head","selector","_parseSelector","keys","prop","setAttribute","Error","existingLink","selectRootElement","removeAttribute","appendChild","attr","rel","widgetIsOpen","close","Title","Meta","RendererFactory2","ActivatedRoute","VerdocsTokenObjectService","DOCUMENT","ModalService","modals","subject","add","modal","setComponentData","componentData","getComponentData","asObservable","FourOhOneDialog","vTokenObjectService","currentProfile","error_code","error_title","error_message","rSecureUrl","rSecure_frontend_url","rFormUrl","rForm_frontend_url","ngOnInit","code","prepareErroContent","goToDashboard","signIn","location","signUp","Component","PlansDialog","dialog","redirectUrl","dialogTitle","dialogMessage","goToBilling","MatDialogRef","ErrorDialogService","show401ResponseError","panelClass","disableClose","componentInstance","showPlansError","redirect_url","dialog_title","dialog_message","planErrorDialog","GuardService","stateService","_redirectUrl","_plans","plans","_rAccount_frontend_url","rAccount_frontend_url","checkSubscription","subscriptionType","openDialog","idToken","getIDToken","toTokenObject","essentialDialog","proDialog","freeDialog","accessToken","base64","replace","getHighestEnvelopePlan","MatDialog","EssentialsConfig","InjectionToken","EssentialsModule","initializeEssentials","ngModule","import","CommonModule","AngularApiModule","initSDK","production","domain","origin","loginURL","rSecure_backend_url","rAccount_backend_url","rNotification_backend_url","MatDialogModule","providers","provide","useValue","AccountService","declarations","EntryComponents","NgModule","imports","userDataSubject","userProfileSubject","profileLoadingSubject","currentProfileSubject","personalAccountSubject","profilesSubject","userFullname","userInitial","userEmail","userPhone","userData","initial","currentOrganizationId","backend_url","getAccountData","getProfiles","personal","profileData","unshift","currentIndex","current","charAt","getProfileCollection","profiles","profileModels","ProfileModel","ProfileCollection","removeFromProfileData","removeIndex","getAllProfiles","switchProfile","profile_id","setTokens","tokens","updateTokens","sendMessage","createSnackbar","resendEmailVerification","putAccountData","first_name","last_name","deleteAccount","changePassword","oldPassword","newPassword","getNameValidity","getOptions","createOrganization","authValue","getOtherCookieObject","headers","Headers","Cache-Control","Pragma","Expires","If-Modified-Since","Content-Type","Authorization","Accept","fetchToken","invite","redirectReq","observe","storeOtherCookie","queryParams"],"mappings":"i3CAgBA,IAAIA,cAAgB,SAASC,EAAGC,GAI5B,OAHAF,cAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,MACpDN,EAAGC,IAGrB,SAASO,UAAUR,EAAGC,GAEzB,SAASQ,IAAOC,KAAKC,YAAcX,EADnCD,cAAcC,EAAGC,GAEjBD,EAAEY,UAAkB,OAANX,EAAaC,OAAOW,OAAOZ,IAAMQ,EAAGG,UAAYX,EAAEW,UAAW,IAAIH,GAG5E,IAAIK,SAAW,WAQlB,OAPAA,SAAWZ,OAAOa,QAAU,SAAkBC,GAC1C,IAAK,IAAIC,EAAGC,EAAI,EAAGC,EAAIC,UAAUC,OAAQH,EAAIC,EAAGD,IAE5C,IAAK,IAAIZ,KADTW,EAAIG,UAAUF,GACOhB,OAAOU,UAAUL,eAAee,KAAKL,EAAGX,KAAIU,EAAEV,GAAKW,EAAEX,IAE9E,OAAOU,IAEKO,MAAMb,KAAMU,YAGzB,SAASI,OAAOP,EAAGQ,GACtB,IAAIT,EAAI,GACR,IAAK,IAAIV,KAAKW,EAAOf,OAAOU,UAAUL,eAAee,KAAKL,EAAGX,IAAMmB,EAAEC,QAAQpB,GAAK,IAC9EU,EAAEV,GAAKW,EAAEX,IACb,GAAS,MAALW,GAAqD,mBAAjCf,OAAOyB,sBACtB,CAAA,IAAIT,EAAI,EAAb,IAAgBZ,EAAIJ,OAAOyB,sBAAsBV,GAAIC,EAAIZ,EAAEe,OAAQH,IAC3DO,EAAEC,QAAQpB,EAAEY,IAAM,GAAKhB,OAAOU,UAAUgB,qBAAqBN,KAAKL,EAAGX,EAAEY,MACvEF,EAAEV,EAAEY,IAAMD,EAAEX,EAAEY,KAE1B,OAAOF,EAGJ,SAASa,WAAWC,EAAYC,EAAQC,EAAKC,GAChD,IAA2HjC,EAAvHkC,EAAId,UAAUC,OAAQc,EAAID,EAAI,EAAIH,EAAkB,OAATE,EAAgBA,EAAO/B,OAAOkC,yBAAyBL,EAAQC,GAAOC,EACrH,GAAuB,iBAAZI,SAAoD,mBAArBA,QAAQC,SAAyBH,EAAIE,QAAQC,SAASR,EAAYC,EAAQC,EAAKC,QACpH,IAAK,IAAIf,EAAIY,EAAWT,OAAS,EAAGH,GAAK,EAAGA,KAASlB,EAAI8B,EAAWZ,MAAIiB,GAAKD,EAAI,EAAIlC,EAAEmC,GAAKD,EAAI,EAAIlC,EAAE+B,EAAQC,EAAKG,GAAKnC,EAAE+B,EAAQC,KAASG,GAChJ,OAAOD,EAAI,GAAKC,GAAKjC,OAAOqC,eAAeR,EAAQC,EAAKG,GAAIA,EAGzD,SAASK,QAAQC,EAAYC,GAChC,OAAO,SAAUX,EAAQC,GAAOU,EAAUX,EAAQC,EAAKS,IAGpD,SAASE,WAAWC,EAAaC,GACpC,GAAuB,iBAAZR,SAAoD,mBAArBA,QAAQS,SAAyB,OAAOT,QAAQS,SAASF,EAAaC,GAG7G,SAASE,UAAUC,EAASC,EAAYC,EAAGC,GAC9C,OAAO,IAAKD,IAAMA,EAAIE,UAAU,SAAUC,EAASC,GAC/C,SAASC,EAAUC,GAAS,IAAMC,EAAKN,EAAUO,KAAKF,IAAW,MAAO/B,GAAK6B,EAAO7B,IACpF,SAASkC,EAASH,GAAS,IAAMC,EAAKN,EAAiB,MAAEK,IAAW,MAAO/B,GAAK6B,EAAO7B,IACvF,SAASgC,EAAKG,GAAUA,EAAOC,KAAOR,EAAQO,EAAOJ,OAAS,IAAIN,EAAE,SAAUG,GAAWA,EAAQO,EAAOJ,SAAWM,KAAKP,EAAWI,GACnIF,GAAMN,EAAYA,EAAU5B,MAAMyB,EAASC,GAAc,KAAKS,UAI/D,SAASK,YAAYf,EAASgB,GACjC,IAAsGC,EAAGC,EAAGlD,EAAGmD,EAA3GC,EAAI,CAAEC,MAAO,EAAGC,KAAM,WAAa,GAAW,EAAPtD,EAAE,GAAQ,MAAMA,EAAE,GAAI,OAAOA,EAAE,IAAOuD,KAAM,GAAIC,IAAK,IAChG,OAAOL,EAAI,CAAET,KAAMe,EAAK,GAAIC,MAASD,EAAK,GAAIE,OAAUF,EAAK,IAAwB,mBAAXG,SAA0BT,EAAES,OAAOC,UAAY,WAAa,OAAOnE,OAAUyD,EACvJ,SAASM,EAAKtD,GAAK,OAAO,SAAU2D,GAAK,OACzC,SAAcC,GACV,GAAId,EAAG,MAAM,IAAIe,UAAU,mCAC3B,KAAOZ,GAAG,IACN,GAAIH,EAAI,EAAGC,IAAMlD,EAAY,EAAR+D,EAAG,GAASb,EAAU,OAAIa,EAAG,GAAKb,EAAS,SAAOlD,EAAIkD,EAAU,SAAMlD,EAAEM,KAAK4C,GAAI,GAAKA,EAAER,SAAW1C,EAAIA,EAAEM,KAAK4C,EAAGa,EAAG,KAAKlB,KAAM,OAAO7C,EAE3J,OADIkD,EAAI,EAAGlD,IAAG+D,EAAK,CAAS,EAARA,EAAG,GAAQ/D,EAAEwC,QACzBuB,EAAG,IACP,KAAK,EAAG,KAAK,EAAG/D,EAAI+D,EAAI,MACxB,KAAK,EAAc,OAAXX,EAAEC,QAAgB,CAAEb,MAAOuB,EAAG,GAAIlB,MAAM,GAChD,KAAK,EAAGO,EAAEC,QAASH,EAAIa,EAAG,GAAIA,EAAK,CAAC,GAAI,SACxC,KAAK,EAAGA,EAAKX,EAAEI,IAAIS,MAAOb,EAAEG,KAAKU,MAAO,SACxC,QACI,KAAkBjE,GAAZA,EAAIoD,EAAEG,MAAYlD,OAAS,GAAKL,EAAEA,EAAEK,OAAS,MAAkB,IAAV0D,EAAG,IAAsB,IAAVA,EAAG,IAAW,CAAEX,EAAI,EAAG,SACjG,GAAc,IAAVW,EAAG,MAAc/D,GAAM+D,EAAG,GAAK/D,EAAE,IAAM+D,EAAG,GAAK/D,EAAE,IAAM,CAAEoD,EAAEC,MAAQU,EAAG,GAAI,MAC9E,GAAc,IAAVA,EAAG,IAAYX,EAAEC,MAAQrD,EAAE,GAAI,CAAEoD,EAAEC,MAAQrD,EAAE,GAAIA,EAAI+D,EAAI,MAC7D,GAAI/D,GAAKoD,EAAEC,MAAQrD,EAAE,GAAI,CAAEoD,EAAEC,MAAQrD,EAAE,GAAIoD,EAAEI,IAAIU,KAAKH,GAAK,MACvD/D,EAAE,IAAIoD,EAAEI,IAAIS,MAChBb,EAAEG,KAAKU,MAAO,SAEtBF,EAAKf,EAAK1C,KAAK0B,EAASoB,GAC1B,MAAO3C,GAAKsD,EAAK,CAAC,EAAGtD,GAAIyC,EAAI,EAAI,QAAWD,EAAIjD,EAAI,EACtD,GAAY,EAAR+D,EAAG,GAAQ,MAAMA,EAAG,GAAI,MAAO,CAAEvB,MAAOuB,EAAG,GAAKA,EAAG,QAAK,EAAQlB,MAAM,GArB9BJ,CAAK,CAACtC,EAAG2D,MAyBtD,SAASK,aAAaC,EAAGC,GAC5B,IAAK,IAAI/E,KAAK8E,EAAQC,EAAQ9E,eAAeD,KAAI+E,EAAQ/E,GAAK8E,EAAE9E,IAG7D,SAASgF,SAASC,GACrB,IAAIH,EAAsB,mBAAXR,QAAyBW,EAAEX,OAAOC,UAAW3D,EAAI,EAChE,OAAIkE,EAAUA,EAAE9D,KAAKiE,GACd,CACH7B,KAAM,WAEF,OADI6B,GAAKrE,GAAKqE,EAAElE,SAAQkE,OAAI,GACrB,CAAE/B,MAAO+B,GAAKA,EAAErE,KAAM2C,MAAO0B,KAKzC,SAASC,OAAOD,EAAGpE,GACtB,IAAIiE,EAAsB,mBAAXR,QAAyBW,EAAEX,OAAOC,UACjD,IAAKO,EAAG,OAAOG,EACf,IAAmBpD,EAAYV,EAA3BP,EAAIkE,EAAE9D,KAAKiE,GAAOE,EAAK,GAC3B,IACI,WAAc,IAANtE,GAAgBA,KAAM,MAAQgB,EAAIjB,EAAEwC,QAAQG,MAAM4B,EAAGP,KAAK/C,EAAEqB,OAExE,MAAOkC,GAASjE,EAAI,CAAEiE,MAAOA,GACjC,QACQ,IACQvD,IAAMA,EAAE0B,OAASuB,EAAIlE,EAAU,SAAIkE,EAAE9D,KAAKJ,GAE1D,QAAkB,GAAIO,EAAG,MAAMA,EAAEiE,OAE7B,OAAOD,EAGJ,SAASE,WACZ,IAAK,IAAIF,EAAK,GAAIvE,EAAI,EAAGA,EAAIE,UAAUC,OAAQH,IAC3CuE,EAAKA,EAAGG,OAAOJ,OAAOpE,UAAUF,KACpC,OAAOuE,EAGJ,SAASI,iBACZ,IAAK,IAAI5E,EAAI,EAAGC,EAAI,EAAG4E,EAAK1E,UAAUC,OAAQH,EAAI4E,EAAI5E,IAAKD,GAAKG,UAAUF,GAAGG,OACxE,IAAIc,EAAI9B,MAAMY,GAAI8E,EAAI,EAA3B,IAA8B7E,EAAI,EAAGA,EAAI4E,EAAI5E,IACzC,IAAK,IAAI8E,EAAI5E,UAAUF,GAAI+E,EAAI,EAAGC,EAAKF,EAAE3E,OAAQ4E,EAAIC,EAAID,IAAKF,IAC1D5D,EAAE4D,GAAKC,EAAEC,GACjB,OAAO9D,EAGJ,SAASgE,QAAQrB,GACpB,OAAOpE,gBAAgByF,SAAWzF,KAAKoE,EAAIA,EAAGpE,MAAQ,IAAIyF,QAAQrB,GAG/D,SAASsB,iBAAiBpD,EAASC,EAAYE,GAClD,IAAKyB,OAAOyB,cAAe,MAAM,IAAIrB,UAAU,wCAC/C,IAAoD9D,EAAhDiD,EAAIhB,EAAU5B,MAAMyB,EAASC,GAAc,IAAQqD,EAAI,GAC3D,OAAOpF,EAAI,GAAIuD,EAAK,QAASA,EAAK,SAAUA,EAAK,UAAWvD,EAAE0D,OAAOyB,eAAiB,WAAc,OAAO3F,MAASQ,EACpH,SAASuD,EAAKtD,GAASgD,EAAEhD,KAAID,EAAEC,GAAK,SAAU2D,GAAK,OAAO,IAAI1B,QAAQ,SAAU4C,EAAG/F,GAAKqG,EAAEpB,KAAK,CAAC/D,EAAG2D,EAAGkB,EAAG/F,IAAM,GAAKsG,EAAOpF,EAAG2D,OAC9H,SAASyB,EAAOpF,EAAG2D,GAAK,KACV3C,EADqBgC,EAAEhD,GAAG2D,IACnBtB,iBAAiB2C,QAAU/C,QAAQC,QAAQlB,EAAEqB,MAAMsB,GAAGhB,KAAK0C,EAASlD,GAAUmD,EAAOH,EAAE,GAAG,GAAInE,GADpE,MAAOV,GAAKgF,EAAOH,EAAE,GAAG,GAAI7E,GAC3E,IAAcU,EACd,SAASqE,EAAQhD,GAAS+C,EAAO,OAAQ/C,GACzC,SAASF,EAAOE,GAAS+C,EAAO,QAAS/C,GACzC,SAASiD,EAAOxC,EAAGa,GAASb,EAAEa,GAAIwB,EAAEI,QAASJ,EAAEjF,QAAQkF,EAAOD,EAAE,GAAG,GAAIA,EAAE,GAAG,KAGzE,SAASK,iBAAiBpB,GAC7B,IAAIrE,EAAGZ,EACP,OAAOY,EAAI,GAAIuD,EAAK,QAASA,EAAK,QAAS,SAAUhD,GAAK,MAAMA,IAAOgD,EAAK,UAAWvD,EAAE0D,OAAOC,UAAY,WAAc,OAAOnE,MAASQ,EAC1I,SAASuD,EAAKtD,EAAG8C,GAAK/C,EAAEC,GAAKoE,EAAEpE,GAAK,SAAU2D,GAAK,OAAQxE,GAAKA,GAAK,CAAEkD,MAAO2C,QAAQZ,EAAEpE,GAAG2D,IAAKjB,KAAY,WAAN1C,GAAmB8C,EAAIA,EAAEa,GAAKA,GAAOb,GAGxI,SAAS2C,cAAcrB,GAC1B,IAAKX,OAAOyB,cAAe,MAAM,IAAIrB,UAAU,wCAC/C,IAAiC9D,EAA7BkE,EAAIG,EAAEX,OAAOyB,eACjB,OAAOjB,EAAIA,EAAE9D,KAAKiE,IAAMA,EAAwB,mBAAbD,SAA0BA,SAASC,GAAKA,EAAEX,OAAOC,YAAa3D,EAAI,GAAIuD,EAAK,QAASA,EAAK,SAAUA,EAAK,UAAWvD,EAAE0D,OAAOyB,eAAiB,WAAc,OAAO3F,MAASQ,GAC9M,SAASuD,EAAKtD,GAAKD,EAAEC,GAAKoE,EAAEpE,IAAM,SAAU2D,GAAK,OAAO,IAAI1B,QAAQ,SAAUC,EAASC,IACvF,SAAgBD,EAASC,EAAQtD,EAAG8E,GAAK1B,QAAQC,QAAQyB,GAAGhB,KAAK,SAASgB,GAAKzB,EAAQ,CAAEG,MAAOsB,EAAGjB,KAAM7D,KAASsD,IADJmD,CAAOpD,EAASC,GAA7BwB,EAAIS,EAAEpE,GAAG2D,IAA8BjB,KAAMiB,EAAEtB,WAI7I,SAASqD,qBAAqBC,EAAQC,GAEzC,OADI7G,OAAOqC,eAAkBrC,OAAOqC,eAAeuE,EAAQ,MAAO,CAAEtD,MAAOuD,IAAiBD,EAAOC,IAAMA,EAClGD,EAGJ,SAASE,aAAaC,GACzB,GAAIA,GAAOA,EAAIC,WAAY,OAAOD,EAClC,IAAIrD,EAAS,GACb,GAAW,MAAPqD,EAAa,IAAK,IAAIlB,KAAKkB,EAAS/G,OAAOK,eAAee,KAAK2F,EAAKlB,KAAInC,EAAOmC,GAAKkB,EAAIlB,IAE5F,OADAnC,EAAOuD,QAAUF,EACVrD,EAGJ,SAASwD,gBAAgBH,GAC5B,OAAQA,GAAOA,EAAIC,WAAcD,EAAM,CAAEE,QAASF,GClMtD,iBAwBE,SAAYI,QAAA,IAAAA,IAAAA,EAAA,IAyBV3G,KAAK8C,MAAQ6D,EAAa7D,MAC1B9C,KAAKsB,IAAMqF,EAAarF,KAAO,GAC/BtB,KAAK4G,WAAaD,EAAaC,SAC/B5G,KAAK6G,WAA+BC,IAAvBH,EAAaE,MAAsB,EAAIF,EAAaE,MACjE7G,KAAK+G,YAAcJ,EAAaI,aAAe,GAC/C/G,KAAKgH,eAAuCF,IAA3BH,EAAaK,UAA0B,GAAKL,EAAaK,UAC1EhH,KAAKiH,UAAsC,MAA1BN,EAAaM,UAAoB,KAAON,EAAaM,UACtEjH,KAAKkH,aAA2C,IAA7BP,EAAaO,aAAgCP,EAAaO,YAC7ElH,KAAKmH,SAAWR,EAAaQ,SAC7BnH,KAAKoH,cAAgBT,EAAaS,cAClCpH,KAAKqH,QAAUV,EAAaU,QAC5BrH,KAAKsH,WAAaX,EAAaW,WAC/BtH,KAAKuH,YAAcZ,EAAaY,YAChCvH,KAAKwH,YAAcb,EAAaa,YAChCxH,KAAKyH,SAAWd,EAAac,SAC7BzH,KAAK0H,OAASf,EAAae,OAC3B1H,KAAK2H,SAAWhB,EAAagB,SAC7B3H,KAAK4H,OAASjB,EAAaiB,OAC3B5H,KAAK6H,MAAQlB,EAAakB,MAC1B7H,KAAK8H,UAAYnB,EAAamB,UAC1BnB,EAAaoB,MACf/H,KAAK+H,IAAMpB,EAAaoB,KAEtBpB,EAAaqB,OACfhI,KAAKgI,KAAOrB,EAAaqB,OCtE/B,SAAgBC,YAAYC,EAAQC,OAS9BC,EAFEC,EAAU,GACZxB,EAAQ,EAEZ,OAAQsB,GACN,IAAK,aACL,IAAK,cACL,IAAK,UACHC,EAAO,iBACP,MACF,IAAK,WACHA,EAAO,YACP,MACF,QACEA,EAAO,qBAGPE,EAAU,UAEd,IAAK,IAAMC,KAAcL,EACvB,GAAIA,EAAOrI,eAAe0I,IAAeL,EAAOK,GAAa,KACrDC,EAAQN,EAAOK,GACjBE,EAAgB,GAIpB,OAHMD,EAAgB,WACpBF,EAAU,YAEJE,EAAME,KAAKC,eACjB,IAAK,aACL,IAAK,UACHH,EAAMF,GAAgB,MAAI,GAC1BE,EAAMF,GAAiB,OAAI,GAC3B,MACF,IAAK,WACL,IAAK,iBACL,IAAK,qBACHE,EAAMF,GAAgB,MAAI,KAC1BE,EAAMF,GAAiB,OAAI,KAC3BG,EAAgBD,EAAgB,SAAI,IAAMA,EAAgB,SAAI,GAC9D,MACF,IAAK,YAIL,IAAK,UACHA,EAAMF,GAAgB,MAAI,eAC1BE,EAAMF,GAAiB,OAAI,OAMzBM,EAAc,IAAIC,aAAa,CACnCvH,IAAKkH,EAAMR,KAAOS,EAClB3F,MAAO0F,EAAMF,GAAiB,QAAK,GACnC1B,SAAU4B,EAAM5B,SAChBG,YAAayB,EAAME,KACnB7B,MAAOA,IACPG,UAAWwB,EAAMxB,UACjBE,aAAa,EACbC,SAAUqB,EAAMrB,WAAY,EAC5BC,cAAeoB,EAAMJ,GACrBd,WAAYkB,EAAMR,KAClBH,OAAO,IAGT,OAAQW,EAAME,MACZ,IAAK,aACHE,EAAY9F,MAAQ0F,EAAMF,GAAe,KAAIE,EAAMF,GAAe,KAAI,GACtE,MACF,IAAK,WACHM,EAAY9F,OAAqC,IAA7B0F,EAAMF,GAAiB,OAC3C,MACF,IAAK,UACHM,EAAY9F,MAAQ0F,EAAMF,GAAqB,WAAIE,EAAMF,GAAqB,WAAI,GAClF,MACF,IAAK,iBACHM,EAAY9F,MAAQ0F,EAAMF,GAAkB,SACxCE,EAAM5B,UAAY4B,EAAMF,GAA0B,gBAAI,KACxDM,EAAyB,YAAIJ,EAAMF,GAA0B,gBAC7DM,EAAyB,YAAIJ,EAAMF,GAA0B,iBAE/D,MACF,IAAK,qBACHM,EAAY9F,MAAQ0F,EAAMF,GAAmB,SAC7C,MACF,IAAK,WACHM,EAAY9F,MAAQ0F,EAAMF,GAAgB,MAC1CM,EAAqB,QAAIJ,EAAMF,GAAkB,QAMjDE,EAAMF,GAAc,MACtBM,EAAiB,IAAIJ,EAAMF,GAAc,IACzCM,EAAkB,KAAIJ,EAAMF,GAAe,KAC3CM,EAAmB,MAAIJ,EAAMF,GAAe,MAG1CJ,EAAOK,KACTF,EAAQE,GAAcK,GAI5B,OAAOP,EAGT,SAAgBS,aAAaZ,EAAQa,OAC/BC,EAAY,GAChB,IAAK,IAAMT,KAAcL,EACvB,GAAIA,EAAOrI,eAAe0I,IAAeL,EAAOK,GAAa,KACrDC,EAAQN,EAAOK,GACjBE,EAAgB,GACpB,OAAQD,EAAME,KAAKC,eACjB,IAAK,WACL,IAAK,iBACL,IAAK,qBACHF,EAAgBD,EAAgB,SAAI,IAAMA,EAAgB,SAAI,GAKlEQ,EAAUR,EAAMR,KAAOS,GAAiB,CACtCnB,WAAYkB,EAAMR,KAClBS,cAAeD,EAAgB,SAAI,IAAMA,EAAgB,SAAI,KAC7DS,UAAWT,EAAgB,SAC3BU,cAAeH,EACfI,kBAAmBZ,GAIzB,OAAOS,EAGT,SAAgBI,oBAAoBlB,EAAQG,EAASF,EAAMkB,GACzD,GAAInB,GAAUG,GAAWH,EAAOvH,SAAW0H,EAAQ1H,OACjD,IAAK,IAAI2I,EAAI,EAAGA,EAAIjB,EAAQ1H,OAAQ2I,IAAK,KACnCf,EAAagB,OAAAA,UAAUrB,EAAQ,CAAEF,KAAMK,EAAQiB,GAAGhC,aAClDiB,GAAc,IAChBF,EAAQiB,GAAiB,aAAIE,cAActB,EAAOK,GAAaJ,EAAMkB,GACxB,aAAzChB,EAAQiB,GAAGvC,YAAY4B,eAAyE,mBAAzCN,EAAQiB,GAAGvC,YAAY4B,eAA+E,uBAAzCN,EAAQiB,GAAGvC,YAAY4B,gBAC7IN,EAAQiB,GAAkB,cAAIG,sBAAsBvB,EAAOK,GAAY3B,YAK/E,OAAOyB,EAGT,SAAgBmB,cAAchB,EAAOL,EAAMkB,OAErCf,EAAU,UACRE,EAAgB,WACpBF,EAAU,gBAENoB,EAAa,CACjBC,OAAU,OACVC,MAAS,OACTC,WAAc,QAmChB,OAjCKrB,EAAMF,IAAYE,EAAMF,GAASwB,WAA6B,SAAftB,EAAME,MAAkC,cAAfF,EAAME,MAAuC,YAAfF,EAAME,MAAqC,cAAfF,EAAME,QAC3IgB,EAAqB,SAAIK,OACzBL,EAA0B,cAAI,mBAGb,aAAflB,EAAME,OACRgB,EAAqB,SAAI,gBAClBA,EAAWG,YAGD,YAAfrB,EAAME,OACRgB,EAAqB,SAAIK,OACzBL,EAA0B,cAAIM,iBAAiBX,GAAe,MAE5Db,EAAgB,WAClBkB,EAAmB,OAAI,qBAErBlB,EAAgB,WAA2B,IAAtBA,EAAgB,UAAuB,gBAATL,IACrDuB,EAAuB,WAAI,UAEzBlB,EAAMF,IAAYE,EAAMF,GAAS2B,QACnCP,EAAkB,MAAIlB,EAAMF,GAAS2B,OAEnCzB,EAAMF,IAAYE,EAAMF,GAAS4B,YACnCR,EAA0B,cAAI,aAG5BlB,EAAMF,IAAYE,EAAMF,GAAS6B,QAAU,EAC7CT,EAAuB,WAAOU,QAAQ,EAAG5B,EAAMF,GAAS6B,QAAU,IAAG,KAC5D3B,EAAM2B,SAAW3B,EAAM2B,QAAU,IAC1CT,EAAuB,WAAOU,QAAQ,EAAG5B,EAAM2B,QAAU,IAAG,MAGvDT,EAGT,SAAgBD,sBAAsB7C,OAC9ByD,EAAa,CACjBC,SAAU,WACVC,IAAK,EACLC,KAAM,EACNC,OAAQ,UACRd,OAAQ,SACRC,MAAO,SACPc,gBAAiB,cACjBC,OAAQ,kBAKV,OAHiB,IAAb/D,IACFyD,EAAsB,UAAI,qBAErBA,EAGT,SAAgBL,iBAAiBX,GAC/B,OAAQA,GACN,IAAK,QACH,OAAQ,MACV,IAAK,UACH,OAAQ,mBACV,IAAK,KAEL,IAAK,OACH,OAAQ,MACV,IAAK,SAEL,IAAK,SAEL,IAAK,QAEL,QACE,OAAQ,OAId,SAAgBe,QAAQ3I,EAAGhB,GACzB,OAAOgB,EAAIhB,EAGb,SAAgBmK,uBAAuB1C,GACR,IAAIvI,MAAMuI,EAAOvH,QCxPhD,SAAgBkK,iBAAiBrC,OAC3BmB,EAAS,EACb,OAAQnB,EAAME,MACZ,IAAK,YACL,IAAK,UACHiB,EAAS,GACT,MACF,IAAK,WACL,IAAK,iBACL,IAAK,qBACHA,EAAS,KACT,MACF,IAAK,aACL,IAAK,UACHA,EAAS,GACT,MACF,QACEA,EAASnB,EAAMF,QAAgB,QAAK,EAGxC,OAAOqB,EAGT,SAAgBmB,gBAAgBtC,OAC1BoB,EAAQ,EACZ,OAAQpB,EAAME,MACZ,IAAK,YACL,IAAK,UACHkB,EAAQ,eACR,MACF,IAAK,WACL,IAAK,iBACL,IAAK,qBACHA,EAAQ,KACR,MACF,IAAK,aACL,IAAK,UACHA,EAAQ,GACR,MACF,IAAK,OACHA,EAAQ,GACR,MACF,IAAK,WACHA,EAAQpB,EAAMF,QAAe,OAAK,GAClC,MACF,QACEsB,EAAQpB,EAAMF,QAAe,OAAK,EAGtC,OAAOsB,EAGT,SAAgBmB,QAAQvH,EAAGwH,EAAaC,EAAaC,GACnD,OAAOD,GAAgBzH,EAAIwH,GAAeE,EAG5C,SAAgBC,SAAS7B,EAAG8B,GAC1B,OAAO9B,EAAI8B,EAGb,SAAgBC,UAAU7H,EAAG4H,GAC3B,OAAO5H,EAAI4H,EAGb,SAAgBE,kBAAkB9C,OAC1BmB,EAASkB,iBAAiBrC,GAC1B+C,EAAQ,CACZf,KAAMhC,EAAMF,QAAQgB,EAAI,KACxBkC,OAAQhD,EAAMF,QAAQ9E,EAAI,KAC1BmG,OAAQ,OACRC,MAAO,QAGT,OAAQpB,EAAME,MACZ,IAAK,UACL,IAAK,OACL,IAAK,YACL,IAAK,cACL,IAAK,WACH6C,EAAiB,UAAI5B,EAAS,KAC9B4B,EAAgB,SAAI/C,EAAMF,QAAQsB,MAAQ,KAC1C,MACF,IAAK,WACL,IAAK,iBACL,IAAK,qBACH2B,EAAiB,UAAI,SACrBA,EAAgB,SAAI,SACpB,MACF,IAAK,aACL,IAAK,UACHA,EAAiB,UAAI,OACrBA,EAAgB,SAAI,OACpB,MACF,IAAK,YACL,IAAK,UACHA,EAAiB,UAAI,OACrBA,EAAgB,SAAI,mBACpBA,EAAM,eAAiB,OAK3B,OAAOA,EAET,SAAgBE,aAAaC,OACrBC,EAAa,IAAIC,WACvB,OAAO,IAAIlJ,QAAO,SAAEC,EAASC,GAC3B+I,EAAWE,QAAO,WAChBjJ,EAAO,IAAIkJ,aAAa,2BAG1BH,EAAWI,OAAM,WACfpJ,EAAQgJ,EAAWzI,SAGrByI,EAAWK,cAAcN,KC9G7B,SAAgBO,SAASC,EAAOC,GAC9B,IAAK,IAAI3L,EAAI,EAAGA,EAAI0L,EAAMvL,OAAQH,IAChC,IAAK,IAAI+E,EAAI,EAAGA,EAAI2G,EAAM1L,GAAG0H,OAAOvH,OAAQ4E,IACtC2G,EAAM1L,GAAG0H,OAAO3C,KAClB2G,EAAM1L,GAAG0H,OAAO3C,GAAU,MAAI,CAC5B+D,EAAG6C,EAAS3L,GAAG4L,OACf5I,EAAG2I,EAAS3L,GAAG0K,SAKvB,OAAOgB,EAGT,SAAgBG,eAAeH,EAAOI,EAAOH,EAAU9C,GACrD,GAAI6C,GAASA,EAAMvL,OAAS,EAAG,CAE7B,QADI4L,EAAa,IAAI5M,MAAMuM,EAAMvL,QACxBH,EAAI,EAAGA,EAAI0L,EAAMvL,OAAQH,IAAK,CACrC+L,EAAW/L,GAAK,CAAE0H,OAAQ,IAC1B,IAAK,IAAI3C,EAAI,EAAGA,EAAI2G,EAAM1L,GAAG0H,OAAOvH,OAAQ4E,IAC1C,GAAI2G,EAAM1L,GAAG0H,OAAO3C,GAAY,SAAK2G,EAAM1L,GAAG0H,OAAO3C,GAAY,QAAW,SAC1E2G,EAAM1L,GAAG0H,OAAO3C,GAAY,QAAW,QAAE5E,OAAS,GAAqC,mBAA/BuL,EAAM1L,GAAG0H,OAAO3C,GAAS,MAClD,uBAA/B2G,EAAM1L,GAAG0H,OAAO3C,GAAS,KAA4B,KAC/CiH,EAAcC,qBAAqBP,EAAO1L,EAAG+E,EAAG+G,EAAOH,EAAUI,EAAYlD,GACnFkD,EAAW/L,GAAG0H,OAAOhD,OAAOsH,OACvB,KACCE,EAAStM,SAAA,GAAQ8L,EAAM1L,GAAG0H,OAAO3C,IACjCoH,EAAYpD,OAAAA,UAAUgD,EAAW/L,GAAG0H,OAAQ,CAAEF,KAAM0E,EAAU1E,OACpE0E,EAAyB,cAAInH,EACN,mBAAnBmH,EAAUhE,MAAgD,uBAAnBgE,EAAUhE,OACnDgE,EAAwB,aAAIE,qBAAqBF,EAAWJ,EAAOjD,GACnEqD,EAAiB,MAAIG,cAAcH,EAAWP,IAEzB,aAAnBO,EAAUhE,MAA0C,mBAAnBgE,EAAUhE,MAAgD,uBAAnBgE,EAAUhE,OACpFgE,EAAyB,cAAII,mBAAmBtM,EAAGkM,EAAUK,UAAWT,EAAOH,IAE7EQ,EAAY,IACdJ,EAAW/L,GAAG0H,OAAOqE,EAAW/L,GAAG0H,OAAOvH,QAAU+L,IAK5D,OAAOH,EAEP,MAAO,GAIX,SAAgBE,qBAAqBP,EAAO1L,EAAG+E,EAAG+G,EAAOH,EAAUI,EAAYlD,GAG7E,QAFIhE,EAAI,EACF2H,EAAgBd,EAAM1L,GAAG0H,OAAO3C,GAAY,QAAW,QAAE5E,OACxD0E,EAAI2H,GAAe,KAClBN,EAAStM,SAAA,GAAQ8L,EAAM1L,GAAG0H,OAAO3C,IACjC8B,EAAU6E,EAAM1L,GAAG0H,OAAO3C,GAAY,QAAW,QAAEF,GACzDqH,EAAUpE,QAAW,EAAIjB,EAAQiC,EACjCoD,EAAUpE,QAAW,EAAIjB,EAAQ7D,EACV,mBAAnBkJ,EAAUhE,KACZgE,EAAUpE,QAAiB,QAAIjB,EAAQ4F,QAEvCP,EAAUpE,QAAkB,SAAIjB,EAAQ6F,SAE1CR,EAAwB,aAAIE,qBAAqBF,EAAWJ,EAAOjD,GACnEqD,EAAiB,MAAIG,cAAcH,EAAWP,GAC9CO,EAAyB,cAAII,mBAAmBtM,EAAGkM,EAAUK,UAAWT,EAAOH,GAC/EO,EAAyB,cAAInH,EAC7BmH,EAAuB,YAAIrH,EAC3BqH,EAAoB,SAAIrF,EAAQ8F,GACd5D,OAAAA,UAAUgD,EAAW/L,GAAG0H,OAAQ,CAAEkF,YAAaV,EAAUU,YAAapF,KAAM0E,EAAU1E,OACxF,IACduE,EAAW/L,GAAG0H,OAAOqE,EAAW/L,GAAG0H,OAAOvH,QAAU+L,GAEtDrH,IAEF,OAAOkH,EAGT,SAAgBK,qBAAqBpE,EAAO8D,EAAOjD,OAE3Cf,EAAUE,EAAMF,QAEhB+E,EAAe,CACnB1D,OAAQ,OACRC,MAAO,OACPc,gBAAiB4C,aAJD9E,EAAMuE,UAImBT,GACzCiB,cAAe,KACfxD,SAAU,MAGZ,OADAvB,EAAoB,aAAI6E,EAChB7E,EAAME,MACZ,IAAK,UACL,IAAK,WACHF,EAAoB,aAAiB,cAAIgF,iBAAiBxD,iBAAiBX,GAAcb,EAAa,MAAEc,GAAK,KAC/G,IAAK,YACL,IAAK,UACL,IAAK,OACL,IAAK,WACHd,EAAoB,aAAY,SAAIgF,iBAnBvB,IAmBkDhF,EAAa,MAAEc,GAAK,KACnF,MACF,IAAK,YACDd,EAAoB,aAAY,SAAIgF,iBAAiB,IAAKhF,EAAa,MAAEc,GAAK,KAChF,MACF,IAAK,aACL,IAAK,UACHd,EAAoB,aAAU,OAAI,OAClCA,EAAoB,aAAE,YAAc,CAClC8B,SAAU,WACVC,IAAK,EACLC,KAAM,EACNb,OAAQ,OACRC,MAAO,OACP6D,WAAY,OACZ1D,SAAU,QAUhB,OAHIzB,EAAQ6B,SAAW7B,EAAQ6B,QAAU,IACvC3B,EAAM6E,aAAa,eAAiBG,iBAAiBlF,EAAQ6B,QAAU,OAAQ3B,EAAa,MAAEhF,GAAK,MAE9FgF,EAAM6E,aAGf,SAAgBR,cAAcrE,EAAO2D,GACnC,OAAOb,kBAAkB9C,GAG3B,SAAgBsE,mBAAmBtM,EAAGuM,EAAWT,EAAOH,GACtD,MAAO,CACL7B,SAAU,WACVC,IAAK,EACLC,KAAM,EACNb,OAAQ,SACRC,MAAO,SACPc,gBAAiB4C,aAAaP,EAAWT,GACzC3B,OAAQ,kBAIZ,SAAgB2C,aAAatF,EAAMsE,EAAOoB,GACxC,OAAIA,EACKC,IAAAA,QAAQD,GACNpB,GAASA,EAAM3L,OAAS,IACjC+M,EAAQnE,OAAAA,UAAU+C,EAAO,CAAEtE,KAAMA,MACpB,EACJsE,EAAMoB,GAAOE,KAAOtB,EAAMoB,GAAOE,KAAOD,IAAAA,QAAQD,GAKlDG,IAAAA,WAAW7F,GAItB,SAAgBwF,iBAAiB1K,EAAesI,GAC9C,OAAOtI,EAAQsI,ECjKjB,SAAgB0C,SAASC,EAAWC,EAASC,GAC3C,QAAyB,IAAdF,EACT,OAAO,KAET,GAAIG,OAAQ,KACNC,EAAe,IACGD,OAAOE,WACT,MAClBD,EAAe,SAEXE,EAAiBH,OAAOI,YAAcH,EAC5C,OAAOI,kBAAkBR,EAAWC,EAASK,IAC3CG,qBAAqBT,EAAWC,EAASC,EAAYI,IACrDI,qBAAqBV,EAAWC,EAASC,EAAYI,IAI3D,SAAgBE,kBAAkBR,EAAWC,EAASK,GACpD,OAAOL,EAAUD,GAAaC,EAAUD,EAAYM,EAGtD,SAAgBG,qBAAqBT,EAAWC,EAASC,EAAYI,GAGnE,OAAON,EAAYC,GAFID,EAAYM,EAChBL,EAAUC,EAI/B,SAAgBQ,qBAAqBV,EAAWC,EAASC,EAAYI,OAE7DK,EAAaV,EAAUC,EAC7B,OAFuBF,EAAYM,EAEXK,GAAcX,EAAYW,EC5BpD,SAAgBC,WAAWjG,OACrBkG,GAAU,IAAIC,MAAOC,UACjBC,EAAQ,IAAIF,KACZG,EAAQD,EAAME,WACdC,EAAOH,EAAMI,cACfC,EAAY,KAChB,OAAQ1G,GACN,IAAK,MACH0G,EAAYR,EAAO,OACnB,MACF,IAAK,MACHQ,EAAYR,EAAO,OACnB,MACF,IAAK,KACHQ,EAAYR,EAAO,QACnB,MACF,IAAK,aACHQ,EAAY,IAAIP,KAAKK,EAAMF,EAAO,GAAGF,UACrC,MACF,IAAK,aACHM,EAAY,IAAIP,KAAKK,EAAMF,EAAQ,EAAG,GAAGF,UACzCF,EAAU,IAAIC,KAAKK,EAAMF,EAAO,GAAGF,UACnC,MACF,IAAK,YACHM,EAAY,IAAIP,KAAKK,EAAM,EAAG,GAC9B,MACF,IAAK,WAIL,QACEE,EAAY,KACZR,EAAU,KAId,OAAiB,MAAbQ,GAAgC,MAAXR,EAChB,KAET,CACES,WAAY,IAAIR,KAAKO,GAAWE,cAChCC,SAAU,IAAIV,KAAKD,GAASU,eCxClC,SAAgBE,SAASC,QACvB,OAAOC,KAAKC,MAAMF,OAAM,SAAYnO,IAAKwB,WACnC8M,OACJ,MAAqB,iBAAV9M,MACFA,MAELA,MAAMnC,OAAS,EACVmC,OAET8M,OAAS9M,MAAM+M,UAAU,EAAG,GAEb,aAAXD,OACKE,KAAK,IAAMhN,MAAQ,KAEb,aAAX8M,OACKE,KAAKhN,MAAMiN,MAAM,IAEX,aAAXH,OACKE,KAAKhN,MAAMiN,MAAM,IAEnBjN,SAIX,SAAgBkN,cAAcC,EAASvH,QAAA,IAAAA,IAAAA,EAAA,aAMrC,QALMwH,EAAMD,EAAQE,MAAM,KAExBC,EAAOC,KAAKH,EAAI,IACZzP,EAAI2P,EAAKzP,OACT2P,EAAQ,IAAIC,WAAW9P,GACtBA,KACL6P,EAAM7P,GAAK2P,EAAKI,WAAW/P,GAE7B,OAAO,IAAIgQ,KAAK,CAACH,GAAQ,CAAE5H,KAAMA,IAGnC,SAAgBgI,YAAYC,GACF,iBAApB,EACFC,QAAQD,GAERE,QAAQ7L,MAAM,gDAAiD2L,GC3CnE,IAAAG,gBAAA,WAME,SAAAA,EACUC,EACqBC,GADrBhR,KAAA+Q,SAAAA,EACqB/Q,KAAAgR,SAAAA,EA8BjC,OA3BEF,EAAA5Q,UAAA+Q,WAAA,SAAWC,EAAmB5G,GAC5B,GAAK6G,OAAAA,kBAAkBnR,KAAKgR,UAAY,CAetC,OAbI9C,QAAUA,OAAOE,YAAc,IAChB,CACfgD,iBAAkB9G,GAAsB,SACxC+G,mBAAoB,OACpBH,SAAUA,GAAsB,KAGjB,CACfE,iBAAkB9G,GAAsB,MACxC4G,SAAUA,GAAsB,OAQxCJ,EAAA5Q,UAAAoR,KAAA,SAAKC,EAAiBC,EAASC,GAC7B,OAAOzR,KAAK+Q,SAASO,KAAKC,EAASC,QAAkB1K,EAAW2K,GAAkBzR,KAAKiR,eAGzFH,EAAA5Q,UAAAwR,QAAA,WACE1R,KAAK+Q,SAASW,+BAhCjBC,KAAAA,sDAFQC,SAAAA,4CAMJC,KAAAA,OAAMC,KAAA,CAACC,KAAAA,kBA8BZjB,EAtCA,GCAA,IAAAkB,sBAAA,WAEA,SAAAA,KA6DA,OA3DEA,EAAA9R,UAAA+R,cAAA,eAEMC,GAAY,EACZ,mBAAoBhE,SACtBgE,GAAY,OAGRC,IAAajE,OAAY,OAAOA,OAAY,IAAEkE,UAAalE,OAAc,OAAKmE,UAAUC,UAAUtR,QAAQ,UAAY,EAEtHuR,EAAW,eAAeC,KAAKtE,OAAoB,cAA8C,wCAAyCA,OAAe,QAAMA,OAAe,QAAKA,OAAe,OAAEuE,kBAAlHC,WAElFC,IAA8BC,SAAuB,aAErDC,GAAUF,KAAUzE,OAAmB,WAEvC4E,IAAa5E,OAAe,UAAOA,OAAe,OAAE6E,SAEpDC,GAAWF,GAAYX,MAAcjE,OAAY,IAGvD,OAAIiE,EACK,QACED,EACF,UACES,EACF,KACEE,EACF,OACEC,EACF,SACEE,EACF,QACET,EACF,SAEF,WAGTP,EAAA9R,UAAA8J,iBAAA,WAEE,OADoBhK,KAAKiS,iBAEvB,IAAK,QACH,OAAQ,MACV,IAAK,UACH,OAAQ,mBACV,IAAK,KAEL,IAAK,OACH,OAAQ,MACV,IAAK,SAEL,IAAK,SAEL,IAAK,QAEL,QACE,OAAQ,4BA1DfN,KAAAA,aA6DDK,EA/DA,iCC2DE,SAAAiB,EACUC,EACAC,EACAC,EAEAC,EACAC,EACAC,EACAC,GARV,IAAAC,EAAAzT,KACUA,KAAAkT,KAAAA,EACAlT,KAAAmT,OAAAA,EACAnT,KAAAoT,iBAAAA,EAEApT,KAAAqT,cAAAA,EACArT,KAAAsT,gBAAAA,EACAtT,KAAAuT,aAAAA,EACAvT,KAAAwT,SAAAA,EApCFxT,KAAA0T,WAAa,GAMb1T,KAAAsM,MAAiB,GACjBtM,KAAA2T,gBAA4C,IAAIC,KAAAA,cAAyB,EAAG,KAE5E5T,KAAA6T,WAAY,EAGb7T,KAAA8T,oBAA6C,IAAIF,KAAAA,cAAsB,EAAG,KAC1E5T,KAAA+T,qBAA8C,IAAIH,KAAAA,cAAsB,EAAG,KAC3E5T,KAAAgU,kBAA4C,IAAIJ,KAAAA,cAChD5T,KAAAiU,uBAA+C,IAAIL,KAAAA,cACnD5T,KAAAkU,kBAAwC,IAAIN,KAAAA,cAC5C5T,KAAAmU,kBAAwC,IAAIP,KAAAA,cAC5C5T,KAAAoU,eAAyC,IAAIC,KAAAA,QAC7CrU,KAAAsU,iBAA8C,IAAIV,KAAAA,cAA0B,EAAG,KAC/E5T,KAAAuU,sBAA+C,IAAIX,KAAAA,cACnD5T,KAAAwU,kBAA2C,IAAIZ,KAAAA,cAC/C5T,KAAAyU,gBAAyC,IAAIb,KAAAA,cAC7C5T,KAAA0U,wBAA8C,IAAId,KAAAA,cAAmB,EAAG,KACxE5T,KAAA2U,qBAA8C,IAAIf,KAAAA,cAClD5T,KAAA4U,wBAAiD,IAAIhB,KAAAA,cACrD5T,KAAA6U,iBAA2C,IAAIjB,KAAAA,cAYpD5T,KAAK8U,cAAgB9U,KAAKwT,SAASuB,IAAIC,uBACvChV,KAAKiV,kBAAoBjV,KAAK8U,cAAcG,kBAE5CjV,KAAK2T,gBAAgBuB,UAAS,SAACC,GAC7B1B,EAAK0B,SAAWA,EACZA,GAAYA,EAASnN,MACvByL,EAAKK,oBAAoB9Q,KAAKmS,EAASnN,QAG3ChI,KAAK8T,oBAAoBoB,UAAS,SAAClN,GACjCyL,EAAK2B,aAAepN,IA2mB1B,OAtmBEiL,EAAA/S,UAAAmV,eAAA,SAAeC,GAAf,IAAA7B,EAAAzT,KACE,OAAOA,KAAKkT,KACTqC,KAAgBvV,KAAKiV,kBAAoB,aAAcK,GACvDE,KACCC,UAAAA,IAAG,SAAEC,GAGH,OAFAjC,EAAKE,gBAAgB3Q,KAAK0S,GAC1BjC,EAAKO,kBAAkBhR,KAAK,IACrB0S,MAKfzC,EAAA/S,UAAAyV,wBAAA,WACE3V,KAAKoV,aAAepV,KAAKmV,SAASnN,KAClChI,KAAK8T,oBAAoB9Q,KAAKhD,KAAKoV,cACnCpV,KAAK4V,cAAgB5V,KAAKmV,SAASjJ,MAAMvL,OACzCX,KAAK+T,qBAAqB/Q,KAAKhD,KAAK4V,gBAGtC3C,EAAA/S,UAAA2V,eAAA,SAAeP,GACb,OAAOtV,KAAKoT,iBAAiB0C,yBAAyBR,EAAcnI,GAAImI,GAAeE,KACrFC,UAAAA,IAAG,SAACN,GAAY,OAAAA,MAIpBlC,EAAA/S,UAAA6V,mBAAA,SAAmBZ,EAAUnN,GAA7B,IAAAyL,EAAAzT,KACE,GAAImV,GAAYA,EAAShI,GACvB,OAAOnN,KAAKoT,iBAAiB0C,yBAAyBX,EAAShI,GAAI,CAAEnF,KAAMA,IACxEwN,KACCC,UAAAA,IAAG,SAACC,GAKF,OAJAP,EAASnN,KAAO0N,EAAI1N,KACpByL,EAAKuC,oBAAoBb,GACzB1B,EAAKe,kBAAkBxR,KAAK,SAC5ByQ,EAAKwC,eAAe,oBAAsBjO,GACnC0N,EAAI1N,MACZ,SACCkO,GAGE,OAFAzC,EAAKe,kBAAkBxR,KAAK,kBAC5ByQ,EAAKwC,eAAe,kCACbC,KAIflW,KAAK8T,oBAAoB9Q,KAAKgF,GAC9BhI,KAAKwU,kBAAkBxR,KAAK,yBAIhCiQ,EAAA/S,UAAAiW,sBAAA,SAAsBC,GACpB,OAAOpW,KAAKoT,iBAAiB+C,sBAAsBC,IAGrDnD,EAAA/S,UAAAmW,YAAA,SAAYD,GAAZ,IAAA3C,EAAAzT,KACE,OAAOA,KAAKoT,iBAAiBiD,YAAYD,GAAYE,YAAYlT,KAAI,SAAC+R,GAOpE,OANA1B,EAAKuC,oBAAoBb,GACzB1B,EAAKC,WAAaD,EAAK8C,UAAU9C,EAAK0B,UACtC1B,EAAK0B,SAAS7I,MAAQmH,EAAKC,WAC3BD,EAAKnH,MAAQmH,EAAKC,WAClBD,EAAKO,kBAAkBhR,KAAKyQ,EAAKC,YACjCD,EAAKQ,uBAAuBjR,KAAKyQ,EAAKC,WAAW,IAC1CD,EAAK0B,YAIhBlC,EAAA/S,UAAAsW,wBAAA,WACE,OAAOxW,KAAK2T,gBAAgB6B,KAAKC,UAAAA,IAAG,SAACN,GAAY,OAAAA,MAGnDlC,EAAA/S,UAAA8V,oBAAA,SAAoBb,GACdA,GACFnV,KAAKmV,SAAWA,EACZnV,KAAKmV,UAAYnV,KAAKmV,SAASjJ,QACjClM,KAAKmV,SAASjJ,MAAQlM,KAAKmV,SAASjJ,MAAMuK,KAAI,SAAEnR,EAAG/F,GACjD,OAAO+F,EAAEoR,SAAWnX,EAAEmX,YAGtB1W,KAAKmV,WACPnV,KAAK2V,0BACL3V,KAAK2W,eAAe3W,KAAKmV,SAAS7I,QAEpCtM,KAAKgU,kBAAkBhR,KAAKhD,KAAKmV,SAAS7I,MAAMmK,KAAI,SAAEnR,EAAG/F,GACvD,OAAO+F,EAAEoR,SAAWnX,EAAEmX,YAExB1W,KAAK2T,gBAAgB3Q,KAAKhD,KAAKmV,YAE/BnV,KAAK8T,oBAAoB9Q,KAAK,MAC9BhD,KAAK+T,qBAAqB/Q,KAAK,MAC/BhD,KAAK2U,qBAAqB3R,KAAK,MAC/BhD,KAAK4U,wBAAwB5R,KAAK,MAClChD,KAAK6U,iBAAiB7R,MAAK,KAI/BiQ,EAAA/S,UAAA0W,uBAAA,SAAuBC,EAAY1B,OAC3B2B,EAAW,IAAIC,SACrBD,EAASE,OAAO,WAAYH,EAAMA,EAAK7O,UACjCiP,EAAM,IAAIC,KAAAA,YAAY,OAAQlX,KAAKiV,kBAAmB,cAAgBE,EAAShI,GAAK,aAAc2J,EAAU,CAChHK,gBAAgB,IAElB,OAAOnX,KAAKkT,KAAKkE,QAAQH,GACtBzB,KACCC,UAAAA,IAAG,SAACC,GAAO,OAAAA,IACX2B,UAAAA,WAAU,SAACnB,GACT,OAAOoB,KAAAA,WAAqBpB,OAKpCjD,EAAA/S,UAAAqX,oBAAA,SAAoBnB,GAApB,IAAA3C,EAAAzT,KAQE,OAPAA,KAAKwX,YAAcxX,KAAKoT,iBAAiBqE,kCAAkCrB,GAAYZ,KACrFC,UAAAA,IAAG,SAAEiC,GAEH,OADAjE,EAAK+D,YAAcE,EAAK,GACjBjE,EAAK+D,eAITxX,KAAKwX,aAGdvE,EAAA/S,UAAAyX,wBAAA,SAAwBvB,EAAYoB,GAClC,GAAIpB,GAAcoB,EAChB,OAAOxX,KAAKoT,iBAAiBwE,iCAAiCxB,EAAYoB,GAAahC,KACrFC,UAAAA,IAAG,SAACoC,GAEF,OADeC,IAAIC,gBAAgBF,OAM3C5E,EAAA/S,UAAA8X,oBAAA,SAAoBC,GAClBjY,KAAKwX,YAAcS,GAGrBhF,EAAA/S,UAAAgY,gBAAA,SAAgBtF,EAAU7J,EAASqN,OAC3B9S,EAAO,CACXoT,SAAU3N,EACVoP,YAAapP,EACbqP,YAAaxF,EAASzF,IAExB,OAAOnN,KAAKkT,KAAKqC,KAAYvV,KAAKiV,kBAAmB,cAAcmB,EAAU,SAAU9S,GACpFkS,KACCC,UAAAA,IAAG,SAAEC,GAAe,OAAAA,IACpB2B,UAAAA,WAAU,SAACnB,GACT,OAAOoB,KAAAA,WAAqBpB,OAKpCjD,EAAA/S,UAAAmY,iBAAA,SAAiBzF,EAAU0F,EAAoBlC,GAA/C,IAAA3C,EAAAzT,KACE,OAAOuY,KAAAA,KAAKD,GACT9C,KACCgD,UAAAA,SAAQ,SAACzP,OACD0P,EAAO,CACX/B,SAAU3N,EACVoP,YAAapP,EACbqP,YAAaxF,EAASzF,IAExB,OAA0BsG,EAAKP,KAAKqC,KAAK9B,EAAKwB,kBAAmB,cAAcmB,EAAU,SAAUqC,GAAMjD,KAAKkD,UAAAA,MAAM,UAK5HzF,EAAA/S,UAAAyY,oBAAA,SAAoBxD,EAAqByD,EAAmBpY,EAAG+E,GAA/D,IAAAkO,EAAAzT,KACE,OAAOA,KAAKkT,KACT2F,OAAa7Y,KAAKiV,kBAAmB,cAAgBE,EAAShI,GAAK,WAAayL,EAAUE,QAC1FtD,KACCC,UAAAA,IAAG,SAACjN,OACID,EAAagB,OAAAA,UAAU4L,EAASjJ,MAAM1L,GAAG0H,OAAQ,CAAEF,KAAM4Q,IACzDG,EAAYxP,OAAAA,UAAU4L,EAAS7I,MAAO,CAAEtE,KAAMmN,EAASjJ,MAAM1L,GAAG0H,OAAOK,GAAYwE,YAEzF,GAAIgM,GAAa,EAAG,KACZC,EAAiBzP,OAAAA,UAAU4L,EAAS7I,MAAMyM,GAAW7Q,OAAQ,CAAEF,KAAM4Q,IACvEI,GAAkB,GACpB7D,EAAS7I,MAAMyM,GAAW7Q,OAAO+Q,OAAOD,EAAgB,GAO5D,OAJA7D,EAASjJ,MAAM1L,GAAG0H,OAAO+Q,OAAO1Q,EAAY,GAC5CkL,EAAKuC,oBAAoBb,GACzB1B,EAAKe,kBAAkBxR,KAAK,SAC5ByQ,EAAKkD,eAAexB,EAAS7I,OACtB6I,MAKflC,EAAA/S,UAAAgZ,qBAAA,SAAqBC,EAAsBhE,WACzC,GAAIgE,GAAcA,EAAWxY,OAAS,EAAG,KACjCuL,EAAQiJ,EAASjJ,UACvB,IAAwB,IAAAkN,EAAAC,SAAAF,GAAUG,EAAAF,EAAApW,QAAAsW,EAAAnW,KAAAmW,EAAAF,EAAApW,OAChC,IADG,IAAM4V,EAASU,EAAAxW,MACTwG,EAAI,EAAGA,EAAI4C,EAAMvL,OAAQ2I,IAAK,KAC/Bf,EAAagB,OAAAA,UAAU2C,EAAM5C,GAAGpB,OAAQ,CAAEF,KAAM4Q,IAClDrQ,GAAc,GAChB4M,EAASjJ,MAAM5C,GAAGpB,OAAO+Q,OAAO1Q,EAAY,qGAIlDvI,KAAK2W,eAAexB,EAAS7I,SAIjC2G,EAAA/S,UAAAqZ,iBAAA,SAAiBC,EAAkBhZ,EAAG+E,EAAG4P,GAAzC,IAAA1B,EAAAzT,KAEE,OADAwZ,EAASxR,KAAOwR,EAASxR,KAAK8Q,OACvB9Y,KAAKkT,KACTqC,KAAavV,KAAKiV,kBAAmB,cAAgBuE,EAASC,YAAc,UAAWD,GACvFhE,KACCC,UAAAA,IAAG,SAACjN,GACFiL,EAAKF,aAAamG,YAAY,CAC5BC,SAAU,WACVnI,OAAQ,YAAYhJ,EAAME,KAAI,eAC9B/E,MAAO,gBAAgB6V,EAASC,cAElCtE,EAASjJ,MAAM1L,GAAG0H,OAAO3C,GAAKiD,EAC9BiL,EAAKkD,eAAexB,EAAS7I,WACvByM,EAAYxP,OAAAA,UAAU4L,EAAS7I,MAAO,CAAEtE,KAAMQ,EAAMuE,YAK1D,OAJIgM,GAAa,GACf5D,EAAS7I,MAAMyM,GAAmB,OAAEvU,KAAKgE,GAE3CiL,EAAKE,gBAAgB3Q,KAAKmS,GACnBA,MAKflC,EAAA/S,UAAA0Z,qBAAA,SAAqBzM,GACnB,OAAOnN,KAAKoT,iBAAiBwG,qBAAqBzM,IAGpD8F,EAAA/S,UAAA2Z,oBAAA,SAAoB1E,EAAqB7R,EAAcwW,EAAStZ,EAAG+E,GAAnE,IAAAkO,EAAAzT,KAEE,OADA8Z,EAAUA,EAAQhB,OACX9Y,KAAKkT,KACT6G,IAAY/Z,KAAKiV,kBAAmB,cAAgBE,EAAShI,GAAK,WAAa2M,EAASxW,GACxFkS,KACCC,UAAAA,IAAG,SAACjN,GACFiL,EAAKF,aAAamG,YAAY,CAC5BC,SAAU,WACVnI,OAAQ,YAAYhJ,EAAME,KAAI,iBAC9B/E,MAAO,gBAAgBwR,EAAShI,SAE5B5E,EAAagB,OAAAA,UAAU4L,EAASjJ,MAAM1L,GAAG0H,OAAQ,CAAEF,KAAM8R,IAC3DtR,EAAMwR,cAAgB,IAAMxZ,GAC9B2U,EAASjJ,MAAM1L,GAAG0H,OAAO+Q,OAAO1Q,EAAY,GAC5C4M,EAASjJ,MAAM1D,EAAMwR,cAAgB,GAAG9R,OAAO1D,KAAKgE,IAEpD2M,EAASjJ,MAAM1L,GAAG0H,OAAOK,GAAcC,MAEnCuQ,EAAYxP,OAAAA,UAAU4L,EAAS7I,MAAO,CAAEtE,KAAMQ,EAAMuE,YAM1D,OALIgM,GAAa,IACf5D,EAAW1B,EAAKwG,gBAAgB9E,EAAU3M,EAAOuQ,EAAWe,IAE9DrG,EAAKE,gBAAgB3Q,KAAKmS,GAC1B1B,EAAKe,kBAAkBxR,KAAK,SACrBmS,MAKflC,EAAA/S,UAAA+Z,gBAAA,SAAgB9E,EAAqB+E,EAAeC,EAAYC,OACxDC,EAAc9Q,OAAAA,UAAU4L,EAAS7I,MAAM6N,GAAYjS,OAAQ,CAAEF,KAAMoS,IAMzE,OALIC,GAAe,EACjBlF,EAAS7I,MAAM6N,GAAYjS,OAAOmS,GAAeH,EAEjD/E,EAAS7I,MAAM6N,GAAYjS,OAAO1D,KAAK0V,GAElC/E,GAGTlC,EAAA/S,UAAAoa,oBAAA,SAAoBnF,EAAqB7R,EAAWwW,EAAStZ,EAAG+E,GAAhE,IAAAkO,EAAAzT,KAEE,OADA8Z,EAAUA,EAAQhB,OACX9Y,KAAKkT,KACT6G,IAAS/Z,KAAKiV,kBAAmB,cAAgBE,EAAShI,GAAK,WAAa2M,EAASxW,GACrFkS,KACCC,UAAAA,IAAG,SAACjN,OACID,EAAagB,OAAAA,UAAU4L,EAASjJ,MAAM1L,GAAG0H,OAAQ,CAAEF,KAAM8R,IAI/D,OAHA3E,EAASjJ,MAAM1L,GAAG0H,OAAOK,GAAcC,EACvCiL,EAAKE,gBAAgB3Q,KAAKmS,GAC1B1B,EAAKe,kBAAkBxR,KAAK,SACrBmS,MAKflC,EAAA/S,UAAAqa,eAAA,SAAed,EAAqBe,GAClC,OAAOxa,KAAKoT,iBAAiBmH,eAAed,EAAae,IAG3DvH,EAAA/S,UAAAua,wBAAA,SAAwBjS,GACtBxI,KAAKuU,sBAAsBvR,KAAKwF,IAGlCyK,EAAA/S,UAAAyW,eAAA,SAAerK,WACTuH,GAAY,EAChB,GAAIvH,GAASA,EAAM3L,OAAS,MAC1B,IAAiB,IAAA+Z,EAAArB,SAAA/M,GAAKqO,EAAAD,EAAA1X,QAAA2X,EAAAxX,KAAAwX,EAAAD,EAAA1X,OAAE,CAAnB,IAAIoF,EAAIuS,EAAA7X,MACPsF,GAAsB,WAAdA,EAAKM,MAA4C,IAAvBN,EAAKF,OAAOvH,SAChDkT,GAAY,0GAIhBA,GAAY,EAEd7T,KAAK6T,UAAYA,EACjB7T,KAAK6U,iBAAiB7R,KAAKhD,KAAK6T,YAGlCZ,EAAA/S,UAAA+V,eAAA,SAAe2E,EAAeC,QAAA,IAAAA,IAAAA,EAAA,OAiB9B5H,EAAA/S,UAAA4a,YAAA,SAAY1E,GAEV,MADwB,YAAYA,EAAU,SAIhDnD,EAAA/S,UAAA6a,aAAA,SAAa3E,GAEX,MADyB,YAAYA,EAAU,UAIjDnD,EAAA/S,UAAA8a,gBAAA,SAAgB5E,GAEd,MADoB,YAAYA,EAAU,WAI5CnD,EAAA/S,UAAA+a,mBAAA,SAAmB7E,GAEjB,MAD0B,aAAaA,GAIzCnD,EAAA/S,UAAAgb,aAAA,SAAa9E,EAAoB+E,EAAiBC,EAAgB5a,EAAG+E,OAC7D8V,EAAgB3L,KAAK4L,UAAU,CACnCC,SAAUJ,EACVK,QAASJ,IAEX,OAAOpb,KAAKkT,KACTqC,KAAgBvV,KAAKiV,kBAAmB,aAAemB,EAAa,cAAeiF,GAAe/E,YAAYlT,KAAI,SAACqY,GAClH,OAAOA,KAIbxI,EAAA/S,UAAAwb,QAAA,SAAQtT,EAAuB+M,GAA/B,IAAA1B,EAAAzT,KACQ2b,EAAkB3b,KAAKiV,kBAAmB,cAAgBE,EAAShI,GAAK,SAC9EnN,KAAKsM,MAAQ,GACbtM,KAAKsM,MAAQtM,KAAKsM,MAAMpH,OAAOkD,OACzBwT,EAAe,GAKrB,OAJA5b,KAAKsM,MAAMuP,QAAO,SAACzT,GACjBwT,EAAapX,KAAKiP,EAAKP,KAAKqC,KAAKoG,EAAiBvT,MAGhDpI,KAAKsM,OAAStM,KAAKsM,MAAM3L,OAAS,EAC7Bmb,KAAAA,SAASF,GAAcpG,KAC5BC,UAAAA,IAAG,SAACsG,GACFA,EAAW7W,OAAM,GACZiQ,EAAgB,QACnBA,EAAgB,MAAC,QAEb6G,EAAuBD,EAAWtG,IAAG,SAACwG,GAE1C,OADAA,EAAgB,OAAI,GACbA,IAQT,OANA9G,EAAgB,MAAIA,EAAgB,MAAEjQ,OAAO8W,GAC7CvI,EAAKC,WAAaD,EAAK8C,UAAUpB,GACjC1B,EAAKnH,MAAQmH,EAAKC,WAClBD,EAAKE,gBAAgB3Q,KAAKmS,GAC1B1B,EAAKO,kBAAkBhR,KAAKyQ,EAAKC,YACjCD,EAAKC,WACEyB,GACR,SAAGe,GAGF,OAFArF,QAAQ7L,MAAMkR,GACdrF,QAAQ7L,MAAM,+BACPkR,KAIJgG,KAAAA,GAAG/G,IAIdlC,EAAA/S,UAAAic,iBAAA,SAAiB3T,GACfxI,KAAKsU,iBAAiBtR,KACpB,CACE0F,KAAM,iBACNsR,cAAexR,EAAMwR,cACrB1S,WAAYkB,EAAMR,QAKxBiL,EAAA/S,UAAAkc,cAAA,SAAc5T,GACZxI,KAAKsU,iBAAiBtR,KACpB,CACE0F,KAAM,qBACNsR,cAAexR,EAAMwR,cACrB1S,WAAYkB,EAAMR,QAKxBiL,EAAA/S,UAAAmc,mBAAA,SAAmB/P,GAEjB,QADMgQ,EAAkB,GACfvD,EAAY,EAAGA,EAAYzM,EAAM3L,OAAQoY,IAAa,KACvDwD,EAAgBjQ,EAAMyM,GAAqB,SAAI,EAC/C3Q,EAAIhI,SAAA,GAAQkM,EAAMyM,IACxB3Q,EAAY,MAAI,CACdsC,gBAAiB,GAAG1K,KAAKsN,aAAalF,EAAKJ,KAAM+Q,IAE9CuD,EAAgBC,GAGnBD,EAAgBC,GAAe/X,KAAK4D,GAFpCkU,EAAgBC,GAAiB,CAACnU,GAOtC,OAFApI,KAAK4U,wBAAwB5R,KAAKsZ,EAAgB3b,QAClDX,KAAK2U,qBAAqB3R,KAAKsJ,EAAM3L,QAC9B2b,GAGTrJ,EAAA/S,UAAAsc,WAAA,SAAWC,EAAUtH,GAArB,IAAA1B,EAAAzT,KACE,OAAOA,KAAKkT,KAAK2F,OAAO7Y,KAAKiV,kBAAmB,cAAgBE,EAAShI,GAAK,UAAYsP,GACvFnG,YACAlT,KAAI,WACHsZ,OAAAA,OAAOvH,EAAS7I,MAAK,SAAGlE,WAEtB,GADAqL,EAAKC,WAAaD,EAAK8C,UAAUpB,GAC7B/M,EAAKJ,OAASyU,EAAU,KACpBvU,EAASE,EAAKF,OACdiR,EAAa,OACnB,IAAoB,IAAAwD,EAAAtD,SAAAnR,GAAM0U,EAAAD,EAAA3Z,QAAA4Z,EAAAzZ,KAAAyZ,EAAAD,EAAA3Z,OAAE,CAAvB,IAAMwF,EAAKoU,EAAA9Z,MACdqW,EAAW3U,KAAKgE,EAAMR,wGAExByL,EAAKyF,qBAAqBC,EAAYhE,GAIxC,OAFA1B,EAAKE,gBAAgB3Q,KAAKmS,GAC1B1B,EAAKO,kBAAkBhR,KAAKyQ,EAAKC,YAC1BtL,EAAKJ,OAASyU,OAK7BxJ,EAAA/S,UAAA2c,YAAA,SAAYC,EAA0B3H,GAAtC,IAAA1B,EAAAzT,KACQ+c,EAAc,GAQpB,OAPAD,EAAUjB,QAAO,SAAC9O,GAChBoI,EAAQ/U,SAAA,GACH+U,EAAQ,CACX7I,MAAO6I,EAAS7I,MAAM0Q,OAAM,SAAC5U,GAAQ,OAAAA,EAAKJ,OAAS+E,MAErDgQ,EAAYvY,KAAKiP,EAAKP,KAAK2F,OAAOpF,EAAKwB,kBAAmB,cAAgBE,EAAShI,GAAK,UAAYJ,MAE/F+O,KAAAA,SAASiB,GAAavH,KAC3BC,UAAAA,IAAG,WACD,OAAON,GACR,SAAEe,GAGD,OAFArF,QAAQ7L,MAAMkR,GACdrF,QAAQ7L,MAAM,iCACPkR,MAKbjD,EAAA/S,UAAA+c,YAAA,SAAY3Q,EAAO6I,GAAnB,IAAA1B,EAAAzT,KACQkd,EAAc,GAoCpB,OAnCA5Q,EAAMuP,QAAO,SAACzT,OACN9E,EAAO,CACXmW,YAAatE,EAAShI,GACtBnF,KAAMI,EAAKJ,KAAK8Q,OAChBhR,UAAWM,EAAKN,UAChBqV,MAAO/U,EAAK+U,MACZzG,SAAUtO,EAAKsO,SACfhO,KAAMN,EAAKM,KACX0U,UAAWhV,EAAKgV,UAChB7L,QAASnJ,EAAKmJ,QACd8L,MAAOjV,EAAKiV,OAGRlD,EAAa5Q,OAAAA,UAAU4L,EAAS7I,MAAO,CAAEtE,KAAMI,EAAKgS,WACtDD,GAAc,IAChBhF,EAAS7I,MAAM6N,GAAW/Z,SAAA,GACrB+U,EAAS7I,MAAM6N,GAAW,CAC7BV,YAAatE,EAAShI,GACtBnF,KAAMI,EAAKJ,KAAK8Q,OAChBhR,UAAWM,EAAKN,UAChBqV,MAAO/U,EAAK+U,MACZzG,SAAUtO,EAAKsO,SACfhO,KAAMN,EAAKM,KACX0U,UAAWhV,EAAKgV,UAChB7L,QAASnJ,EAAKmJ,QACd8L,MAAOjV,EAAKiV,SAGhB5J,EAAKF,aAAamG,YAAY,CAC5BC,SAAU,WACVnI,OAAQ,wBACR7N,MAAO,gBAAgBwR,EAAShI,KAElC+P,EAAY1Y,KAAKiP,EAAKP,KAAK6G,IAAItG,EAAKwB,kBAAmB,cAAgBE,EAAShI,GAAK,UAAY/E,EAAKgS,SAAU9W,MAE3GwY,KAAAA,SAASoB,GACb1H,KACCC,UAAAA,IAAG,WACD,OAAON,GACR,SAAGe,GAGF,OAFArF,QAAQ7L,MAAMkR,GACdrF,QAAQ7L,MAAM,+BACPkR,MAIfjD,EAAA/S,UAAAqW,UAAA,SAAUpB,GACR,GAAIA,EAAS7I,MAAM3L,OAAS,EAC1B,MAAO,GAUT,QAPM2L,EAAQ6I,EAAS7I,MAAMmK,KAAI,SAAEnR,EAAU/F,GAC3C,OAAI+F,EAAEoR,WAAanX,EAAEmX,SACZpR,EAAE0C,KAAKW,cAAgBpJ,EAAEyI,KAAKW,eAAiB,EAAIrD,EAAE0C,KAAKW,cAAgBpJ,EAAEyI,KAAKW,cAAgB,EAAI,EAEvGrD,EAAEoR,SAAWnX,EAAEmX,WAGfpN,EAAI,EAAGA,EAAIgD,EAAM3L,OAAQ2I,IAChCgD,EAAMhD,GAAS,KAAIqE,IAAAA,QAAQrE,GAI7B,OAFA6L,EAAS7I,MAAQA,EAEVA,GAGT2G,EAAA/S,UAAAoN,aAAA,SAAatF,EAAM0F,EAAQyH,GACzB,OAAc,OAAVzH,GAAkBA,GAAS,EACtBC,IAAAA,QAAQD,GACNyH,GACLA,EAAS7I,OAAS6I,EAAS7I,MAAM3L,OAAS,GAC5C+M,EAAQnE,OAAAA,UAAU4L,EAAS7I,MAAO,CAAEtE,KAAMA,MAC7B,EACJmN,EAAS7I,MAAMoB,GAAOE,KAAOuH,EAAS7I,MAAMoB,GAAOE,KAAOD,IAAAA,QAAQD,QAD3E,EAOKG,IAAAA,WAAW7F,IAItBiL,EAAA/S,UAAAod,eAAA,SAAelV,EAAa+M,GAC1B,IADF,IAAA1B,EAAAzT,KACWQ,EAAI,EAAGA,EAAI2U,EAASjJ,MAAMvL,OAAQH,IACzC,GAAI2U,EAASjJ,MAAM1L,GAAG0H,OAAOvH,OAAS,EACpC,IAAK,IAAI4E,EAAI,EAAGA,EAAI4P,EAASjJ,MAAM1L,GAAG0H,OAAOvH,OAAQ4E,IACnD,GAAyC,gBAArC4P,EAASjJ,MAAM1L,GAAG0H,OAAO3C,GAAGmD,MAA0E,cAAhDyM,EAASjJ,MAAM1L,GAAG0H,OAAO3C,GAAG+C,QAAc,MAC9F6M,EAASjJ,MAAM1L,GAAG0H,OAAO3C,GAAG+C,QAAgB,SAAMF,EAAKN,WACzDqN,EAASjJ,MAAM1L,GAAG0H,OAAO3C,GAAGwH,YAAc3E,EAAKJ,KAAM,CACrDmN,EAASjJ,MAAM1L,GAAG0H,OAAO3C,GAAG+C,QAAgB,OAAIF,EAAKN,cAC/CyV,EAAYnd,SAAA,GAAQ+U,EAASjJ,MAAM1L,GAAG0H,OAAO3C,IACnDvF,KAAK6Z,oBAAoB1E,EAAUoI,EAAcA,EAAavV,KAAMxH,EAAG+E,GAAG+Q,YAAYlT,KAAI,WACxFqQ,EAAKE,gBAAgB3Q,KAAKmS,OASxClC,EAAA/S,UAAAsd,oBAAA,SAAoBC,GAClBzd,KAAKyd,iBAAmBA,EACxBzd,KAAK0U,wBAAwB1R,KAAKhD,KAAKyd,mBAGnCxK,EAAA/S,UAAAwd,cAAN,SAAoBvI,iGAClB,MAAA,CAAA,EAAO,IAAIzS,QAAO,SAAQC,EAASC,GAAM,OAAAP,UAAAoR,OAAA,OAAA,EAAA,4EACpB,MAAA,CAAA,EAAMzT,KAAK0b,QAAO,CAAG1T,KAAM,WAAYU,KAAM,SAAUgO,SAAU,GAAcvB,GAAUmB,2BAAtG5C,EAAaiK,EAAA/Z,OACnB5D,KAAKiU,uBAAuBjR,KAAK0Q,EAAW,IAC5CkK,WAAU,WACRjb,KACC,sBAIPsQ,EAAA/S,UAAA2d,aAAA,SAAa1I,GACPnV,KAAK8d,eAAe3I,GACtBnV,KAAKmT,OAAO4K,SAAS,CAAC,YAAY5I,EAAShI,KAClCnN,KAAKge,YAAY7I,GAC1BnV,KAAKmT,OAAO4K,SAAS,CAAC,WAAW5I,EAAShI,GAAE,YAE5CnN,KAAKsT,gBAAgBhC,KAAK,+EAI9B2B,EAAA/S,UAAA8d,YAAA,SAAY7I,GAEV,OADiBnV,KAAKqT,cAAc4K,iBAAiBC,IAAAA,gBAAgBC,MAAOhJ,GAChD,YAG9BlC,EAAA/S,UAAA4d,eAAA,SAAe3I,WAETiJ,EADEC,EAAiBre,KAAKqT,cAAc4K,iBAAiBC,IAAAA,gBAAgBI,KAAMnJ,GAAWoJ,WAEtFC,EAAUxB,OAAAA,OAAO7H,EAAS7I,MAAO,CAAE5D,KAAM,WAC/C0V,EAAaI,GAAWA,EAAQ7d,OAAS,MACzC,IAAqB,IAAA8d,EAAApF,SAAAmF,GAAOE,EAAAD,EAAAzb,QAAA0b,EAAAvb,KAAAub,EAAAD,EAAAzb,OAAE,CAAzB,IAAM2b,EAAMD,EAAA5b,MACfsb,EAAaO,EAAe,QAAKA,EAAe,OAAEhe,OAAS,oGAE7D,OAAO0d,GAAiBD,uBA5pB3BzM,KAAAA,sDA1BQiN,KAAAA,kBACAC,OAAAA,cAEPC,IAAAA,wBAQAC,IAAAA,6BAUOjO,uBACAkO,aAAAA,2BAvBYC,KAAAA,YAyrBrBhM,KC1rBA,IAAAiM,eAAA,WAGA,SAAAA,IAOSlf,KAAAmf,oBAA8C,IAAIvL,KAAAA,cAClD5T,KAAAof,6BAAuD,IAAIxL,KAAAA,cAAc,EAAG,KAC5E5T,KAAAqf,kBAA4C,IAAIzL,KAAAA,cAChD5T,KAAAsf,mBAA6C,IAAI1L,KAAAA,cACjD5T,KAAAuf,kBAAwC,IAAI3L,KAAAA,cAAc,EAAG,KAC7D5T,KAAAwf,qBAA+C,IAAI5L,KAAAA,cA8D5D,OA1DEsL,EAAAhf,UAAAuf,cAAA,WACEzf,KAAK0f,cAAgB1f,KAAK0f,aAC1B1f,KAAKmf,oBAAoBnc,KAAKhD,KAAK0f,eACT,IAAtB1f,KAAK0f,cACP1f,KAAKqf,kBAAkBrc,MAAK,IAIhCkc,EAAAhf,UAAAyf,uBAAA,WACE3f,KAAK4f,uBAAyB5f,KAAK4f,sBACnC5f,KAAKof,6BAA6Bpc,KAAKhD,KAAK4f,wBACT,IAA/B5f,KAAK4f,uBACP5f,KAAKsf,mBAAmBtc,MAAK,IAIjCkc,EAAAhf,UAAA2f,YAAA,WACE7f,KAAK0f,cAAe,EACpB1f,KAAKmf,oBAAoBnc,KAAKhD,KAAK0f,eAGrCR,EAAAhf,UAAA4f,qBAAA,WACE9f,KAAK4f,uBAAwB,EAC7B5f,KAAKof,6BAA6Bpc,KAAKhD,KAAK4f,wBAG9CV,EAAAhf,UAAA6f,aAAA,WACE/f,KAAK0f,cAAe,EACpB1f,KAAKmf,oBAAoBnc,KAAKhD,KAAK0f,cACnC1f,KAAKqf,kBAAkBrc,MAAK,IAG9Bkc,EAAAhf,UAAA8f,sBAAA,WACEhgB,KAAK4f,uBAAwB,EAC7B5f,KAAKof,6BAA6Bpc,KAAKhD,KAAK4f,uBAC5C5f,KAAKsf,mBAAmBtc,MAAK,IAG/Bkc,EAAAhf,UAAA+f,cAAA,SAAc7X,GACZpI,KAAKkgB,WAAa9X,EAClBpI,KAAKwf,qBAAqBxc,MAAK,IAGjCkc,EAAAhf,UAAAsc,WAAA,WACQxc,KAAKkgB,aACTlgB,KAAKuf,kBAAkBvc,KAAKhD,KAAKkgB,YACjClgB,KAAKkgB,WAAa,KAClBlgB,KAAKwf,qBAAqBxc,MAAK,KAInCkc,EAAAhf,UAAAigB,gBAAA,WACE,OAAOngB,KAAK0f,cAGdR,EAAAhf,UAAAkgB,yBAAA,WACE,OAAOpgB,KAAK4f,2CAxEfjO,KAAAA,aA0EDuN,EA7EA,GCAA,IAAAmB,kBAAA,WASA,SAAAA,IAEUrgB,KAAAsgB,WAAa,IACbtgB,KAAAugB,YAAc,IACdvgB,KAAAwgB,OAAS,EACTxgB,KAAAygB,OAAS,EACTzgB,KAAA0gB,WAAa,CACnBpX,EAAG,IACH9F,EAAG,MAEGxD,KAAA2gB,YAAc,CACpBrX,EAAGtJ,KAAK0gB,WAAWld,EACnBA,EAAGxD,KAAK0gB,WAAWpX,GAEbtJ,KAAA4gB,WAAa,CACnBtX,EAAG,IACH9F,EAAG,KAEGxD,KAAA6gB,YAAc,CACpBvX,EAAGtJ,KAAK4gB,WAAWpd,EACnBA,EAAGxD,KAAK4gB,WAAWtX,GAEbtJ,KAAA8gB,WAAa,CACnBxX,EAAG,IACH9F,EAAG,KAEGxD,KAAA+gB,YAAc,CACpBzX,EAAGtJ,KAAK8gB,WAAWtd,EACnBA,EAAGxD,KAAK8gB,WAAWxX,GAEbtJ,KAAAghB,eAAiB,CACvB1X,EAAG,IACH9F,EAAG,KAEGxD,KAAAihB,gBAAkB,CACxB3X,EAAGtJ,KAAKghB,eAAexd,EACvBA,EAAGxD,KAAKghB,eAAe1X,GAEjBtJ,KAAAkhB,cAAgB,CACtB5X,EAAG,IACH9F,EAAG,MAEGxD,KAAAmhB,eAAiB,CACvB7X,EAAGtJ,KAAKkhB,cAAc1d,EACtBA,EAAGxD,KAAKkhB,cAAc5X,GAEhBtJ,KAAAohB,cAAgB,CACtBphB,KAAK0gB,WAAY1gB,KAAK4gB,WAAY5gB,KAAK8gB,WAAY9gB,KAAKghB,eAAgBhhB,KAAKkhB,eAEvElhB,KAAAqhB,eAAiB,CACvBrhB,KAAK2gB,YAAa3gB,KAAK6gB,YAAa7gB,KAAK+gB,YAAa/gB,KAAKihB,gBAAiBjhB,KAAKmhB,gBAE3EnhB,KAAAshB,WAAa,EACbthB,KAAAuhB,YAAc,EACdvhB,KAAAwhB,UAAY,GA0KtB,OAxKEnB,EAAAngB,UAAAuhB,UAAA,SAAU7X,EAAOD,GACf3J,KAAKshB,WAAa1X,EAClB5J,KAAKuhB,YAAc5X,GAGrB0W,EAAAngB,UAAAwhB,aAAA,SAAaF,GACXxhB,KAAKwhB,UAAYA,GAGnBhiB,OAAAqC,eAAIwe,EAAAngB,UAAA,SAAM,KAAV,WACE,OAAOF,KAAKwgB,wCAGdH,EAAAngB,UAAAyhB,UAAA,SAAU7e,GACR9C,KAAKwgB,OAAS1d,GAGhBtD,OAAAqC,eAAIwe,EAAAngB,UAAA,SAAM,KAAV,WACE,OAAOF,KAAKygB,wCAGdJ,EAAAngB,UAAA0hB,UAAA,SAAU9e,GACR9C,KAAKygB,OAAS3d,GAGhBud,EAAAngB,UAAA6K,QAAA,SAAQvH,EAAGwH,EAAaC,EAAcC,GAQpC,OAPKD,IACHA,EAAcjL,KAAKugB,aAGhBrV,IACHA,EAASlL,KAAKkL,QAETD,GAAgBzH,EAAIwH,GAAeE,GAG5CmV,EAAAngB,UAAAmL,UAAA,SAAU7H,EAAG4H,GAIX,OAHKA,IACHA,EAAQpL,KAAKkL,QAER1H,EAAI4H,GAGbiV,EAAAngB,UAAAiL,SAAA,SAAS7B,EAAG8B,GAIV,OAHKA,IACHA,EAAQpL,KAAKoM,QAER9C,EAAI8B,GAGbiV,EAAAngB,UAAA2hB,aAAA,SAAavY,EAAG8C,GAId,OAHKA,IACHA,EAASpM,KAAKoM,QAET9C,EAAI8C,GAGbiU,EAAAngB,UAAA4hB,uBAAA,SAAuBte,EAAGwH,EAAauW,EAAcrW,GAKnD,OAJKqW,IACHA,EAAcvhB,KAAKuhB,aAGbA,EAAc/d,EADLwH,GAInBqV,EAAAngB,UAAA6hB,eAAA,SAAeve,GACb,OAAOA,GAGT6c,EAAAngB,UAAA2K,iBAAA,SAAiBrC,GACf,OAAOqC,iBAAiBrC,IAG1B6X,EAAAngB,UAAA4K,gBAAA,SAAgBtC,GACd,OAAOsC,gBAAgBtC,IAGzB6X,EAAAngB,UAAAoL,kBAAA,SAAkB9C,EAAOyF,EAAY7B,EAASlB,GAO5C,OANKkB,IACHA,EAASpM,KAAKoM,QAEXlB,IACHA,EAASlL,KAAKkL,QAETI,kBAAkB9C,IAG3B6X,EAAAngB,UAAA8hB,kBAAA,SAAkBxZ,EAAOc,EAAG9F,EAAGyK,OACzB3F,EAyEJ,MAxEmB,YAAfE,EAAME,MAAqC,SAAfF,EAAME,MAAkC,gBAAfF,EAAME,MAC7DJ,EAAU,CACRsB,MAAOpB,EAAMF,QAAQsB,MAAQpB,EAAMF,QAAQsB,MAAQ,IACnDD,OAAQnB,EAAMF,QAAQqB,OAASnB,EAAMF,QAAQqB,OAAS,GACtDL,EAAGd,EAAMF,QAAQgB,EAAId,EAAMF,QAAQgB,EAAIA,EACvC9F,EAAGxD,KAAK8hB,uBAAuBte,EAAGgF,EAAMF,QAAQqB,OAASnB,EAAMF,QAAQqB,OAAS,GAAIsE,IAEnE,SAAfzF,EAAME,OACRJ,EAAQsB,MAAQ,KAEM,cAAfpB,EAAME,KACfJ,EAAU,CACRsB,MAAOpB,EAAMF,QAAQsB,MAAQpB,EAAMF,QAAQsB,MAAQ,GACnDD,OAAQnB,EAAMF,QAAQqB,OAASnB,EAAMF,QAAQqB,OAAS,GACtDL,EAAGd,EAAMF,QAAQgB,EAAId,EAAMF,QAAQgB,EAAIA,EACvC9F,EAAGxD,KAAK8hB,uBAAuBte,EAAGgF,EAAMF,QAAQqB,OAASnB,EAAMF,QAAQqB,OAAS,GAAIsE,IAE9D,cAAfzF,EAAME,MAAuC,YAAfF,EAAME,KAC7CJ,EAAU,CACRgB,EAAGd,EAAMF,QAAQgB,EAAId,EAAMF,QAAQgB,EAAIA,EACvC9F,EAAGxD,KAAK8hB,uBAAuBte,EAAG,GAAIyK,IAEhB,mBAAfzF,EAAME,KACfJ,EAAU,CACRjB,QAAS,CAAC,CACR8F,GAAI8U,KAAAA,KACJ3Y,EAAGd,EAAMF,QAAQgB,EAAId,EAAMF,QAAQgB,EAAIA,EACvC9F,EAAGxD,KAAK8hB,uBAAuBte,EAAG,KAAMyK,GACxChB,SAAS,EACTnK,MAAO,cAGa,uBAAf0F,EAAME,KACfJ,EAAU,CACRjB,QAAS,CAAC,CACR8F,GAAI8U,KAAAA,KACJ3Y,EAAGd,EAAMF,QAAQgB,EAAId,EAAMF,QAAQgB,EAAIA,EACvC9F,EAAGxD,KAAK8hB,uBAAuBte,EAAG,KAAMyK,GACxCf,UAAU,EACVpK,MAAO,cAGa,aAAf0F,EAAME,KACfJ,EAAU,CACRgB,EAAGd,EAAMF,QAAQgB,EAAId,EAAMF,QAAQgB,EAAIA,EACvC9F,EAAGxD,KAAK8hB,uBAAuBte,EAAG,GAAIyK,GACtCrE,MAAOpB,EAAMF,QAAQsB,MAAQpB,EAAMF,QAAQsB,MAAQ,GACnDD,OAAQnB,EAAMF,QAAQqB,OAASnB,EAAMF,QAAQqB,OAAS,GACtD7G,MAAO,KACPof,YAAa,SACb7a,QAAS,CAAC,CACR8F,GAAI8U,KAAAA,KACJnf,MAAO,cAGa,eAAf0F,EAAME,KACfJ,EAAU,CACRgB,EAAGd,EAAMF,QAAQgB,EAAId,EAAMF,QAAQgB,EAAIA,EACvC9F,EAAGxD,KAAK8hB,uBAAuBte,EAAG,GAAIyK,GACtCtK,MAAO,IAEe,YAAf6E,EAAME,OACfJ,EAAU,CACRgB,EAAGd,EAAMF,QAAQgB,EAAId,EAAMF,QAAQgB,EAAIA,EACvC9F,EAAGxD,KAAK8hB,uBAAuBte,EAAG,GAAIyK,GACtCkU,WAAY,GACZC,SAAU,MACVC,iBAAkB,SAClBC,OAAQ,EACRC,iBAAiB,IAGdja,GAGT+X,EAAAngB,UAAAsiB,kBAAA,SAAkBC,EAAWC,GAC3B1iB,KAAKugB,YAAckC,EACnBziB,KAAKsgB,WAAaoC,uBA9NrB/Q,KAAAA,aAgOD0O,EAzOA,mCCyCE,SAAAsC,EACUC,EACApP,EACAqP,EACAC,GAHA9iB,KAAA4iB,WAAAA,EACA5iB,KAAAwT,SAAAA,EACAxT,KAAA6iB,YAAAA,EACA7iB,KAAA8iB,mBAAAA,EA5BF9iB,KAAA+iB,aAA+B,IAAIC,IAAAA,UAAU,CAAEnc,MAAO,EAAGoc,MAAO,KAGhEjjB,KAAAkI,OAAgB,GAChBlI,KAAAkjB,QAAU,EAMXljB,KAAAqI,QAAU,IAAIuL,KAAAA,cACd5T,KAAAmjB,WAAa,IAAIvP,KAAAA,cACjB5T,KAAAojB,SAAW,IAAIxP,KAAAA,cACf5T,KAAAqjB,cAAgB,IAAIC,KAAAA,gBAAqB,IACzCtjB,KAAAujB,OAAS,IAAI3P,KAAAA,cACb5T,KAAAwjB,OAAS,IAAI5P,KAAAA,cACb5T,KAAAyjB,eAAiB,IAAI7P,KAAAA,cACrB5T,KAAA0jB,kBAAoB,IAAI9P,KAAAA,cACxB5T,KAAA2jB,iBAAmB,IAAI/P,KAAAA,cACvB5T,KAAA4jB,mBAAqB,IAAIhQ,KAAAA,cACzB5T,KAAA6jB,aAAoB,GAEpB7jB,KAAAmI,KAAO,GAQZnI,KAAK8U,cAAgB9U,KAAKwT,SAASuB,IAAIC,uBACvChV,KAAK8jB,mBAAqB9jB,KAAK8U,cAAcG,kBAC7CjV,KAAK+jB,OAAY/jB,KAAK8jB,mBAAkB,aAqR5C,OAlREnB,EAAAziB,UAAA8jB,kBAAA,SAAkBC,GAChBjkB,KAAKkkB,eAAiBD,GAGxBtB,EAAAziB,UAAAikB,aAAA,SAAajc,GACXlI,KAAKkI,OAASA,EACdlI,KAAKqI,QAAQrF,KAAKhD,KAAKkI,SAGzBya,EAAAziB,UAAAkkB,kBAAA,eACQC,EAAWrkB,KAAKskB,cAChBC,EAAW,IAAIxN,SACrBwN,EAASvN,OAAO,YAAaqN,EAAUA,EAAe,UAChDjN,EAAU,IAAIF,KAAAA,YAAY,OAAQlX,KAAK8jB,mBAAqB,cAAeS,GACjF,OAAOvkB,KAAK4iB,WAAWxL,QAAQA,GAC5Bd,YACAlT,KAAI,SAACohB,GACJ,GAAIA,GAAYA,EAAe,KAC7B,OAAOA,EAAe,KAEtB3T,QAAQ7L,MAAM,uCAKtB2d,EAAAziB,UAAAukB,gBAAA,eACQJ,EAAWrkB,KAAK0kB,YAChBH,EAAW,IAAIxN,SACrBwN,EAASvN,OAAO,UAAWqN,EAAUA,EAAe,UAC9CjN,EAAU,IAAIF,KAAAA,YAAY,OAAQlX,KAAK8jB,mBAAqB,YAAaS,GAC/E,OAAOvkB,KAAK4iB,WAAWxL,QAAQA,GAC5Bd,YACAlT,KAAI,SAACohB,GACJ,GAAIA,GAAYA,EAAe,KAC7B,OAAOA,EAAe,KAEtB3T,QAAQ7L,MAAM,+BAKtB2d,EAAAziB,UAAAykB,UAAA,SAAUC,GACR5kB,KAAKojB,SAASpgB,KAAK4hB,IAGrBjC,EAAAziB,UAAA2kB,SAAA,SAAS1X,GACPnN,KAAK8kB,YAAc3X,EACnBnN,KAAK4jB,mBAAmB5gB,KAAKmK,IAG/BwV,EAAAziB,UAAA6kB,aAAA,SAAa5X,GACXnN,KAAKglB,UAAY7X,EACjBnN,KAAK2jB,iBAAiB3gB,KAAKmK,IAG7BwV,EAAAziB,UAAA+kB,WAAA,SAAWld,GACT/H,KAAKklB,QAAUnd,EACf/H,KAAKyjB,eAAezgB,KAAKhD,KAAKklB,UAGhCvC,EAAAziB,UAAAilB,WAAA,WACE,OAAOnlB,KAAKklB,SAGdvC,EAAAziB,UAAAklB,cAAA,SAAcrd,GACZ/H,KAAKqlB,WAAatd,EAClB/H,KAAK0jB,kBAAkB1gB,KAAKhD,KAAKqlB,aAGnC1C,EAAAziB,UAAAolB,cAAA,WACE,OAAOtlB,KAAKqlB,YAGd1C,EAAAziB,UAAAqlB,kBAAA,SAAkBC,EAAY5M,EAAWkM,GAAzC,IAAArR,EAAAzT,KACE,OAAO,IAAI0C,QAAO,SAAaC,EAASC,GAAM,OAAAP,UAAAoR,OAAA,OAAA,EAAA,4EAC1B,MAAA,CAAA,EAAMzT,KAAKylB,6BAAvBC,EAAY/H,EAAA/Z,OAClB5D,KAAK4iB,WACF7I,IAAI/Z,KAAK+jB,OAAS,IAAIyB,EAAU,WAAW5M,EAAS,cAAckM,EACjE,CACEa,WAAYD,IAEdpP,YAAYlT,KAAI,SAACsS,GACjB,OAAO/S,EAAQ+S,iBAKvBiN,EAAAziB,UAAA0lB,gBAAA,SAAgBJ,EAAY5M,EAAWoM,GAAvC,IAAAvR,EAAAzT,KACE,OAAO,IAAI0C,QAAO,SAAaC,EAASC,GAAM,OAAAP,UAAAoR,OAAA,OAAA,EAAA,4EAC1B,MAAA,CAAA,EAAMzT,KAAKylB,6BAAvBC,EAAY/H,EAAA/Z,OAClB5D,KAAK4iB,WACF7I,IAAI/Z,KAAK+jB,OAAS,IAAIyB,EAAU,WAAW5M,EAAS,YAAYoM,EAC/D,CACEW,WAAYD,IAEdpP,YAAYlT,KAAI,SAACsS,GACjB,OAAO/S,EAAQ+S,iBAMvBiN,EAAAziB,UAAA2lB,oBAAA,SAAoBL,EAAYM,GAC9B,GAAI9lB,KAAK+iB,cAAgB/iB,KAAK+iB,aAAara,KAAM,KACzCxF,EAASlD,KAAK+lB,sBAAsBD,GAC1C9lB,KAAKgmB,iBAAiBR,EAAYtiB,KAItCyf,EAAAziB,UAAA6lB,sBAAA,SAAsBE,GACpB,GAAIjmB,KAAK+iB,cAAgB/iB,KAAK+iB,aAAara,KAAM,KACzCxF,EAAS,CACbJ,MAAO,IAKT,OAH4B,kBAAxB,IACFI,EAAiB,SAAI+iB,GAEfjmB,KAAK+iB,aAAara,KAAKC,eAC7B,IAAK,UACL,IAAK,WACL,IAAK,OACHzF,EAAOJ,MAAQ9C,KAAK+iB,aAAajgB,MAKrC,OAAOI,EAET,OAAO,MAGTyf,EAAAziB,UAAA8lB,iBAAA,SAAiBR,EAAYtiB,GAA7B,IAAAuQ,EAAAzT,KACE,OAAO,IAAI0C,QAAO,SAAOC,EAASC,GAChC6Q,EAAKmP,WACF7I,IAAItG,EAAKsQ,OAAS,IAAIyB,EAAU,WAAW/R,EAAKsP,aAAaE,MAC5D/f,GACAoT,YAAYlT,KAAI,SAACsS,GACjB,OAAO/S,EAAQ+S,QAKvBiN,EAAAziB,UAAAgmB,mBAAA,SAAmBV,EAAYliB,EAAMsV,EAAWkN,GAAhD,IAAArS,EAAAzT,KAIE,MAH4B,kBAAxB,IACFsD,EAAe,SAAIwiB,GAEd,IAAIpjB,QAAO,SAAOC,EAASC,GAChC6Q,EAAKmP,WACF7I,IAAItG,EAAKsQ,OAAS,IAAIyB,EAAU,WAAW5M,EAC1CtV,GACAgT,YAAYlT,KAAI,SAACsS,GACjB,OAAO/S,EAAQ+S,QAKjBiN,EAAAziB,UAAAimB,qBAAN,SAA2BX,EAAYY,4HACjCpmB,KAAK+iB,cAAgB/iB,KAAK+iB,aAAara,KAEvB,aADZ2d,EAAYrmB,KAAK+iB,aAAara,KAAKC,gBACI,SAAd0d,GAAsC,aAAdA,EAAnD,CAAA,EAAA,GACF,CAAA,GAAO,GAHP,CAAA,EAAA,UAK2B,MAAA,CAAA,EAAMrmB,KAAK6lB,oBAAoBL,EAAYY,WACtE,GADME,EAAqB3I,EAAA/Z,OAEzB,MAAA,CAAA,EAAO0iB,EAAcnf,2BAI3B,MAAA,CAAA,GAAO,SAGDwb,EAAAziB,UAAAulB,YAAR,WAGE,OAAOzlB,KAAK4iB,WACT2D,MAHY,qCACE,2BAGdjQ,YACAlT,KAAI,SAAEsS,GACL,OAAOA,EAAQ,KACd8Q,MAAK,SAAEtQ,GAER,OADArF,QAAQ7L,MAAM,mBAAoBkR,GAC3B,oBAIbyM,EAAAziB,UAAAumB,mBAAA,SACExD,EACA/f,EACAwjB,EACA3d,EACAoE,EACAvG,EACAC,EACA6B,GAEA1I,KAAK+iB,aAAaE,MAAQA,EAC1BjjB,KAAK+iB,aAAajgB,MAAQI,EAC1BlD,KAAK+iB,aAAaha,QAAUA,EAC5B/I,KAAK+iB,aAAa5V,GAAKA,EACvBnN,KAAK+iB,aAAa2D,MAAQA,EAC1B1mB,KAAK+iB,aAAanc,SAAWA,EAC7B5G,KAAK+iB,aAAalc,MAAQA,EAC1B7G,KAAK+iB,aAAara,KAAOA,GAG3Bia,EAAAziB,UAAAymB,iBAAA,SAAiBze,GACflI,KAAK4mB,cAAgB1e,GAGvB1I,OAAAqC,eAAI8gB,EAAAziB,UAAA,YAAS,KAAb,WACE,OAAOF,KAAK+iB,8CAGdJ,EAAAziB,UAAA2mB,cAAA,SAAc9d,EAASoE,GACrB,OAAOnN,KAAK4mB,cAAc7d,GAASoE,GAAW,OAGhDwV,EAAAziB,UAAA4mB,SAAA,SAAS3Z,GACPnN,KAAKujB,OAAOvgB,KAAKmK,IAGnBwV,EAAAziB,UAAA6mB,SAAA,SAAS3e,GACPpI,KAAKgnB,MAAQ5e,EACbpI,KAAKwjB,OAAOxgB,KAAKoF,IAGnBua,EAAAziB,UAAA+mB,gBAAA,SAAgBC,GACd,GAAIA,EAAM,KACFC,EAAOnX,cAAckX,GAE3B,OADYpP,IAAIC,gBAAgBoP,GAGlC,OAAO,MAGTxE,EAAAziB,UAAAknB,iBAAA,SAAiBF,OACTC,EAAOnX,cAAckX,GACrBnf,EAAM+P,IAAIC,gBAAgBoP,GAChCnnB,KAAKskB,cAAgB6C,EACrBnnB,KAAKilB,WAAWld,IAGlB4a,EAAAziB,UAAAmnB,eAAA,SAAeH,OACPC,EAAOnX,cAAckX,GACrBnf,EAAM+P,IAAIC,gBAAgBoP,GAChCnnB,KAAK0kB,YAAcyC,EACnBnnB,KAAKolB,cAAcrd,IAGrB4a,EAAAziB,UAAAonB,aAAA,SAAarE,EAAO/f,GAClBlD,KAAK+iB,aAAoB,MAAI,SAC7B/iB,KAAK6jB,aAAaZ,GAAS/f,EAC3BlD,KAAKqjB,cAAcrgB,KAAKhD,KAAK6jB,eAG/BlB,EAAAziB,UAAAqnB,gBAAA,SAAgBtE,EAAO/f,GACrBlD,KAAK+iB,aAAoB,MAAI,YAC7B/iB,KAAK6jB,aAAaZ,GAAS/f,EAC3BlD,KAAKqjB,cAAcrgB,KAAKhD,KAAK6jB,eAG/BlB,EAAAziB,UAAAsnB,eAAA,SAAera,GACbnN,KAAK8kB,YAAc3X,EACnBnN,KAAK4jB,mBAAmB5gB,KAAKmK,IAG/BwV,EAAAziB,UAAAunB,aAAA,SAAaC,GACX1nB,KAAKmjB,WAAWngB,KAAK0kB,IAGvB/E,EAAAziB,UAAAynB,SAAA,SAASrnB,GACPN,KAAKkjB,OAAS5iB,uBA1TjBqR,KAAAA,sDARQiN,KAAAA,kBADYK,KAAAA,gBAEZ2I,IAAAA,wBACAC,OAAAA,uBAmUTlF,KCtUA,IAAAmF,oBAAA,WAsBE,SAAAA,EACUC,GADV,IAAAtU,EAAAzT,KACUA,KAAA+nB,iBAAAA,EAhBH/nB,KAAAgoB,iBAAmB,IAAIpU,KAAAA,cACvB5T,KAAAioB,sBAAwB,IAAIrU,KAAAA,cAC5B5T,KAAAkoB,iBAAmB,IAAItU,KAAAA,cACvB5T,KAAAmoB,cAAgB,IAAIvU,KAAAA,cACpB5T,KAAAooB,eAAiB,IAAIxU,KAAAA,cACrB5T,KAAAqoB,kBAAoB,IAAIzU,KAAAA,cACxB5T,KAAAsoB,gBAAkB,IAAI1U,KAAAA,cACtB5T,KAAAuoB,cAAgB,IAAI3U,KAAAA,cAAuB,EAAG,KAC9C5T,KAAAwoB,mBAAqB,IAAI5U,KAAAA,cACzB5T,KAAAyoB,oBAAsB,IAAI7U,KAAAA,cAC1B5T,KAAA0oB,2BAA6B,IAAI9U,KAAAA,cAQtC5T,KAAK+nB,iBAAiBvE,OAAOtO,UAAS,SAAC9M,GACrCqL,EAAKuT,MAAQ5e,IAgCnB,OA5BE0f,EAAA5nB,UAAAyoB,QAAA,SAAQxgB,GACNnI,KAAKmI,KAAOA,EACZnI,KAAKsoB,gBAAgBtlB,KAAKhD,KAAKmI,OAGjC2f,EAAA5nB,UAAA0oB,oBAAA,SAAoBb,GAClB/nB,KAAK+nB,iBAAmBA,GAG1BD,EAAA5nB,UAAA2oB,oBAAA,SAAoB/lB,GAClB9C,KAAK0oB,2BAA2B1lB,KAAKF,IAGvCglB,EAAA5nB,UAAA4oB,oBAAA,SAAoBhmB,GAClB9C,KAAKyoB,oBAAoBzlB,KAAKF,IAGhCglB,EAAA5nB,UAAA6oB,oBAAA,SAAoBrgB,GAClB,MAAgB,YAATA,GAA+B,SAATA,GAA4B,aAATA,GAGlDof,EAAA5nB,UAAA8oB,4BAAA,SAA4BxgB,GAC1B,MAAkB,gBAAdxI,KAAKmI,KACAnI,KAAK+oB,oBAAoBvgB,EAAMzB,aAE/ByB,EAAMpB,gBAAkBpH,KAAKgnB,2BAlDzCrV,KAAAA,sDAFQgR,oBAuDTmF,EA1DA,eCSEmB,QAAU,UACVC,MAAQ,QACRC,OAAS,SACTC,aAAe,eACfC,KAAO,OACPC,UAAY,YACZC,QAAU,UACVC,UAAY,aAEdC,YAAA,WAKE,SAAAA,EACUC,EACAlW,EACAmW,EACAC,EACAC,EACA1W,EACA2P,EACAgH,EACqB9Y,EACH4B,GATlB5S,KAAA0pB,aAAAA,EACA1pB,KAAAwT,SAAAA,EACAxT,KAAA2pB,KAAAA,EACA3pB,KAAA4pB,gBAAAA,EACA5pB,KAAA6pB,eAAAA,EACA7pB,KAAAmT,OAAAA,EACAnT,KAAA8iB,mBAAAA,EACA9iB,KAAA8pB,YAAAA,EACqB9pB,KAAAgR,SAAAA,EACHhR,KAAA4S,SAAAA,EAbpB5S,KAAA+pB,sBAAuB,EACvB/pB,KAAAgqB,WAAY,EAclBhqB,KAAK8U,cAAgB9U,KAAKwT,SAASuB,IAAIC,uBAsS3C,OAnSEyU,EAAAvpB,UAAA+pB,KAAA,WAAA,IAAAxW,EAAAzT,KACEA,KAAKkqB,oBACLtM,WAAU,WACRnK,EAAK0W,6BACJ,KACHnqB,KAAKmT,OAAOiX,OAAO5U,KACjBwH,UAAAA,OAAM,SAACqN,GAAS,OAAAA,aAAiBC,OAAAA,gBACjC7U,UAAAA,IAAG,WAAO,OAAAhC,EAAKoW,iBACfpU,UAAAA,IAAG,SAAC8U,GAEF,QADIC,EAAcD,EACXC,EAAYC,YACjBD,EAAcA,EAAYC,WAE5B,OAAOD,IAETE,UAAAA,UAAS,SAACH,GAAS,OAAAA,EAAMrD,OACzBzR,UAAAA,IAAG,SAAEyR,GAEH,OADAzT,EAAKuW,UAAY9C,EAAK8C,UACf9C,EAAKtM,SAEd1F,UAAS,SAAE0F,GACPnH,EAAKuW,UACPvW,EAAKuW,WAAY,EAEjBvW,EAAKkX,kBAAkB/P,MAK7B6O,EAAAvpB,UAAAyqB,kBAAA,SAAkB/P,EAAegQ,OAC3BC,EAAW,UACX1Z,OAAAA,kBAAkBnR,KAAKgR,UACrBhR,KAAK4S,SAASkY,OAAOC,SAAS/qB,KAAK8U,cAAckW,qBACnDH,EAAWjQ,GAAgB,UAC3B1M,OAAkB,UAAEuK,KAAKmS,GAAYC,IAGvCA,EAAW,WAAajQ,EAAQ,MAAMA,EAAU,IAElD5a,KAAK0pB,aAAauB,SAASJ,IAG7BpB,EAAAvpB,UAAAgrB,gBAAA,SAAgBC,EAAUC,GAClBA,EACEprB,KAAKqrB,mBAAmBF,GAC5BnrB,KAAK2pB,KAAK2B,UACR,CAAEH,SAAQA,EAAEC,QAAOA,GACnB,aAAaD,EAAQ,KAGvBnrB,KAAK2pB,KAAK4B,OACR,CAAEJ,SAAQA,EAAEC,QAAOA,IACnB,GAIEprB,KAAKqrB,mBAAmBF,IAC5BnrB,KAAK2pB,KAAK6B,UAAU,aAAaL,EAAQ,MAK/C1B,EAAAvpB,UAAAurB,YAAA,SAAYN,EAAUC,GACdA,EACEprB,KAAKqrB,mBAAmBF,GAC5BnrB,KAAK2pB,KAAK2B,UACR,CAAEH,SAAQA,EAAEC,QAAOA,GACnB,SAASD,EAAQ,KAGnBnrB,KAAK2pB,KAAK4B,OACR,CAAEJ,SAAQA,EAAEC,QAAOA,IACnB,GAIEprB,KAAKqrB,mBAAmBF,IAC5BnrB,KAAK2pB,KAAK6B,UAAU,SAASL,EAAQ,MAK3C1B,EAAAvpB,UAAAwrB,iBAAA,SAAiBhjB,EAAckS,EAAe+Q,EAAqBjgB,EAAe3D,GAC1EW,GACJ1I,KAAKkrB,gBAAgB,UAAWxiB,GAE5BkS,GACJ5a,KAAKkrB,gBAAgB,WAAYtQ,GAE7B+Q,GACJ3rB,KAAKkrB,gBAAgB,iBAAkBS,GAEnCjgB,GACJ1L,KAAKkrB,gBAAgB,WAAYxf,GAE7B3D,GACJ/H,KAAKkrB,gBAAgB,SAAUnjB,GAE3B/H,KAAKqrB,mBAAmB,iBAG5BrrB,KAAK2pB,KAAK4B,OACR,CAAEJ,SAAU,eAAgBC,QAAS,aAI3C3B,EAAAvpB,UAAA0rB,aAAA,eAAa,IAAAC,EAAA,GAAAC,EAAA,EAAAA,EAAAprB,UAAAC,OAAAmrB,IAAAD,EAAAC,GAAAprB,UAAAorB,GAEX,QADIC,EAAa,GACRziB,EAAI,EAAGA,EAAIuiB,EAAalrB,OAAQ2I,IACnCuiB,EAAaviB,KACXA,IAAMuiB,EAAalrB,OAAS,EAC9BorB,GAAcF,EAAaviB,GAE3ByiB,GAAcF,EAAaviB,GAAK,UAIhC0iB,EAAmBD,EACzB/rB,KAAKyrB,YAAY,SAAUO,IAE7BvC,EAAAvpB,UAAA+rB,gBAAA,SAAgBC,GACTA,EAAIC,OACPD,EAAU,KAAIlsB,KAAK4S,SAAS7K,KAE9B/H,KAAKurB,OAAOW,IAEdzC,EAAAvpB,UAAAksB,mBAAA,SAAmBhB,GACXprB,KAAKqsB,WAAW,eAChBjB,EACFprB,KAAK2pB,KAAK2B,UACR,CAAEtjB,KAAM,cAAeojB,QAASA,GAChC,sBAGFprB,KAAK2pB,KAAK6B,UAAU,sBAGlBJ,GACFprB,KAAK2pB,KAAK4B,OACR,CAAEvjB,KAAM,cAAeojB,QAASA,IAChC,IAMR3B,EAAAvpB,UAAAmsB,WAAA,SAAWrkB,GACT,OAAOhI,KAAK2pB,KAAK2C,OAAO,SAAStkB,EAAI,MAGvCyhB,EAAAvpB,UAAAmrB,mBAAA,SAAmBF,GACjB,OAAOnrB,KAAK2pB,KAAK2C,OAAO,aAAanB,EAAQ,MAGvC1B,EAAAvpB,UAAAgqB,kBAAR,WAAA,IAAAzW,EAAAzT,KACE,GAAImR,OAAAA,kBAAkBnR,KAAKgR,UAAW,KAC9Bub,EAAYre,OAAkB,UACpC,GAAI0E,SAASkY,OAAOC,SAAS/qB,KAAK8U,cAAckW,uBACxCwB,EAAsBxsB,KAAK8iB,mBAAmB2J,sBAAsBvX,UAAS,SAACwX,GAElF,GADAF,EAAoBG,eACflZ,EAAKsW,qBAAsB,CAC9BtW,EAAKsW,sBAAuB,EAC5BwC,EAAUK,YACJC,EAAUpZ,EAAKqW,YAAYgD,aACjCP,EAAUQ,SAASL,EAAeM,IAAK,CACrCC,OAAQP,EAAeM,IACvB7P,MAAOuP,EAAevP,MACtBnV,KAAM0kB,EAAe1kB,KACrBklB,cAAezZ,EAAK0Z,SAAS,UAC7BC,oBAAqB3Z,EAAK0Z,SAAS,gBACnCE,qBAAsB5Z,EAAKqW,YAAYwD,eACvCC,kBAAmBV,EAAQW,aAAaxlB,KACxCylB,QAAS,CACPtgB,GAAI0f,EAAQa,gBACZ1lB,KAAM6kB,EAAQW,aAAaxlB,OAE5B,CACD2lB,SAAU,CAAEC,qBAAqB,UAQ7CnE,EAAAvpB,UAAA2tB,UAAA,WACE,OAAOC,QAGDrE,EAAAvpB,UAAAitB,SAAR,SAAiBY,OACXC,EAAc,YAClB,OAAQD,GACN,IAAK,SACHC,EAAc,MACd,MACF,IAAK,eACHA,EAAc,UAGZC,EAAOjuB,KAAK8pB,YAAYoE,WAAWC,KAAI,SAAEvuB,GAC7C,OAAOA,EAAEmrB,SAASiD,KAEhBb,EAAW,OAQf,OAPIc,IAEAd,EADkB,QAAhBa,EACSC,EAAKlD,SAAS,OAAS,MAAQ,YAE/BkD,EAAKlD,SAAS,WAAa,UAAY,YAG/CoC,GAET1D,EAAAvpB,UAAAqrB,OAAA,SAAOW,EAAqBkC,OAEpBC,EAAWruB,KAAK4pB,gBAAgB0E,eAAetuB,KAAK4S,SAAU,CAClEzF,GAAI,KACJohB,cAAeC,KAAAA,kBAAkBnF,KACjCoF,OAAQ,GACRvH,KAAM,KAEFwH,EAAOL,EAASM,cAAc,QAC9BC,EAAO5uB,KAAK4S,SAASgc,KACrBC,EAAW7uB,KAAK8uB,eAAe5C,GAErC1sB,OAAOuvB,KAAK7C,GAAKrQ,QAAO,SAAEmT,GACxB,OAAOX,EAASY,aAAaP,EAAMM,EAAM9C,EAAI8C,MAE/C,IAGE,GAAa,OAATJ,EACF,MAAM,IAAIM,MAAM,yCAIZC,EAAed,EAASe,kBAAkBP,GAC1CM,GACJd,EAASgB,gBAAgBF,EAAc,QACvCd,EAASY,aAAaE,EAAc,OAAQjD,EAAU,OAEtDmC,EAASiB,YAAYV,EAAMF,GAG7B,MAAO3tB,GAEPstB,EAASiB,YAAYV,EAAMF,KAIvBjF,EAAAvpB,UAAA4uB,eAAR,SAAuB5C,OACfqD,EAAerD,EAAIsD,IAAM,MAAQ,WACvC,MAAO,QAAQD,EAAI,KAAKrD,EAAIqD,GAAK,MAG3B9F,EAAAvpB,UAAAiqB,0BAAR,WACMhZ,OAAAA,kBAAkBnR,KAAKgR,YACrB9C,OAAiB,WACnBA,OAAiB,SAAE,SAAQ,WACzBA,OAAuB,gBAAI,IAG7BA,OAAiB,SAAE,SAAQ,WACzBA,OAAuB,gBAAI,KAI/BA,OAAsB,cAAC,WACjBA,OAAiB,SACfA,OAAuB,iBAAkC,IAA7BA,OAAuB,eACrDA,OAAiB,SAAE,QAEnBA,OAAiB,SAAE,QAGrB2C,QAAQ7L,MAAM,4BAIlBkJ,OAAoB,YAAC,WACfA,OAAc,MACZA,OAAc,MAAEuhB,eAClBvhB,OAAc,MAAEwhB,QAEhBxhB,OAAc,MAAEoD,OAGlBT,QAAQ7L,MAAM,qEAlUf2qB,gBAAAA,aAF0D1Q,KAAAA,gBAEnD2Q,gBAAAA,YAFcC,KAAAA,wBAIrBC,OAAAA,sBAAgBjR,OAAAA,cAChBgJ,OAAAA,2BAAqBkI,OAAAA,0DA2BzBle,KAAAA,OAAMC,KAAA,CAACC,KAAAA,+CACPF,KAAAA,OAAMC,KAAA,CAACke,OAAAA,eAwSZvG,EAvTA,GClBA,IAAAwG,aAAA,WAMA,SAAAA,IAEUjwB,KAAAkwB,OAA8B,GAE9BlwB,KAAAmwB,QAAkC,IAAI9b,KAAAA,QAuBhD,OArBE4b,EAAA/vB,UAAAkwB,IAAA,SAAIC,GACFrwB,KAAKkwB,OAAO1rB,KAAK6rB,IAGnBJ,EAAA/vB,UAAAoR,KAAA,SAAKnE,GACWghB,OAAAA,KAAKnuB,KAAKkwB,OAAQ,CAAE/iB,GAAIA,KAGxC8iB,EAAA/vB,UAAAwvB,MAAA,SAAMviB,GACUghB,OAAAA,KAAKnuB,KAAKkwB,OAAQ,CAAE/iB,GAAIA,IAChCuiB,SAGRO,EAAA/vB,UAAAowB,iBAAA,SAAiBC,GACfvwB,KAAKuwB,cAAgBA,EACrBvwB,KAAKmwB,QAAQntB,KAAKutB,IAGpBN,EAAA/vB,UAAAswB,iBAAA,WACE,OAAOxwB,KAAKmwB,QAAQM,oCAzBvB9e,KAAAA,aA2BDse,EAjCA,GCAA,IAAAS,gBAAA,WAsBE,SAAAA,EACUvd,EACAK,EACAmd,GAFA3wB,KAAAmT,OAAAA,EACAnT,KAAAwT,SAAAA,EACAxT,KAAA2wB,oBAAAA,EAbH3wB,KAAAgF,MAAa,KACbhF,KAAA4wB,eAAsB,KACtB5wB,KAAA6wB,WAAqB,KACrB7wB,KAAA8wB,YAAsB,KACtB9wB,KAAA+wB,cAAwB,KAW7B/wB,KAAK8U,cAAgB9U,KAAKwT,SAASuB,IAAIC,uBACvChV,KAAKgxB,WAAahxB,KAAK8U,cAAcmc,qBACrCjxB,KAAKkxB,SAAWlxB,KAAK8U,cAAcqc,mBAiDvC,OA9CET,EAAAxwB,UAAAkxB,SAAA,WACEpxB,KAAK4wB,eAAiB5wB,KAAK2wB,oBAAoB7D,aAC3C9sB,KAAKgF,OAAShF,KAAKgF,MAAMnF,eAAe,WAC1CG,KAAK6wB,WAAa7wB,KAAKgF,MAAMA,MAAMqsB,MAAQ,KACvCrxB,KAAK6wB,YACP7wB,KAAKsxB,uBAKXZ,EAAAxwB,UAAAoxB,mBAAA,WACE,OAAQtxB,KAAK6wB,YACX,IAAK,WACH7wB,KAAK8wB,YAAc,+BACnB9wB,KAAK+wB,cAAgB,cAAgB/wB,KAAK4wB,eAAiB,oBAAsB,6BACjF,MACF,IAAK,UACH5wB,KAAK8wB,YAAc,kCACnB9wB,KAAK+wB,eAAiB/wB,KAAK4wB,eAAiB,+CAAiD,gCAAkC,wDAC/H,MACF,IAAK,WACH5wB,KAAK8wB,YAAc,+BACnB9wB,KAAK+wB,cAAgB,cAAgB/wB,KAAK4wB,eAAiB,oBAAsB,6BACjF,MACF,QACE5wB,KAAK8wB,YAAc,gCACnB9wB,KAAK+wB,cAAgB,OAK3BL,EAAAxwB,UAAAqxB,cAAA,WACEvxB,KAAKmT,OAAO4K,SAAS,CAAC,gBAGxB2S,EAAAxwB,UAAAsxB,OAAA,WACMtjB,SACFA,OAAOujB,SAAStF,KAAUnsB,KAAKgxB,WAAU,wBAAuBhxB,KAAKkxB,SAAWlxB,KAAKmT,OAAOpL,OAIhG2oB,EAAAxwB,UAAAwxB,OAAA,WACMxjB,SACFA,OAAOujB,SAAStF,KAAUnsB,KAAKgxB,WAAU,yBAAwBhxB,KAAKkxB,SAAWlxB,KAAKmT,OAAOpL,2BArElG4pB,KAAAA,UAAS7f,KAAA,CAAC,CACT+c,SAAU,qBACV1Z,SAAA,4hCANO0J,OAAAA,cAFmBI,KAAAA,gBACnB8Q,OAAAA,6BA6ETW,EA9EA,GCAA,IAAAkB,YAAA,WAeE,SAAAA,EACUze,EACA0e,GADA7xB,KAAAmT,OAAAA,EACAnT,KAAA6xB,OAAAA,EAPH7xB,KAAA8xB,YAAsB,KACtB9xB,KAAA0I,KAAe,KACf1I,KAAA+xB,YAAsB,KACtB/xB,KAAAgyB,cAAwB,KAsCjC,OA/BEJ,EAAA1xB,UAAAkxB,SAAA,WACE,OAAQpxB,KAAK0I,MACX,IAAK,OACH1I,KAAK+xB,YAAc,qCACnB/xB,KAAKgyB,cAAgB,wNACrB,MACF,IAAK,YACHhyB,KAAK+xB,YAAc,iCACnB/xB,KAAKgyB,cAAgB,oGACrB,MACF,IAAK,MACHhyB,KAAK+xB,YAAc,iCACnB/xB,KAAKgyB,cAAgB,mFACrB,MACF,QACEhyB,KAAK6xB,OAAOnC,UAKlBkC,EAAA1xB,UAAA+xB,YAAA,WACM/jB,QAAYlO,KAAK8xB,aAAiB9xB,KAAK0I,KACzCwF,OAAOujB,SAAStF,KAAQnsB,KAAgB,YAExCA,KAAK6xB,OAAOnC,SAIhBkC,EAAA1xB,UAAAwvB,MAAA,WACE1vB,KAAK6xB,OAAOnC,6BA7CfiC,KAAAA,UAAS7f,KAAA,CAAC,CACT+c,SAAU,eACV1Z,SAAA,iwBALO0J,OAAAA,cACAqT,OAAAA,gBAiDTN,EAnDA,GCAAjgB,KAAAA,aAOA,IAAAwgB,mBAAA,WACE,SAAAA,EACUN,GAAA7xB,KAAA6xB,OAAAA,EA+BZ,OA1BEM,EAAAjyB,UAAAkyB,qBAAA,SAAqBlc,GACClW,KAAK6xB,OAAOvgB,KAAKof,gBAAiB,CACpD2B,WAAY,eACZC,cAAc,IAEJC,kBAAkBvtB,MAAQkR,GAGxCic,EAAAjyB,UAAAsyB,eAAA,SAAe9pB,EAAc+pB,EAAsBC,EAAuBC,OAClEC,EAAkB5yB,KAAK6xB,OAAOvgB,KAAKsgB,YAAa,CACpDS,WAAY,eACZC,cAAc,IAEZ5pB,IACFkqB,EAAgBL,kBAAkB7pB,KAAOA,GAEvC+pB,IACFG,EAAgBL,kBAAkB7pB,KAAO+pB,GAEvCC,IACFE,EAAgBL,kBAAkBR,YAAcW,GAE9CC,IACFC,EAAgBL,kBAAkBP,cAAgBW,IAGxDR,EAjCA,GCPA,IAAAU,aAAA,WAmBE,SAAAA,EACUrf,EACAsf,EACAjB,EACqB7gB,GAHrBhR,KAAAwT,SAAAA,EACAxT,KAAA8yB,aAAAA,EACA9yB,KAAA6xB,OAAAA,EACqB7xB,KAAAgR,SAAAA,EANvBhR,KAAA+yB,aAAe,KAQrB/yB,KAAK8U,cAAgB9U,KAAKwT,SAASuB,IAAIC,uBACvChV,KAAKgzB,OAAShzB,KAAK8U,cAAcme,MACjCjzB,KAAKkzB,uBAAyBlzB,KAAK8U,cAAcqe,sBAuErD,OApEEN,EAAA3yB,UAAAkzB,kBAAA,SAAkB1qB,EAAc2qB,EAA0BC,OAClDC,EAAUvzB,KAAK8yB,aAAaU,aAC5BvG,EAASjtB,KAAKyzB,cAAcF,GAAc,IAAExjB,MAAM,GAIxD,OAFA/P,KAAK+yB,aAAkB/yB,KAAKkzB,uBAAsB,kBAAkBjG,EAAM,WAElEvkB,GACN,IAAK,YACH,GAAI2qB,IAAqBrzB,KAAKgzB,OAAO,YAAcK,IAAqBrzB,KAAKgzB,OAAO,WAClF,OAAO,EAEP,IAAmB,IAAfM,EAAqB,KACjBI,EAAkB1zB,KAAK6xB,OAAOvgB,KAAKsgB,YAAa,CACpDS,WAAY,iBAEdqB,EAAgBnB,kBAAkB7pB,KAAO,YACzCgrB,EAAgBnB,kBAAkBT,YAAc9xB,KAAK+yB,aAEvD,OAAO,EAEX,IAAK,YACL,IAAK,aACL,IAAK,UACH,GAAIM,IAAqBrzB,KAAKgzB,OAAO,WACnC,OAAO,EAEP,IAAmB,IAAfM,EAAqB,KACjBK,EAAY3zB,KAAK6xB,OAAOvgB,KAAKsgB,YAAa,CAC9CS,WAAY,iBAEdsB,EAAUpB,kBAAkB7pB,KAAO,MACnCirB,EAAUpB,kBAAkBT,YAAc9xB,KAAK+yB,aAEjD,OAAO,EAEX,IAAK,0BACGa,EAAa5zB,KAAK6xB,OAAOvgB,KAAKsgB,YAAa,CAC/CS,WAAY,iBAId,OAFAuB,EAAWrB,kBAAkB7pB,KAAO,OACpCkrB,EAAWrB,kBAAkBT,YAAc9xB,KAAK+yB,cACzC,EACT,QACE,OAAO,IAIbF,EAAA3yB,UAAAuzB,cAAA,SAAcI,GACZ,GAAI1iB,OAAAA,kBAAkBnR,KAAKgR,UAAW,KAE9B8iB,EADYD,EAAY1jB,MAAM,KAAK,GAChB4jB,QAAQ,IAAK,KAAKA,QAAQ,IAAK,KACxD,OAAOrkB,KAAKC,MAAMzB,OAAOmC,KAAKyjB,MAIlCjB,EAAA3yB,UAAA8zB,uBAAA,SAAuBf,GAErB,QADIhF,EAAO,KACF3kB,EAAI,EAAGA,EAAI2pB,EAAMtyB,OAAQ2I,IAC5B2pB,EAAM3pB,KAAOtJ,KAAKgzB,OAAO,WAC3B/E,EAAOgF,EAAM3pB,GACJ2pB,EAAM3pB,KAAOtJ,KAAKgzB,OAAO,YAAwB,OAAT/E,GAA0B,aAATA,EAEzDgF,EAAM3pB,KAAOtJ,KAAKgzB,OAAO,YAAuB,OAAT/E,IAChDA,EAAOgF,EAAM3pB,IAFb2kB,EAAOgF,EAAM3pB,GAKjB,OAAO2kB,uBAxFVtc,KAAAA,sDAR4BsN,KAAAA,gBAKpB4I,OAAAA,2BAHAoM,OAAAA,0CAqBJpiB,KAAAA,OAAMC,KAAA,CAACC,KAAAA,kBA2EZ8gB,EAlGA,GCqBA,SAAAqB,oBAoBA,IAAalf,sBAAwB,IAAImf,KAAAA,eAAiC,oBAE1EC,iBAAA,WAAA,SAAAA,KAmEA,OAtDSA,EAAAC,qBAAP,SAA4B5iB,GAE1B,MAAO,CACL6iB,SAAUF,EACVG,OAAQ,CACNC,OAAAA,aACAC,IAAAA,iBAAiBC,QAAQ,CACvBC,WAAYljB,EAAOkjB,WACnBC,OAAQnjB,EAAOmjB,OACfC,OAAQpjB,EAAOojB,OACfC,SAAUrjB,EAAOqjB,SACjB7f,kBAAmBxD,EAAOwD,kBAC1Bkc,mBAAoB1f,EAAO0f,mBAC3B4D,oBAAqBtjB,EAAOsjB,oBAC5B9D,qBAAsBxf,EAAOwf,qBAC7B+D,qBAAsBvjB,EAAOujB,qBAC7B7B,sBAAuB1hB,EAAO0hB,sBAC9B8B,0BAA2BxjB,EAAOwjB,0BAClChC,MAAOxhB,EAAOwhB,QAElBiC,OAAAA,iBAEAC,UAAW,CACT,CACEC,QAASpgB,sBACTqgB,SAAU5jB,GAEZX,gBACAwkB,eACAtjB,sBACAiB,mBACAiM,eACAmB,kBACAsC,iBACAmF,oBACA2B,YACAwG,aACAkC,mBACAU,cAEF0C,aAAc,CACZ7E,gBACAkB,aAEF4D,gBAAiB,CACf9E,gBACAkB,aAEFjtB,QAAS,CACP+rB,gBACAkB,mCA/DP6D,KAAAA,SAAQ3jB,KAAA,CAAC,CACR4jB,QAAS,CACPlB,OAAAA,cAEFW,UAAW,GACXI,aAAc,CACZ7E,gBACAkB,iBA4DJwC,EAnEA,6BCNE,SAAAkB,EACUpiB,EACAC,EACA2P,EACAtP,GAHAxT,KAAAkT,KAAAA,EACAlT,KAAAmT,OAAAA,EACAnT,KAAA8iB,mBAAAA,EACA9iB,KAAAwT,SAAAA,EA7BHxT,KAAA21B,gBAAkB,IAAI/hB,KAAAA,cACtB5T,KAAA41B,mBAAqB,IAAIhiB,KAAAA,cACzB5T,KAAA61B,sBAAwB,IAAIjiB,KAAAA,cAC5B5T,KAAA81B,sBAAwB,IAAIliB,KAAAA,cAC5B5T,KAAA+1B,uBAAyB,IAAIniB,KAAAA,cAC7B5T,KAAAg2B,gBAAkB,IAAIpiB,KAAAA,cAGrB5T,KAAAi2B,aAAe,GACfj2B,KAAAk2B,YAAc,GACdl2B,KAAAm2B,UAAY,GACZn2B,KAAAo2B,UAAY,GACZp2B,KAAAq2B,SAAW,CACjBruB,KAAMhI,KAAKi2B,aACXK,QAAS,KACTnZ,MAAOnd,KAAKm2B,UACZ9Y,MAAOrd,KAAKo2B,WAONp2B,KAAAu2B,sBAAgC,KAQtCv2B,KAAK8U,cAAgB9U,KAAKwT,SAASuB,IAAIC,uBACvChV,KAAKw2B,YAAcx2B,KAAK8U,cAAckgB,qBACtCh1B,KAAKiV,kBAAoBjV,KAAK8U,cAAcG,kBAC5CjV,KAAK+0B,oBAAsB/0B,KAAK8U,cAAcigB,oBA0MlD,OAvMEO,EAAAp1B,UAAAu2B,eAAA,WAOMz2B,KAAK02B,eAKXpB,EAAAp1B,UAAAw2B,YAAA,WAAA,IAAAjjB,EAAAzT,KACE,OAAOA,KAAKkT,KAAK6B,IAAI/U,KAAKw2B,YAAc,aAAalgB,YAAYlT,KAAI,SAAEsS,OAC/DihB,EAAWjhB,EAAIuD,OAAO1P,OAAAA,UAAUmM,EAAG,SAAE9V,GAAK,MAAwB,aAAxBA,EAAE4tB,aAAaxlB,OAAsB,GACrFyL,EAAKsiB,uBAAuB/yB,KAAK2zB,EAAS,IAC1CljB,EAAKmjB,YAAclhB,EAAIe,KAAI,SAAEnR,EAAG/F,GAC9B,OAAI+F,EAAEkoB,aAAaxlB,KAAOzI,EAAEiuB,aAAaxlB,MAC/B,EAEN1C,EAAEkoB,aAAaxlB,KAAOzI,EAAEiuB,aAAaxlB,KAChC,EAEF,IAETyL,EAAKmjB,YAAYC,QAAQF,EAAS,QAC5BG,EAAevtB,OAAAA,UAAUkK,EAAKmjB,YAAa,CAAEG,SAAS,IACxDtjB,EAAKmjB,YAAYE,GAA0B,YAC7CrjB,EAAKwiB,aAAexiB,EAAKmjB,YAAYE,GAA0B,WAAI,IAAMrjB,EAAKmjB,YAAYE,GAAyB,UACnHrjB,EAAKyiB,YAAcziB,EAAKmjB,YAAYE,GAA0B,WAAEE,OAAO,GACrEvjB,EAAKmjB,YAAYE,GAAyB,UAAEE,OAAO,IAErDvjB,EAAKwiB,aAAe,GAElBxiB,EAAKmjB,YAAYE,GAAqB,MACxCrjB,EAAK2iB,UAAY3iB,EAAKmjB,YAAYE,GAAqB,MAEvDrjB,EAAK2iB,UAAY,GAEf3iB,EAAKmjB,YAAYE,GAAqB,QACxCrjB,EAAK0iB,UAAY1iB,EAAKmjB,YAAYE,GAAqB,OAEzDrjB,EAAK4iB,SAAW,CACdruB,KAAMyL,EAAKwiB,aACXK,QAAS7iB,EAAKyiB,YACd/Y,MAAO1J,EAAK0iB,UACZ9Y,MAAO5J,EAAK2iB,WAEd3iB,EAAKmiB,mBAAmB5yB,KAAKyQ,EAAKmjB,iBAC5BhG,EAAiBnd,EAAKmjB,YAAYE,GAIxC,OAHArjB,EAAKqiB,sBAAsB9yB,KAAK4tB,GAChCnd,EAAK8iB,sBAAwB3F,EAAelD,gBAC5Cja,EAAKkiB,gBAAgB3yB,KAAKyQ,EAAK4iB,UACxB5iB,EAAK4iB,YAIhBf,EAAAp1B,UAAA+2B,qBAAA,SAAqBC,OACbC,EAAgC,GAKtC,OAJAD,EAASrb,QAAO,SAACgR,GACfsK,EAAc3yB,KAAK,IAAI4yB,SAAAA,aAAavK,MAEZ,IAAIwK,SAAAA,kBAAkBF,IAIlD7B,EAAAp1B,UAAAo3B,sBAAA,SAAsBnqB,OACdoqB,EAAchuB,OAAAA,UAAUvJ,KAAK42B,YAAa,CAAElJ,gBAAiB1lB,OAC/DuvB,GAAe,IACjBv3B,KAAK42B,YAAY3d,OAAOse,EAAa,GACrCv3B,KAAK41B,mBAAmB5yB,KAAKhD,KAAK42B,eAItCtB,EAAAp1B,UAAAs3B,eAAA,WACE,OAAOx3B,KAAKkT,KAAK6B,IAAW/U,KAAKw2B,YAAc,cAAclgB,aAG/Dgf,EAAAp1B,UAAAu3B,cAAA,SAAcC,GAAd,IAAAjkB,EAAAzT,KAEE,OADAA,KAAK61B,sBAAsB7yB,MAAK,GACzBhD,KAAKkT,KAAKqC,KAAKvV,KAAKw2B,YAAc,aAAekB,EAAa,UAAW,MAAMphB,YAAYlT,KAAI,SAAQsS,GAAQ,OAAArT,UAAAoR,OAAA,OAAA,EAAA,+CAGpH,OAFAzT,KAAK8iB,mBAAmB6U,UAAUjiB,EAAIkiB,QACtC53B,KAAK61B,sBAAsB7yB,MAAK,GAChC,CAAA,EAAON,QAAQC,QAAQ+S,WAIrB4f,EAAAp1B,UAAA23B,aAAN,SAAmBC,iGACjB,MAAA,CAAA,EAAO,IAAIp1B,QAAO,SAAEC,EAASC,GAC3B6Q,EAAKqP,mBAAmB+U,aAAapkB,EAAKshB,qBAAqB7f,UAAS,SAAC0iB,GAQvE,OAPIA,GAAUA,EAAOj3B,OAAS,GACxBm3B,GAEFrkB,EAAKskB,eAAe,kBAGxBtkB,EAAKgjB,iBACE9zB,cAKb2yB,EAAAp1B,UAAA83B,wBAAA,WAAA,IAAAvkB,EAAAzT,KACEA,KAAKkT,KAAKqC,KAAKvV,KAAK+0B,oBAAsB,2BAA4B,MAAMze,YAAYlT,KAAI,WAC1FqQ,EAAKskB,eAAe,8BAMxBzC,EAAAp1B,UAAA63B,eAAA,SAAexmB,KAiBf+jB,EAAAp1B,UAAA+3B,eAAA,SAAe5B,GAAf,IAAA5iB,EAAAzT,KACMq2B,EAASlZ,QACXnd,KAAKq2B,SAASlZ,MAAQkZ,EAASlZ,OAE7BkZ,EAAS6B,YAAc7B,EAAS8B,YAClCn4B,KAAKq2B,SAASruB,KAAOquB,EAAS6B,WAAa,IAAM7B,EAAS8B,UAC1Dn4B,KAAKq2B,SAASC,QAAUD,EAAS6B,WAAWlB,OAAO,GAAKX,EAAS8B,UAAUnB,OAAO,IAEhFX,EAAShZ,QACXrd,KAAKq2B,SAAShZ,MAAQgZ,EAAShZ,OAAS,IAE1Crd,KAAKkT,KAAK6G,IAAI/Z,KAAKw2B,YAAc,aAAeH,EAASlpB,GAAIkpB,GAAU/f,YAAYlT,KAAI,WACrFqQ,EAAKkiB,gBAAgB3yB,KAAKyQ,EAAK4iB,aAInCf,EAAAp1B,UAAAk4B,cAAA,WACE,OAAOp4B,KAAKkT,KAAK2F,OAAO7Y,KAAKw2B,aAAalgB,aAG5Cgf,EAAAp1B,UAAAm4B,eAAA,SAAelb,EAAOmb,EAAaC,GACjC,OAAOv4B,KAAKkT,KAAK6G,IAAI/Z,KAAKw2B,YAAc,iBAAkB,CACxDrZ,MAAKA,EACLmb,YAAWA,EACXC,YAAWA,IACVjiB,aAGLgf,EAAAp1B,UAAAs4B,gBAAA,SAAgBxwB,GACd,OAAOhI,KAAKkT,KAAK6B,IAAI/U,KAAKw2B,YAAc,gCAAkCxuB,EAAMhI,KAAKy4B,cAClFniB,YACAlT,KAAI,SAACsS,GACJ,OAAOhT,QAAQC,QAAQ+S,MAI7B4f,EAAAp1B,UAAAw4B,mBAAA,SAAmBp1B,GACjB,OAAOtD,KAAKkT,KAAKqC,KAAKvV,KAAKw2B,YAAc,iBAAkBlzB,EAAMtD,KAAKy4B,cACnEniB,YACAlT,KAAI,SAACsS,GACJ,OAAOhT,QAAQC,QAAQ+S,MAIrB4f,EAAAp1B,UAAAu4B,WAAR,eAEQE,EAAY,UADG34B,KAAK8iB,mBAAmB8V,qBAAqB,oBACV,YAUxD,MAAO,CAAEC,QATO,IAAIC,QAAQ,CAC1BC,gBAAiB,WACjBC,OAAU,WACVC,QAAW,gCACXC,oBAAqB,IACrBC,eAAgB,mBAChBC,cAAiBT,EACjBU,OAAU,uBAKP/D,EAAAp1B,UAAAo5B,WAAP,SAAkBnsB,EAAYsP,EAAkB8c,EAAgBC,GAAhE,IAAA/lB,EAAAzT,KACQiX,EAAMjX,KAAKiV,kBAAoB,cAAc9H,EAAE,eAAesP,EAAQ,eAAe8c,EAC3F,OAAOv5B,KAAKkT,KAAK6B,IAASkC,EAAK,CAACwiB,QAAS,aAAavkB,UAAS,SAACQ,GAC9DjC,EAAKqP,mBAAmB4W,iBAAiB,eAAgBhkB,EAAa,QAAEX,IAAI,iBACxEykB,EACF/lB,EAAKN,OAAO4K,SAAS,CAAC,cAAc5Q,EAAE,SAASsP,GAAa,CAAEkd,YAAa,CAAEH,YAAaA,KAE1F/lB,EAAKN,OAAO4K,SAAS,CAAC,cAAc5Q,EAAE,SAASsP,KAElD,SAAEvG,GACDzC,EAAKN,OAAO4K,SAAS,CAAC,cAAc5Q,EAAE,SAASsP,EAAY,CAAEzX,MAAOkR,4BA3OzEvE,KAAAA,sDATQiN,KAAAA,kBACAC,OAAAA,cAEAgJ,OAAAA,2BAJY5I,KAAAA,YAwPrBqW","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export class DynamicField<T> {\n  value: T;\n  key: string;\n  required: boolean;\n  order: number;\n  controlType: string;\n  validator: string;\n  maxLength: number;\n  showCounter: boolean;\n  url: string;\n  name: string;\n  prepared: boolean;\n  recipientRole: string;\n  options: any[];\n  field_name: string;\n  min_checked: number;\n  max_checked: number;\n  temp_sig: string;\n  sig_id: string;\n  temp_int: string;\n  int_id: string;\n  dirty: boolean;\n  full_name: string;\n\n  constructor(field_params: {\n    value?: T,\n    key?: string,\n    result?: string,\n    required?: boolean,\n    order?: number,\n    controlType?: string,\n    validator?: string,\n    maxLength?: number,\n    showCounter?: boolean,\n    url?: string,\n    name?: string,\n    prepared?: boolean,\n    recipientRole?: string,\n    options?: any[],\n    field_name?: string,\n    min_checked?: number,\n    max_checked?: number,\n    temp_sig?: string,\n    sig_id?: string,\n    temp_int?: string,\n    int_id?: string,\n    dirty?: boolean,\n    full_name?: string\n  } = {}) {\n    this.value = field_params.value;\n    this.key = field_params.key || '';\n    this.required = !!field_params.required;\n    this.order = field_params.order === undefined ? 1 : field_params.order;\n    this.controlType = field_params.controlType || '';\n    this.validator = field_params.validator === undefined ? '' : field_params.validator;\n    this.maxLength = field_params.maxLength == null ? null : field_params.maxLength;\n    this.showCounter = field_params.showCounter === false ? false : field_params.showCounter;\n    this.prepared = field_params.prepared;\n    this.recipientRole = field_params.recipientRole;\n    this.options = field_params.options;\n    this.field_name = field_params.field_name;\n    this.min_checked = field_params.min_checked;\n    this.max_checked = field_params.max_checked;\n    this.temp_sig = field_params.temp_sig;\n    this.sig_id = field_params.sig_id;\n    this.temp_int = field_params.temp_int;\n    this.int_id = field_params.int_id;\n    this.dirty = field_params.dirty;\n    this.full_name = field_params.full_name;\n    if (field_params.url) {\n      this.url = field_params.url;\n    }\n    if (field_params.name) {\n      this.name = field_params.name;\n    }\n  }\n}\n","import { DynamicField } from '../models/dynamic-field.model';\nimport { findIndex } from 'lodash';\n\nexport function buildFields(fields, mode) {\n  /*\n     * PDF 72 DPI\n     * Width: 612px\n     * Height: 792px\n     * */\n\n  const _fields = [];\n  let order = 0;\n  let role;\n  switch (mode) {\n    case 'signerview':\n    case 'prepareview':\n    case 'preview':\n      role = 'recipient_role';\n      break;\n    case 'liveview':\n      role = 'role_name';\n      break;\n    default:\n      role = 'recipient_role';\n      break;\n  }\n  let setting = 'setting';\n\n  for (const fieldIndex in fields) {\n    if (fields.hasOwnProperty(fieldIndex) && fields[fieldIndex]) {\n      const field = fields[fieldIndex];\n      let keyNameSuffix = '';\n      if (!!field['settings']) {\n        setting = 'settings'\n      };\n      switch (field.type.toLowerCase()) {\n        case 'attachment':\n        case 'payment':\n          field[setting]['width'] = 24;\n          field[setting]['height'] = 24;\n          break;\n        case 'checkbox':\n        case 'checkbox_group':\n        case 'radio_button_group':\n          field[setting]['width'] = 13.5;\n          field[setting]['height'] = 13.5;\n          keyNameSuffix = field['optionId'] ? '-' + field['optionId'] : '';\n          break;\n        case 'signature':\n          field[setting]['width'] = 82.63636363636;\n          field[setting]['height'] = 36;\n          break;\n        case 'initial':\n          field[setting]['width'] = 82.63636363636;\n          field[setting]['height'] = 36;\n          break;\n        default:\n          break;\n      }\n\n      const fieldValues = new DynamicField({\n        key: field.name + keyNameSuffix,\n        value: field[setting]['result'] || '',\n        required: field.required,\n        controlType: field.type,\n        order: order++,\n        validator: field.validator,\n        showCounter: false,\n        prepared: field.prepared || false,\n        recipientRole: field[role],\n        field_name: field.name,\n        dirty: false\n      });\n\n      switch (field.type) {\n        case 'attachment':\n          fieldValues.value = field[setting]['name'] ? field[setting]['name'] : '';\n          break;\n        case 'checkbox':\n          fieldValues.value = field[setting]['result'] === false ? false : true;\n          break;\n        case 'payment':\n          fieldValues.value = field[setting]['payment_id'] ? field[setting]['payment_id'] : '';\n          break;\n        case 'checkbox_group':\n          fieldValues.value = field[setting]['checked'];\n          if (field.required || field[setting]['maximum_checked'] > 0) {\n            fieldValues['min_checked'] = field[setting]['minimum_checked'];\n            fieldValues['max_checked'] = field[setting]['maximum_checked'];\n          }\n          break;\n        case 'radio_button_group':\n          fieldValues.value = field[setting]['selected'];\n          break;\n        case 'dropdown':\n          fieldValues.value = field[setting]['value'];\n          fieldValues['options'] = field[setting]['options'];\n          break;\n        default:\n          break;\n      };\n\n      if (field[setting]['url']) {\n        fieldValues['url'] = field[setting]['url'];\n        fieldValues['name'] = field[setting]['name'];\n        fieldValues['value'] = field[setting]['name'];\n      }\n\n      if (fields[fieldIndex]) {\n        _fields[fieldIndex] = fieldValues;\n      }\n    }\n  }\n  return _fields;\n}\n\nexport function getFieldsMap(fields, pageNum: number) {\n  let fieldsMap = {};\n  for (const fieldIndex in fields) {\n    if (fields.hasOwnProperty(fieldIndex) && fields[fieldIndex]) {\n      const field = fields[fieldIndex];\n      let keyNameSuffix = '';\n      switch (field.type.toLowerCase()) {\n        case 'checkbox':\n        case 'checkbox_group':\n        case 'radio_button_group':\n          keyNameSuffix = field['optionId'] ? '-' + field['optionId'] : '';\n          break;\n        default:\n          break;\n      }\n      fieldsMap[field.name + keyNameSuffix] = {\n        field_name: field.name,\n        keyNameSuffix: field['optionId'] ? '-' + field['optionId'] : null,\n        option_id: field['optionId'],\n        field_pageNum: pageNum,\n        field_field_index: fieldIndex\n      }\n    }\n  }\n  return fieldsMap;\n}\n\nexport function updateElementStyles(fields, _fields, mode, browserType) {\n  if (fields && _fields && fields.length === _fields.length) {\n    for (let x = 0; x < _fields.length; x++) {\n      let fieldIndex = findIndex(fields, { name: _fields[x].field_name });\n      if (fieldIndex >= 0) {\n        _fields[x]['initialStyle'] = getInputStyle(fields[fieldIndex], mode, browserType);\n        if (_fields[x].controlType.toLowerCase() === 'checkbox' || _fields[x].controlType.toLowerCase() === 'checkbox_group' || _fields[x].controlType.toLowerCase() === 'radio_button_group') {\n          _fields[x]['checkboxStyle'] = generateCheckboxLabel(fields[fieldIndex].required);\n        }\n      }\n    }\n  }\n  return _fields;\n}\n\nexport function getInputStyle(field, mode, browserType) {\n  const fontSize = 11;\n  let setting = 'setting';\n  if (!!field['settings']) {\n    setting = 'settings';\n  }\n  const inputStyle = {\n    'height': '100%',\n    'width': '100%',\n    'background': 'none'\n  };\n  if ((field[setting] && field[setting].font_size) || field.type === 'date' || field.type === 'signature' || field.type === 'initial' || field.type === 'timestamp') {\n    inputStyle['fontSize'] = fontSize + 'px';\n    inputStyle['letterSpacing'] = '.3px !important';\n  }\n\n  if (field.type === 'dropdown') {\n    inputStyle['fontSize'] = '10.8px';\n    delete inputStyle.background;\n  }\n\n  if (field.type === 'textbox') {\n    inputStyle['fontSize'] = fontSize + 'px';\n    inputStyle['letterSpacing'] = getLetterSpacing(browserType) + 'px';\n  }\n  if (field['required']) {\n    inputStyle['border'] = '1px solid #cc0000';\n  }\n  if (field['prepared'] && field['prepared'] === true && mode !== 'prepareview') {\n    inputStyle['visibility'] = 'hidden';\n  }\n  if (field[setting] && field[setting].color) {\n    inputStyle['color'] = field[setting].color;\n  }\n  if (field[setting] && field[setting].upperCase) {\n    inputStyle['textTransform'] = 'uppercase';\n  }\n\n  if (field[setting] && field[setting].leading > 0) {\n    inputStyle['lineHeight'] = `${rescale(1, field[setting].leading + .5)}px`;\n  } else if (field.leading && field.leading > 0) {\n    inputStyle['lineHeight'] = `${rescale(1, field.leading + .5)}px`;\n  }\n\n  return inputStyle;\n}\n\nexport function generateCheckboxLabel(required) {\n  const labelStyle = {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    cursor: 'pointer',\n    height: `13.5px`,\n    width: `13.5px`,\n    backgroundColor: 'transparent',\n    border: '1px solid #777'\n  }\n  if (required === true) {\n    labelStyle['boxShadow'] = '0 0 0 1px #cc0000';\n  }\n  return labelStyle;\n};\n\nexport function getLetterSpacing(browserType) {\n  switch (browserType) {\n    case 'opera':\n      return -0.0018;\n    case 'firefox':\n      return -0.23594210526315787;\n    case 'ie':\n      return -0.0019;\n    case 'edge':\n      return -0.0019;\n    case 'chrome':\n      return -0.0018;\n    case 'safari':\n      return -0.0018;\n    case 'blink':\n      return -0.0018;\n    default:\n      return -0.0018;\n  }\n}\n\nexport function rescale(r, n): number {\n  return r * n;\n}\n\nexport function prepareFieldsForSigner(fields) {\n  let fieldsForCurrentSigner = new Array(fields.length);\n}\n","export function getDefaultHeight(field) {\n  let height = 0;\n  switch (field.type) {\n    case 'signature':\n    case 'initial':\n      height = 36;\n      break;\n    case 'checkbox':\n    case 'checkbox_group':\n    case 'radio_button_group':\n      height = 13.5;\n      break;\n    case 'attachment':\n    case 'payment':\n      height = 24;\n      break;\n    default:\n      height = field.setting['height'] || 0;\n      break;\n  }\n  return height;\n}\n\nexport function getDefaultWidth(field) {\n  let width = 0;\n  switch (field.type) {\n    case 'signature':\n    case 'initial':\n      width = 82.63636363636;\n      break;\n    case 'checkbox':\n    case 'checkbox_group':\n    case 'radio_button_group':\n      width = 13.5;\n      break;\n    case 'attachment':\n    case 'payment':\n      width = 24;\n      break;\n    case 'date':\n      width = 64;\n      break;\n    case 'dropdown':\n      width = field.setting['width'] || 64;\n      break;\n    default:\n      width = field.setting['width'] || 0;\n      break;\n  }\n  return width;\n}\n\nexport function getRTop(y, fieldHeight, iTextHeight, yRatio) {\n  return iTextHeight - ((y + fieldHeight) * yRatio);\n}\n\nexport function getRLeft(x, ratio) {\n  return x * ratio;\n}\n\nexport function getRValue(y, ratio) {\n  return y * ratio;\n}\n\nexport function getUIFieldStyling(field) {\n  const height = getDefaultHeight(field);\n  const style = {\n    left: field.setting.x + 'px',\n    bottom: field.setting.y + 'px',\n    height: '100%',\n    width: '100%'\n  };\n\n  switch (field.type) {\n    case 'textbox':\n    case 'date':\n    case 'timestamp':\n    case 'placeholder':\n    case 'dropdown':\n      style['maxHeight'] = height + 'px';\n      style['maxWidth'] = field.setting.width + 'px';\n      break;\n    case 'checkbox':\n    case 'checkbox_group':\n    case 'radio_button_group':\n      style['maxHeight'] = 13.5 + 'px';\n      style['maxWidth'] = 13.5 + 'px';\n      break;\n    case 'attachment':\n    case 'payment':\n      style['maxHeight'] = 24 + 'px';\n      style['maxWidth'] = 24 + 'px';\n      break;\n    case 'signature':\n    case 'initial':\n      style['maxHeight'] = 36 + 'px';\n      style['maxWidth'] = 82.63636363636 + 'px';\n      style['line-height'] = 36 + 'px';\n      break;\n    default:\n      break;\n  }\n  return style;\n}\nexport function blobToBase64(image: Blob) {\n  const fileReader = new FileReader();\n  return new Promise((resolve, reject) => {\n    fileReader.onerror = () => {\n      reject(new DOMException(\"Problem reading blob.\"));\n    }\n\n    fileReader.onload = () => {\n      resolve(fileReader.result);\n    }\n\n    fileReader.readAsDataURL(image);\n  })\n}\n","import { getRGBA, nameToRGBA } from '@verdocs/sdk';\nimport { findIndex } from 'lodash';\nimport { getLetterSpacing } from './viewer-fields';\nimport { getUIFieldStyling } from './conversion';\n\nexport function setRatio(pages, pdfPages) {\n  for (let i = 0; i < pages.length; i++) {\n    for (let j = 0; j < pages[i].fields.length; j++) {\n      if (pages[i].fields[j]) {\n        pages[i].fields[j]['ratio'] = {\n          x: pdfPages[i].xRatio,\n          y: pdfPages[i].yRatio\n        };\n      }\n    }\n  }\n  return pages;\n}\n\nexport function constructPages(pages, roles, pdfPages, browserType) {\n  if (pages && pages.length > 0) {\n    let fieldPages = new Array(pages.length);\n    for (let i = 0; i < pages.length; i++) {\n      fieldPages[i] = { fields: [] }\n      for (let j = 0; j < pages[i].fields.length; j++) {\n        if (pages[i].fields[j]['setting'] && pages[i].fields[j]['setting']['options'] &&\n          pages[i].fields[j]['setting']['options'].length > 0 && (pages[i].fields[j]['type'] === 'checkbox_group') ||\n          pages[i].fields[j]['type'] === 'radio_button_group') {\n          const groupFields = constructGroupFields(pages, i, j, roles, pdfPages, fieldPages, browserType);\n          fieldPages[i].fields.concat(groupFields);\n        } else {\n          const fieldCopy = { ...pages[i].fields[j] };\n          const copyIndex = findIndex(fieldPages[i].fields, { name: fieldCopy.name });\n          fieldCopy['originalIndex'] = j;\n          if (fieldCopy.type !== 'checkbox_group' && fieldCopy.type !== 'radio_button_group') {\n            fieldCopy['initialStyle'] = generateInitialStyle(fieldCopy, roles, browserType);\n            fieldCopy['style'] = generateStyle(fieldCopy, pdfPages);\n          }\n          if (fieldCopy.type === 'checkbox' || fieldCopy.type === 'checkbox_group' || fieldCopy.type === 'radio_button_group') {\n            fieldCopy['checkboxStyle'] = generateGroupLabel(i, fieldCopy.role_name, roles, pdfPages);\n          }\n          if (copyIndex < 0) {\n            fieldPages[i].fields[fieldPages[i].fields.length] = fieldCopy;\n          }\n        }\n      }\n    }\n    return fieldPages;\n  } else {\n    return [];\n  }\n}\n\nexport function constructGroupFields(pages, i, j, roles, pdfPages, fieldPages, browserType) {\n  let k = 0;\n  const optionsLength = pages[i].fields[j]['setting']['options'].length\n  while (k < optionsLength) {\n    const fieldCopy = { ...pages[i].fields[j] };\n    const options = pages[i].fields[j]['setting']['options'][k];\n    fieldCopy.setting['x'] = options.x;\n    fieldCopy.setting['y'] = options.y;\n    if (fieldCopy.type === 'checkbox_group') {\n      fieldCopy.setting['checked'] = options.checked;\n    } else {\n      fieldCopy.setting['selected'] = options.selected;\n    }\n    fieldCopy['initialStyle'] = generateInitialStyle(fieldCopy, roles, browserType);\n    fieldCopy['style'] = generateStyle(fieldCopy, pdfPages);\n    fieldCopy['checkboxStyle'] = generateGroupLabel(i, fieldCopy.role_name, roles, pdfPages);\n    fieldCopy['originalIndex'] = j;\n    fieldCopy['optionIndex'] = k;\n    fieldCopy['optionId'] = options.id;\n    const copyIndex = findIndex(fieldPages[i].fields, { optionIndex: fieldCopy.optionIndex, name: fieldCopy.name });\n    if (copyIndex < 0) {\n      fieldPages[i].fields[fieldPages[i].fields.length] = fieldCopy;\n    }\n    k++;\n  }\n  return fieldPages;\n}\n\nexport function generateInitialStyle(field, roles, browserType) {\n  const fontSize = 9.5;\n  const setting = field.setting;\n  const role_name = field.role_name;\n  const initialStyle = {\n    height: '100%',\n    width: '100%',\n    backgroundColor: getRoleColor(role_name, roles),\n    letterSpacing: null,\n    fontSize: null\n  };\n  field['initialStyle'] = initialStyle;\n  switch (field.type) {\n    case 'textbox':\n    case 'textarea':\n      field['initialStyle']['letterSpacing'] = convertToUIRatio(getLetterSpacing(browserType), field['ratio'].x) + 'px';\n    case 'signature':\n    case 'initial':\n    case 'date':\n    case 'dropdown':\n      field['initialStyle']['fontSize'] = convertToUIRatio(fontSize, field['ratio'].x) + 'px';\n      break;\n    case 'timestamp':\n        field['initialStyle']['fontSize'] = convertToUIRatio(8.5, field['ratio'].x) + 'px';\n      break;\n    case 'attachment':\n    case 'payment':\n      field['initialStyle']['height'] = '24px';\n      field['initialStyle']['mat-icon'] = {\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        height: '24px',\n        width: '24px',\n        lineHeight: '24px',\n        fontSize: '18px'\n      }\n      break;\n    default:\n      break;\n  }\n\n  if (setting.leading && setting.leading > 0) {\n    field.initialStyle['line-height'] = convertToUIRatio(setting.leading + .11395, field['ratio'].y) + 'px';\n  }\n  return field.initialStyle;\n}\n\nexport function generateStyle(field, pdfPages) {\n  return getUIFieldStyling(field);\n}\n\nexport function generateGroupLabel(i, role_name, roles, pdfPages) {\n  return {\n    position: 'absolute',\n    top: 0,\n    left: 0,\n    height: '13.5px',\n    width: '13.5px',\n    backgroundColor: getRoleColor(role_name, roles),\n    border: '2px solid #777'\n  }\n}\n\nexport function getRoleColor(name, roles, index?) {\n  if (index) {\n    return getRGBA(index);\n  } else if (roles && roles.length > 0) {\n    index = findIndex(roles, { name: name });\n    if (index >= 0) {\n      return roles[index].rgba ? roles[index].rgba : getRGBA(index);\n    } else {\n      return nameToRGBA(name);\n    }\n  } else {\n    return nameToRGBA(name);\n  }\n}\n\nexport function convertToUIRatio(value: number, ratio) {\n  return value * ratio;\n}\n","export function isInView(scrollTop, pageTop, pageHeight) {\n  if (typeof scrollTop === 'undefined') {\n    return null\n  }\n  if (window) {\n    let headerHeight = 112;\n    const viewportWidth = window.innerWidth;\n    if (viewportWidth > 600) {\n      headerHeight = 128;\n    }\n    const viewportHeight = window.innerHeight - headerHeight;\n    return topOfPageIsInView(scrollTop, pageTop, viewportHeight) ||\n      middleOfPageIsInView(scrollTop, pageTop, pageHeight, viewportHeight) ||\n      bottomOfPageIsInView(scrollTop, pageTop, pageHeight, viewportHeight);\n  }\n}\n\nexport function topOfPageIsInView(scrollTop, pageTop, viewportHeight): boolean {\n  return pageTop > scrollTop && pageTop < scrollTop + viewportHeight\n}\n\nexport function middleOfPageIsInView(scrollTop, pageTop, pageHeight, viewportHeight): boolean {\n  const viewportBottom = scrollTop + viewportHeight;\n  const pageBottom = pageTop + pageHeight\n  return scrollTop > pageTop && viewportBottom < pageBottom;\n}\n\nexport function bottomOfPageIsInView(scrollTop, pageTop, pageHeight, viewportHeight): boolean {\n  const viewportBottom = scrollTop + viewportHeight;\n  const pageBottom = pageTop + pageHeight\n  return viewportBottom > pageBottom && scrollTop < pageBottom;\n}","import { ITimePeriod } from '@verdocs/sdk';\n\nexport function timePeriod(type): ITimePeriod {\n  let endDate = new Date().getTime();\n    const today = new Date();\n    const month = today.getMonth();\n    const year = today.getFullYear();\n    let startDate = null;\n    switch (type) {\n      case '30d':\n        startDate = endDate - (60 * 60 * 24 * 30 * 1000);\n        break;\n      case '60d':\n        startDate = endDate - (60 * 60 * 24 * 60 * 1000);\n        break;\n      case '6m':\n        startDate = endDate - (60 * 60 * 24 * 30 * 6 * 1000);\n        break;\n      case 'this_month':\n        startDate = new Date(year, month, 1).getTime();\n        break;\n      case 'last_month':\n        startDate = new Date(year, month - 1, 1).getTime();\n        endDate = new Date(year, month, 0).getTime();\n        break;\n      case 'this_year':\n        startDate = new Date(year, 0, 1);\n        break;\n      case 'all_time':\n        startDate = null;\n        endDate = null;\n        break;\n      default:\n        startDate = null;\n        endDate = null;\n        break;\n    }\n\n    if (startDate == null && endDate == null) {\n      return null;\n    }\n    return {\n      start_time: new Date(startDate).toISOString(),\n      end_time: new Date(endDate).toISOString()\n    } as ITimePeriod;\n}","import printJS from 'print-js';\n\n\nexport function regParse(string: string) {\n  return JSON.parse(string, function (key, value) {\n    let prefix;\n    if (typeof value !== 'string') {\n      return value;\n    }\n    if (value.length < 8) {\n      return value;\n    }\n    prefix = value.substring(0, 8);\n\n    if (prefix === 'function') {\n      return eval('(' + value + ')');\n    }\n    if (prefix === '_PxEgEr_') {\n      return eval(value.slice(8));\n    }\n    if (prefix === '_NuFrRa_') {\n      return eval(value.slice(8));\n    }\n    return value;\n  });\n}\n\nexport function dataURLtoBlob(dataUrl, type: string = 'image/png') {\n  const arr = dataUrl.split(','),\n    // mime = arr[0].match(/:(.*?);/)[1],\n    bstr = atob(arr[1]);\n    let n = bstr.length;\n  const u8arr = new Uint8Array(n);\n  while (n--) {\n    u8arr[n] = bstr.charCodeAt(n);\n  }\n  return new Blob([u8arr], { type: type });\n}\n\nexport function printPdfUrl(pdfUrl) {\n  if (typeof (pdfUrl) === 'string') {\n    printJS(pdfUrl);\n  } else {\n    console.error('pdfUrl should be provided, instead received: ', pdfUrl );\n  }\n}\n","import { Injectable, Inject, PLATFORM_ID } from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\nimport { MatSnackBar, MatSnackBarConfig, MatSnackBarRef } from '@angular/material/snack-bar';\n\n@Injectable()\nexport class SnackbarService {\n  constructor(\n    private snackbar: MatSnackBar,\n    @Inject(PLATFORM_ID) private platform\n  ) { }\n\n  initConfig(duration?: number, position?: 'bottom' | 'top'): MatSnackBarConfig {\n    if ((isPlatformBrowser(this.platform))) {\n      let snackbarConfig: MatSnackBarConfig\n      if (window && window.innerWidth >= 920) {\n        snackbarConfig = {\n          verticalPosition: position ? position : 'bottom',\n          horizontalPosition: 'left',\n          duration: duration ? duration : 5000\n        }\n      } else {\n        snackbarConfig = {\n          verticalPosition: position ? position : 'top',\n          duration: duration ? duration : 5000\n        }\n      }\n\n      return snackbarConfig;\n    }\n  }\n\n  open(message: string, action?, config?): MatSnackBarRef<any> {\n    return this.snackbar.open(message, action ? action : undefined, config ? config : this.initConfig());\n  }\n\n  dismiss(): void {\n    this.snackbar.dismiss();\n  }\n}\n","import { Injectable } from '@angular/core';\n\n@Injectable()\nexport class BrowserToiTextService {\n  detectBrowser() {\n    //noinspection TypeScriptUnresolvedVariable\n    let isFirefox = false;\n    if ('InstallTrigger' in window) {\n      isFirefox = true;\n    }\n\n    const isOpera = (!!window['opr'] && !!window['opr'].addons) || !!window['opera'] || navigator.userAgent.indexOf(' OPR/') >= 0;\n\n    const isSafari = /constructor/i.test(window['HTMLElement']) || (function (p) { return p.toString() === \"[object SafariRemoteNotification]\"; })(!window['safari'] || (window['safari'] && window['safari'].pushNotification));\n\n    const isIE = /*@cc_on!@*/false || !!document['documentMode'];\n\n    const isEdge = !isIE && !!window['StyleMedia'];\n\n    const isChrome = !!window['chrome'] && !!window['chrome'].webstore;\n\n    const isBlink = (isChrome || isOpera) && !!window['CSS'];\n\n\n    if (isOpera) {\n      return 'opera';\n    } else if (isFirefox) {\n      return 'firefox';\n    } else if (isIE) {\n      return 'ie';\n    } else if (isEdge) {\n      return 'edge';\n    } else if (isChrome) {\n      return 'chrome';\n    } else if (isBlink) {\n      return 'blink'\n    } else if (isSafari) {\n      return 'safari'\n    }\n    return 'unknown';\n  }\n\n  getLetterSpacing() {\n    const browserType = this.detectBrowser();\n    switch (browserType) {\n      case 'opera':\n        return -0.0018;\n      case 'firefox':\n        return -0.23594210526315787;\n      case 'ie':\n        return -0.0019;\n      case 'edge':\n        return -0.0019;\n      case 'chrome':\n        return -0.0018;\n      case 'safari':\n        return -0.0018;\n      case 'blink':\n        return -0.0018;\n      default:\n        return -0.0018;\n    }\n  }\n}\n","\nimport { Injectable, Injector } from '@angular/core';\nimport { HttpClient, HttpRequest } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { \n  TemplatesService,\n  ITemplate,\n  ITemplateDocument,\n  IPage,\n  IRole,\n  IField,\n  OptionType,\n  FieldRole,\n  TemplatesGuardService,\n  TemplateActions\n} from '@verdocs/sdk';\n// import { MatSnackBar, MatSnackBarConfig } from '@angular/material/snack-bar';\nimport { throwError as observableThrowError, ReplaySubject, Observable, from, forkJoin, Subject, of } from 'rxjs';\nimport { catchError, map, delay, mergeMap } from 'rxjs/operators';\nimport { filter } from 'lodash';\nimport { findIndex, remove } from 'lodash';\n\nimport { nameToRGBA, getRGBA } from '@verdocs/sdk';\nimport { SnackbarService } from '../snackbar/snackbar.service';\nimport { EventTrackerService } from '@verdocs/event-tracker';\n\nimport { EssentialsConfig, EssentialsConfigToken } from '../essentials.module';\n\n@Injectable()\nexport class BuilderDataService {\n  private _config_token: EssentialsConfig;\n  private recipients = [];\n  private template;\n  private templateDoc;\n  private templatePages;\n  private templateName: string;\n  private activeFieldIndex: any;\n  private roles: IRole[] = [];\n  private templateSubject: ReplaySubject<ITemplate> = new ReplaySubject<ITemplate>(1, 500);\n  private templateId: string;\n  private hasFields = false;\n  private rForm_backend_url: string;\n\n  public templateNameSubject: ReplaySubject<string> = new ReplaySubject<string>(1, 500);\n  public templatePagesSubject: ReplaySubject<number> = new ReplaySubject<number>(1, 500);\n  public recipientsSubject: ReplaySubject<IRole[]> = new ReplaySubject<IRole[]>();\n  public activeRecipientSubject: ReplaySubject<IRole> = new ReplaySubject<IRole>();\n  public scrollInfoSubject: ReplaySubject<any> = new ReplaySubject<any>();\n  public screenInfoSubject: ReplaySubject<any> = new ReplaySubject<any>();\n  public newTypeSubject: Subject<string | null> = new Subject<string | null>();\n  public newOptionSubject: ReplaySubject<OptionType> = new ReplaySubject<OptionType>(1, 100);\n  public duplicateFieldSubject: ReplaySubject<IField> = new ReplaySubject<IField>();\n  public saveStatusSubject: ReplaySubject<string> = new ReplaySubject<string>();\n  public renderedSubject: ReplaySubject<string> = new ReplaySubject<string>();\n  public activeFieldIndexSubject: ReplaySubject<any> = new ReplaySubject<any>(1, 100);\n  public numberOfRolesSubject: ReplaySubject<number> = new ReplaySubject<number>();\n  public numberOfSequenceSubject: ReplaySubject<number> = new ReplaySubject<number>();\n  public hasFieldsSubject: ReplaySubject<boolean> = new ReplaySubject<boolean>();\n\n  constructor(\n    private http: HttpClient,\n    private router: Router,\n    private templatesService: TemplatesService,\n    // private snackbar: MatSnackBar,\n    private templateGuard: TemplatesGuardService,\n    private snackbarService: SnackbarService,\n    private eventTracker: EventTrackerService,\n    private injector: Injector\n  ) {\n    this._config_token = this.injector.get(EssentialsConfigToken);\n    this.rForm_backend_url = this._config_token.rForm_backend_url;\n    /* Use NGRX to do the subscriptions */\n    this.templateSubject.subscribe(template => {\n      this.template = template;\n      if (template && template.name) {\n        this.templateNameSubject.next(template.name);\n      }\n    });\n    this.templateNameSubject.subscribe(name => {\n      this.templateName = name;\n    });\n    /* Remove above after refactoring */\n  }\n\n  createTemplate(template_body: ITemplate): Observable<ITemplate> {\n    return this.http\n      .post<ITemplate>(this.rForm_backend_url + '/templates', template_body)\n      .pipe(\n        map((res) => {\n          this.templateSubject.next(res);\n          this.recipientsSubject.next([]);\n          return res;\n        })\n      );\n  }\n\n  updateLocalTemplateData() {\n    this.templateName = this.template.name;\n    this.templateNameSubject.next(this.templateName);\n    this.templatePages = this.template.pages.length;\n    this.templatePagesSubject.next(this.templatePages);\n  }\n\n  updateTemplate(template_body: ITemplate) {\n    return this.templatesService.updateTemplateObservable(template_body.id, template_body).pipe(\n      map(template => template)\n    );\n  }\n\n  updateTemplateName(template, name) {\n    if (template && template.id) {\n      return this.templatesService.updateTemplateObservable(template.id, { name: name })\n        .pipe(\n          map(res => {\n            template.name = res.name;\n            this.updateLocalTemplate(template);\n            this.saveStatusSubject.next('saved');\n            this.createSnackBar('Name Changed to: ' + name);\n            return res.name;\n          },\n            err => {\n              this.saveStatusSubject.next('Failed to save');\n              this.createSnackBar('Failed to change Template name');\n              return err;\n            })\n        )\n    } else {\n      this.templateNameSubject.next(name);\n      this.saveStatusSubject.next('Name will be updated');\n    }\n  }\n\n  getTemplateObservable(templateId: string): Observable<ITemplate> {\n    return this.templatesService.getTemplateObservable(templateId);\n  }\n\n  getTemplate(templateId: string) {\n    return this.templatesService.getTemplate(templateId).toPromise().then(template => {\n      this.updateLocalTemplate(template);\n      this.recipients = this.sortRoles(this.template);\n      this.template.roles = this.recipients;\n      this.roles = this.recipients;\n      this.recipientsSubject.next(this.recipients);\n      this.activeRecipientSubject.next(this.recipients[0]);\n      return this.template;\n    })\n  }\n\n  watchForUpdatedTemplate() {\n    return this.templateSubject.pipe(map(template => template));\n  }\n\n  updateLocalTemplate(template) {\n    if (template) {\n      this.template = template;\n      if (this.template && this.template.pages) {\n        this.template.pages = this.template.pages.sort((a, b) => {\n          return a.sequence - b.sequence;\n        });\n      }\n      if (this.template) {\n        this.updateLocalTemplateData();\n        this.checkForFields(this.template.roles);\n      }\n      this.recipientsSubject.next(this.template.roles.sort((a, b) => {\n        return a.sequence - b.sequence;\n      }));\n      this.templateSubject.next(this.template);\n    } else {\n      this.templateNameSubject.next(null);\n      this.templatePagesSubject.next(null);\n      this.numberOfRolesSubject.next(null);\n      this.numberOfSequenceSubject.next(null);\n      this.hasFieldsSubject.next(false);\n    }\n  }\n\n  uploadTemplateDocument(file: File, template: ITemplate) {\n    const formdata = new FormData();\n    formdata.append('document', file, file.name);\n    const req = new HttpRequest('POST', this.rForm_backend_url+ '/templates/' + template.id + '/documents', formdata, {\n      reportProgress: true\n    });\n    return this.http.request(req)\n      .pipe(\n        map(res => res),\n        catchError(err => {\n          return observableThrowError(err);\n        })\n      )\n  }\n\n  getTemplateDocument(templateId) {\n    this.templateDoc = this.templatesService.getAllTemplateDocumentsObservable(templateId).pipe(\n      map((docs: Array<ITemplateDocument>) => {\n        this.templateDoc = docs[0];\n        return this.templateDoc\n      })\n    );\n\n    return this.templateDoc;\n  }\n\n  getTemplateDocumentFile(templateId, templateDoc) {\n    if (templateId && templateDoc) {\n      return this.templatesService.getTemplateDocumentPDFObservable(templateId, templateDoc).pipe(\n        map(pdf => {\n          const pdfUrl = URL.createObjectURL(pdf);\n          return pdfUrl;\n        }))\n    }\n  }\n\n  setTemplateDocument(templateDocument) {\n    this.templateDoc = templateDocument;\n  }\n\n  addTemplatePage(document, pageNum, templateId) {\n    const body = {\n      sequence: pageNum,\n      page_number: pageNum,\n      document_id: document.id\n    }\n    return this.http.post<IPage>(this.rForm_backend_url+ `/templates/${templateId}/pages`, body)\n      .pipe(\n        map((res: IPage) => res),\n        catchError(err => {\n          return observableThrowError(err);\n        })\n      )\n  }\n\n  addTemplatePages(document, pageNums: number[], templateId: string) {\n    return from(pageNums)\n      .pipe(\n        mergeMap(pageNum => {\n          const page = {\n            sequence: pageNum,\n            page_number: pageNum,\n            document_id: document.id\n          };\n          return <Observable<IPage>>this.http.post(this.rForm_backend_url+ `/templates/${templateId}/pages`, page).pipe(delay(200));\n        })\n      )\n  }\n\n  deleteTemplateField(template: ITemplate, fieldName: string, i, j): Observable<ITemplate> {\n    return this.http\n      .delete<void>(this.rForm_backend_url+ '/templates/' + template.id + '/fields/' + fieldName.trim())\n      .pipe(\n        map(field => {\n          const fieldIndex = findIndex(template.pages[i].fields, { name: fieldName });\n          const roleIndex = findIndex(template.roles, { name: template.pages[i].fields[fieldIndex].role_name });\n\n          if (roleIndex > -1) {\n            const roleFieldIndex = findIndex(template.roles[roleIndex].fields, { name: fieldName });\n            if (roleFieldIndex > -1) {\n              template.roles[roleIndex].fields.splice(roleFieldIndex, 1);\n            }\n          }\n          template.pages[i].fields.splice(fieldIndex, 1);\n          this.updateLocalTemplate(template);\n          this.saveStatusSubject.next('saved');\n          this.checkForFields(template.roles);\n          return template;\n        })\n      );\n  }\n\n  deleteTemplateFields(fieldNames: string[], template: ITemplate) {\n    if (fieldNames && fieldNames.length > 0) {\n      const pages = template.pages;\n      for (const fieldName of fieldNames) {\n        for (let x = 0; x < pages.length; x++) {\n          const fieldIndex = findIndex(pages[x].fields, { name: fieldName });\n          if (fieldIndex >= 0) {\n            template.pages[x].fields.splice(fieldIndex, 1);\n          }\n        }\n      }\n      this.checkForFields(template.roles);\n    }\n  }\n\n  addTemplateField(newField: IField, i, j, template: ITemplate): Observable<ITemplate> {\n    newField.name = newField.name.trim();\n    return this.http\n      .post<IField>(this.rForm_backend_url+ '/templates/' + newField.template_id + '/fields', newField)\n      .pipe(\n        map(field => {\n          this.eventTracker.createEvent({\n            category: 'document',\n            action: `document ${field.type} field added`,\n            label: `document id: ${newField.template_id}`\n          });\n          template.pages[i].fields[j] = field;\n          this.checkForFields(template.roles);\n          const roleIndex = findIndex(template.roles, { name: field.role_name });\n          if (roleIndex >= 0) {\n            template.roles[roleIndex]['fields'].push(field);\n          }\n          this.templateSubject.next(template);\n          return template;\n        })\n      );\n  }\n\n  getTemplateOwnerInfo(id: string): Promise<{ profile_id: string, email: string, name: string }> {\n    return this.templatesService.getTemplateOwnerInfo(id);\n  }\n\n  updateTemplateField(template: ITemplate, body: IField, oldName, i, j): Observable<ITemplate> {\n    oldName = oldName.trim();\n    return this.http\n      .put<IField>(this.rForm_backend_url+ '/templates/' + template.id + '/fields/' + oldName, body)\n      .pipe(\n        map(field => {\n          this.eventTracker.createEvent({\n            category: 'document',\n            action: `document ${field.type} field updated`,\n            label: `document id: ${template.id}`\n          });\n          const fieldIndex = findIndex(template.pages[i].fields, { name: oldName });\n          if (field.page_sequence - 1 !== i) {\n            template.pages[i].fields.splice(fieldIndex, 1);\n            template.pages[field.page_sequence - 1].fields.push(field);\n          } else {\n            template.pages[i].fields[fieldIndex] = field;\n          }\n          const roleIndex = findIndex(template.roles, { name: field.role_name });\n          if (roleIndex >= 0) {\n            template = this.updateRoleField(template, field, roleIndex, oldName);\n          }\n          this.templateSubject.next(template);\n          this.saveStatusSubject.next('saved');\n          return template;\n        })\n      );\n  }\n\n  updateRoleField(template: ITemplate, updated_field, role_index, old_name) {\n    const field_index = findIndex(template.roles[role_index].fields, { name: old_name });\n    if (field_index >= 0) {\n      template.roles[role_index].fields[field_index] = updated_field;\n    } else {\n      template.roles[role_index].fields.push(updated_field);\n    }\n    return template;\n  }\n\n  updateDropdownField(template: ITemplate, body: any, oldName, i, j): Observable<ITemplate> {\n    oldName = oldName.trim();\n    return this.http\n      .put<any>(this.rForm_backend_url+ '/templates/' + template.id + '/fields/' + oldName, body)\n      .pipe(\n        map(field => {\n          const fieldIndex = findIndex(template.pages[i].fields, { name: oldName });\n          template.pages[i].fields[fieldIndex] = field;\n          this.templateSubject.next(template);\n          this.saveStatusSubject.next('saved');\n          return template;\n        })\n      );\n  }\n\n  deleteSequence(template_id: string, sequence_number: number) {\n    return this.templatesService.deleteSequence(template_id, sequence_number);\n  }\n\n  prepareFieldDuplication(field) {\n    this.duplicateFieldSubject.next(field);\n  };\n\n  checkForFields(roles) {\n    let hasFields = true;\n    if (roles && roles.length > 0) {\n      for (let role of roles) {\n        if (role && role.type === 'signer' && role.fields.length === 0) {\n          hasFields = false;\n        }\n      }\n    } else {\n      hasFields = false;\n    }\n    this.hasFields = hasFields;\n    this.hasFieldsSubject.next(this.hasFields);\n  }\n\n  createSnackBar(title: string, buttonTitle = 'OK'): void {\n  //   let snackbarConfig: MatSnackBarConfig\n  //   if (window.innerWidth >= 920) {\n  //     snackbarConfig = {\n  //       verticalPosition: 'bottom',\n  //       horizontalPosition: 'left',\n  //       duration: 5000\n  //     }\n  //   } else {\n  //     snackbarConfig = {\n  //       verticalPosition: 'top',\n  //       duration: 5000\n  //     }\n  //   }\n  //   this.snackbar.open(title, buttonTitle, snackbarConfig);\n  }\n\n  editDocsUrl(templateId: string) {\n    const editDocsPageUrl = `/builder/${templateId}/docs`;\n    return editDocsPageUrl;\n  }\n\n  editRolesUrl(templateId: string) {\n    const editRolesPageUrl = `/builder/${templateId}/roles`;\n    return editRolesPageUrl;\n  }\n\n  editTemplateUrl(templateId: string) {\n    const editPageUrl = `/builder/${templateId}/fields`\n    return editPageUrl;\n  }\n\n  previewTemplateUrl(templateId: string) {\n    const reviewTemplateUrl = `/document/${templateId}`;\n    return reviewTemplateUrl;\n  }\n\n  addFieldRole(templateId: string, fieldId: string, roleId: string, i, j): Promise<FieldRole> {\n    const fieldRoleInfo = JSON.stringify({\n      field_id: fieldId,\n      role_id: roleId\n    });\n    return this.http\n      .post<FieldRole>(this.rForm_backend_url+ '/template/' + templateId + '/field_role', fieldRoleInfo).toPromise().then(fieldRole => {\n        return fieldRole;\n      });\n  }\n\n  addRole(role: IRole | IRole[], template: ITemplate): Observable<ITemplate> {\n    const templateBackend = this.rForm_backend_url+ '/templates/' + template.id + '/roles';\n    this.roles = [];\n    this.roles = this.roles.concat(role);\n    const roleRequests = [];\n    this.roles.forEach(role => {\n      roleRequests.push(this.http.post(templateBackend, role));\n    })\n\n    if (this.roles && this.roles.length > 0) {\n      return forkJoin(roleRequests).pipe(\n        map(savedRoles => {\n          savedRoles.concat(savedRoles as IRole[]);\n          if (!template['roles']) {\n            template['roles'] = <IRole[]>[];\n          }\n          const savedRolesWithFields = savedRoles.map(newRole => {\n            newRole['fields'] = [];\n            return newRole;\n          });\n          template['roles'] = template['roles'].concat(savedRolesWithFields);\n          this.recipients = this.sortRoles(template);\n          this.roles = this.recipients;\n          this.templateSubject.next(template);\n          this.recipientsSubject.next(this.recipients);\n          this.recipients;\n          return template\n        }, (err) => {\n          console.error(err);\n          console.error('Couldn\\'t save all the roles');\n          return err;\n        })\n      );\n    } else {\n      return of(template);\n    }\n  }\n\n  addCheckboxGroup(field) {\n    this.newOptionSubject.next(\n      {\n        type: 'checkbox_group',\n        page_sequence: field.page_sequence,\n        field_name: field.name,\n      }\n    );\n  }\n\n  addRadioGroup(field) {\n    this.newOptionSubject.next(\n      {\n        type: 'radio_button_group',\n        page_sequence: field.page_sequence,\n        field_name: field.name,\n      }\n    );\n  }\n\n  getRolesInSequence(roles) {\n    const rolesInSequence = [];\n    for (let roleIndex = 0; roleIndex < roles.length; roleIndex++) {\n      const sequenceIndex = roles[roleIndex]['sequence'] - 1;\n      const role = { ...roles[roleIndex] };\n      role['style'] = {\n        backgroundColor: `${this.getRoleColor(role.name, roleIndex)}`\n      };\n      if (!rolesInSequence[sequenceIndex]) {\n        rolesInSequence[sequenceIndex] = [role];\n      } else {\n        rolesInSequence[sequenceIndex].push(role);\n      }\n    }\n    this.numberOfSequenceSubject.next(rolesInSequence.length);\n    this.numberOfRolesSubject.next(roles.length);\n    return rolesInSequence\n  }\n\n  deleteRole(roleName, template: ITemplate) {\n    return this.http.delete(this.rForm_backend_url+ '/templates/' + template.id + '/roles/' + roleName)\n      .toPromise()\n      .then(() => {\n        remove(template.roles, (role: IRole) => {\n          this.recipients = this.sortRoles(template);\n          if (role.name === roleName) {\n            const fields = role.fields;\n            const fieldNames = [];\n            for (const field of fields) {\n              fieldNames.push(field.name);\n            }\n            this.deleteTemplateFields(fieldNames, template);\n          }\n          this.templateSubject.next(template);\n          this.recipientsSubject.next(this.recipients);\n          return role.name === roleName\n        });\n      });\n  }\n\n  deleteRoles(roleNames: Array<string>, template: ITemplate) {\n    const deleteCalls = [];\n    roleNames.forEach(role_name => {\n      template = {\n        ...template,\n        roles: template.roles.filter(role => role.name !== role_name)\n      }\n      deleteCalls.push(this.http.delete(this.rForm_backend_url+ '/templates/' + template.id + '/roles/' + role_name))\n    });\n    return forkJoin(deleteCalls).pipe(\n      map(() => {\n        return template;\n      }, err => {\n        console.error(err);\n        console.error('Couldn\\'t delete all the roles');\n        return err;\n      })\n    )\n  }\n\n  updateRoles(roles, template: ITemplate): Observable<ITemplate> {\n    const updateCalls = [];\n    roles.forEach(role => {\n      const body = {\n        template_id: template.id,\n        name: role.name.trim(),\n        full_name: role.full_name,\n        email: role.email,\n        sequence: role.sequence,\n        type: role.type,\n        delegator: role.delegator,\n        message: role.message,\n        phone: role.phone\n      }\n\n      const role_index = findIndex(template.roles, { name: role.old_name });\n      if (role_index >= 0) {\n        template.roles[role_index] = {\n          ...template.roles[role_index],\n          template_id: template.id,\n          name: role.name.trim(),\n          full_name: role.full_name,\n          email: role.email,\n          sequence: role.sequence,\n          type: role.type,\n          delegator: role.delegator,\n          message: role.message,\n          phone: role.phone\n        }\n      }\n      this.eventTracker.createEvent({\n        category: 'document',\n        action: 'document role updated',\n        label: `document id: ${template.id}`\n      });\n      updateCalls.push(this.http.put(this.rForm_backend_url+ '/templates/' + template.id + '/roles/' + role.old_name, body));\n    });\n    return forkJoin(updateCalls)\n      .pipe(\n        map(() => {\n          return template;\n        }, (err) => {\n          console.error(err);\n          console.error('Couldn\\'t save all the roles');\n          return err;\n        })\n      );\n  }\n  sortRoles(template: ITemplate): IRole[] {\n    if (template.roles.length < 1) {\n      return [];\n    }\n\n    const roles = template.roles.sort((a: IRole, b: IRole) => {\n      if (a.sequence === b.sequence) {\n        return a.name.toLowerCase() < b.name.toLowerCase() ? -1 : a.name.toLowerCase() > b.name.toLowerCase() ? 1 : 0;\n      }\n      return a.sequence - b.sequence;\n    });\n\n    for (let x = 0; x < roles.length; x++) {\n      roles[x]['rgba'] = getRGBA(x);\n    }\n    template.roles = roles;\n\n    return roles;\n  }\n\n  getRoleColor(name, index?, template?: ITemplate) {\n    if (index !== null && index > -1) {\n      return getRGBA(index);\n    } else if (template) {\n      if (template.roles && template.roles.length > 0) {\n        index = findIndex(template.roles, { name: name });\n        if (index >= 0) {\n          return template.roles[index].rgba ? template.roles[index].rgba : getRGBA(index);\n        }\n      } else {\n        return nameToRGBA(name);\n      }\n    } else {\n      return nameToRGBA(name);\n    }\n  }\n\n  updateFullName(role: IRole, template: ITemplate) {\n    for (let i = 0; i < template.pages.length; i++) {\n      if (template.pages[i].fields.length > 0) {\n        for (let j = 0; j < template.pages[i].fields.length; j++) {\n          if (template.pages[i].fields[j].type === 'placeholder' && template.pages[i].fields[j].setting['type'] === 'full_name') {\n            if (template.pages[i].fields[j].setting['result'] !== role.full_name &&\n              template.pages[i].fields[j].role_name === role.name) {\n              template.pages[i].fields[j].setting['result'] = role.full_name;\n              const updatedField = { ...template.pages[i].fields[j] };\n              this.updateTemplateField(template, updatedField, updatedField.name, i, j).toPromise().then(() => {\n                this.templateSubject.next(template);\n              });\n            }\n          }\n        }\n      }\n    }\n  }\n\n  setActiveFieldIndex(activeFieldIndex) {\n    this.activeFieldIndex = activeFieldIndex;\n    this.activeFieldIndexSubject.next(this.activeFieldIndex);\n  }\n\n  async autoAddSigner(template: ITemplate) {\n    return new Promise(async (resolve, reject) => {\n      const recipients = await this.addRole({ name: 'Signer 1', type: 'signer', sequence: 1 } as IRole, template).toPromise();\n      this.activeRecipientSubject.next(recipients[0]);\n      setTimeout(() => {\n        resolve()\n      }, 500);\n    });\n  }\n\n  openTemplate(template: ITemplate) {\n    if (this.canUserPreview(template)) {\n      this.router.navigate([`document/${template.id}`]);\n    } else if (this.canUserEdit(template)) {\n      this.router.navigate([`builder/${template.id}/fields`]);\n    } else {\n      this.snackbarService.open(`Template is in build mode, and not ready for use.  Please check back soon.`)\n    }\n  }\n\n  canUserEdit(template: ITemplate) {\n    const response = this.templateGuard.canPerformAction(TemplateActions.WRITE, template);\n    return response['canPerform']\n  }\n\n  canUserPreview(template: ITemplate) {\n    const hasPermission = (this.templateGuard.canPerformAction(TemplateActions.READ, template)).canPerform;\n    let canPreview;\n    const signers = filter(template.roles, { type: 'signer' });\n    canPreview = signers && signers.length > 0;\n    for (const signer of signers) {\n      canPreview = signer['fields'] && signer['fields'].length > 0;\n    }\n    return hasPermission && canPreview;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { ReplaySubject } from 'rxjs';\n\n@Injectable()\nexport class BuilderService {\n\n  private sideNavState: boolean;\n  private recipientSideNavState: boolean;\n  private activeRole: any;\n\n  public sideNavStateSubject: ReplaySubject<boolean> = new ReplaySubject();\n  public recipientSideNavStateSubject: ReplaySubject<boolean> = new ReplaySubject(1, 100);\n  public initiateAutofocus: ReplaySubject<boolean> = new ReplaySubject();\n  public recipientAutoFocus: ReplaySubject<boolean> = new ReplaySubject();\n  public deleteRoleSubject: ReplaySubject<any> = new ReplaySubject(1, 100)\n  public hasActiveRoleSubject: ReplaySubject<boolean> = new ReplaySubject();\n\n  // constructor() {}\n\n  toggleSideNav() {\n    this.sideNavState = !this.sideNavState;\n    this.sideNavStateSubject.next(this.sideNavState);\n    if (this.sideNavState === false) {\n      this.initiateAutofocus.next(false);\n    }\n  }\n\n  toggleRecipientSideNav() {\n    this.recipientSideNavState = !this.recipientSideNavState;\n    this.recipientSideNavStateSubject.next(this.recipientSideNavState);\n    if (this.recipientSideNavState === false) {\n      this.recipientAutoFocus.next(false);\n    }\n  }\n\n  openSideNav() {\n    this.sideNavState = true;\n    this.sideNavStateSubject.next(this.sideNavState);\n  }\n\n  openRecipientSideNav() {\n    this.recipientSideNavState = true;\n    this.recipientSideNavStateSubject.next(this.recipientSideNavState);\n  }\n\n  closeSideNav() {\n    this.sideNavState = false;\n    this.sideNavStateSubject.next(this.sideNavState);\n    this.initiateAutofocus.next(false);\n  }\n\n  closeRecipientSideNav() {\n    this.recipientSideNavState = false;\n    this.recipientSideNavStateSubject.next(this.recipientSideNavState);\n    this.recipientAutoFocus.next(false);\n  }\n\n  setActiveRole(role) {\n    this.activeRole = role;\n    this.hasActiveRoleSubject.next(true);\n  }\n\n  deleteRole() {\n    if (!!this.activeRole) {\n      this.deleteRoleSubject.next(this.activeRole);\n      this.activeRole = null;\n      this.hasActiveRoleSubject.next(false);\n    }\n  }\n\n  getSideNavState() {\n    return this.sideNavState;\n  }\n\n  getRecipientSideNavState() {\n    return this.recipientSideNavState;\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { v4 as uuid } from 'uuid';\n\nimport {\n  getDefaultHeight,\n  getDefaultWidth,\n  getUIFieldStyling\n} from '../functions/conversion';\n\n@Injectable()\nexport class ConversionService {\n  private ITextWidth = 612;\n  private ITextHeight = 792;\n  private XRatio = 1;\n  private YRatio = 1;\n  private a3Portrait = {\n    x: 842,\n    y: 1191\n  };\n  private a3Landscape = {\n    x: this.a3Portrait.y,\n    y: this.a3Portrait.x\n  };\n  private a4Portrait = {\n    x: 595,\n    y: 842\n  };\n  private a4Landscape = {\n    x: this.a4Portrait.y,\n    y: this.a4Portrait.x\n  };\n  private a5Portrait = {\n    x: 420,\n    y: 595\n  };\n  private a5Landscape = {\n    x: this.a5Portrait.y,\n    y: this.a5Portrait.x\n  };\n  private letterPortrait = {\n    x: 612,\n    y: 792\n  };\n  private letterLandscape = {\n    x: this.letterPortrait.y,\n    y: this.letterPortrait.x\n  }\n  private legalPortrait = {\n    x: 612,\n    y: 1008\n  };\n  private legalLandscape = {\n    x: this.legalPortrait.y,\n    y: this.legalPortrait.x\n  };\n  private portraitSizes = [\n    this.a3Portrait, this.a4Portrait, this.a5Portrait, this.letterPortrait, this.legalPortrait\n  ];\n  private landscapeSizes = [\n    this.a3Landscape, this.a4Landscape, this.a5Landscape, this.letterLandscape, this.legalLandscape\n  ];\n  private rFormWidth = 0;\n  private rFormHeight = 0;\n  private pageCache = [];\n\n  setRValue(width, height) {\n    this.rFormWidth = width;\n    this.rFormHeight = height;\n  }\n\n  setPageCache(pageCache) {\n    this.pageCache = pageCache;\n  }\n\n  get xRatio(): number {\n    return this.XRatio;\n  }\n\n  setXRatio(value: number) {\n    this.XRatio = value;\n  }\n\n  get yRatio(): number {\n    return this.YRatio;\n  }\n\n  setYRatio(value: number) {\n    this.YRatio = value;\n  }\n\n  getRTop(y, fieldHeight, iTextHeight?, yRatio?) {\n    if (!iTextHeight) {\n      iTextHeight = this.ITextHeight;\n    }\n\n    if (!yRatio) {\n      yRatio = this.yRatio;\n    }\n    return iTextHeight - ((y + fieldHeight) * yRatio);\n  }\n\n  getRValue(y, ratio?) {\n    if (!ratio) {\n      ratio = this.yRatio\n    }\n    return y * ratio;\n  }\n\n  getRLeft(x, ratio?) {\n    if (!ratio) {\n      ratio = this.xRatio;\n    }\n    return x * ratio;\n  }\n\n  getITextLeft(x, xRatio) {\n    if (!xRatio) {\n      xRatio = this.xRatio;\n    }\n    return x / xRatio;\n  }\n\n  getITextBottomFromRTop(y, fieldHeight, rFormHeight?, yRatio?) {\n    if (!rFormHeight) {\n      rFormHeight = this.rFormHeight;\n    }\n    const uiHeight = fieldHeight;\n    return (rFormHeight - y - uiHeight);\n  }\n\n  getITextBottom(y) {\n    return y;\n  }\n\n  getDefaultHeight(field) {\n    return getDefaultHeight(field);\n  }\n\n  getDefaultWidth(field) {\n    return getDefaultWidth(field);\n  }\n\n  getUIFieldStyling(field, pageHeight, xRatio?, yRatio?) {\n    if (!xRatio) {\n      xRatio = this.xRatio;\n    }\n    if (!yRatio) {\n      yRatio = this.yRatio;\n    }\n    return getUIFieldStyling(field);\n  }\n\n  getUIFieldSetting(field, x, y, pageHeight) {\n    let setting;\n    if (field.type === 'textbox' || field.type === 'date' || field.type === 'placeholder') {\n      setting = {\n        width: field.setting.width ? field.setting.width : 150,\n        height: field.setting.height ? field.setting.height : 15,\n        x: field.setting.x ? field.setting.x : x,\n        y: this.getITextBottomFromRTop(y, field.setting.height ? field.setting.height : 15, pageHeight)\n      }\n      if (field.type === 'date') {\n        setting.width = 64;\n      }\n    } else if (field.type === 'timestamp') {\n      setting = {\n        width: field.setting.width ? field.setting.width : 64,\n        height: field.setting.height ? field.setting.height : 15,\n        x: field.setting.x ? field.setting.x : x,\n        y: this.getITextBottomFromRTop(y, field.setting.height ? field.setting.height : 15, pageHeight)\n      }\n    } else if (field.type === 'signature' || field.type === 'initial') {\n      setting = {\n        x: field.setting.x ? field.setting.x : x,\n        y: this.getITextBottomFromRTop(y, 36, pageHeight)\n      };\n    } else if (field.type === 'checkbox_group') {\n      setting = {\n        options: [{\n          id: uuid(),\n          x: field.setting.x ? field.setting.x : x,\n          y: this.getITextBottomFromRTop(y, 13.5, pageHeight),\n          checked: false,\n          value: 'Option 1'\n        }]\n      };\n    } else if (field.type === 'radio_button_group') {\n      setting = {\n        options: [{\n          id: uuid(),\n          x: field.setting.x ? field.setting.x : x,\n          y: this.getITextBottomFromRTop(y, 13.5, pageHeight),\n          selected: false,\n          value: 'Option 1'\n        }]\n      };\n    } else if (field.type === 'dropdown') {\n      setting = {\n        x: field.setting.x ? field.setting.x : x,\n        y: this.getITextBottomFromRTop(y, 15, pageHeight),\n        width: field.setting.width ? field.setting.width : 64,\n        height: field.setting.height ? field.setting.height : 15,\n        value: null,\n        placeholder: 'Choose',\n        options: [{\n          id: uuid(),\n          value: 'Option 1'\n        }]\n      };\n    } else if (field.type === 'attachment') {\n      setting = {\n        x: field.setting.x ? field.setting.x : x,\n        y: this.getITextBottomFromRTop(y, 24, pageHeight),\n        label: ''\n      };\n    } else if (field.type === 'payment') {\n      setting = {\n        x: field.setting.x ? field.setting.x : x,\n        y: this.getITextBottomFromRTop(y, 24, pageHeight),\n        account_id: '',\n        currency: 'usd',\n        payment_fee_type: 'static',\n        amount: 1,\n        if_transfer_fee: false\n      }\n    }\n    return setting;\n  }\n\n  updateITextValues(newHeight, newWidth) {\n    this.ITextHeight = newHeight;\n    this.ITextWidth = newWidth;\n  }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { HttpClient, HttpRequest } from '@angular/common/http';\nimport { DocumentsService, FieldData } from '@verdocs/sdk';\nimport { VerdocsStateService } from '@verdocs/tokens';\nimport { BehaviorSubject, ReplaySubject } from 'rxjs';\n\nimport { EssentialsConfig, EssentialsConfigToken } from '../essentials.module';\nimport { dataURLtoBlob } from '../functions/utils';\n\n@Injectable()\nexport class SignatureService {\n  private _config_token: EssentialsConfig;\n  private signatureId: string;\n  private initialId: string;\n  private _rForm_backend_url: string;\n  private envUrl: string;\n  private currentFields: any[];\n  private workingField: FieldData<any> = new FieldData({ order: 0, fName: '' });\n  private signatureBlob: Blob;\n  private initialBlob: Blob;\n  private fields: any[] = [];\n  private _total = -1;\n  private initialImg: any;\n  private workingPayment: any;\n  private rName: string;\n  private recipients: any[];\n\n  public _fields = new ReplaySubject<any[]>();\n  public _recipient = new ReplaySubject<string>();\n  public _showSig = new ReplaySubject<boolean>();\n  public _signedFields = new BehaviorSubject<any>({});\n  public _envId = new ReplaySubject<string>();\n  public _rName = new ReplaySubject<string>();\n  public signImgSubject = new ReplaySubject<any>();\n  public initialImgSubject = new ReplaySubject<any>();\n  public initialIdSubject = new ReplaySubject<string>();\n  public signatureIdSubject = new ReplaySubject<string>();\n  public signedFields: any = {};\n  public signImg: any;\n  public mode = '';\n\n  constructor(\n    private httpClient: HttpClient,\n    private injector: Injector,\n    private envelopeSvc: DocumentsService,\n    private vTokenStateService: VerdocsStateService\n  ) {\n    this._config_token = this.injector.get(EssentialsConfigToken);\n    this._rForm_backend_url = this._config_token.rForm_backend_url;\n    this.envUrl = `${this._rForm_backend_url}/envelopes`\n  }\n\n  setWorkingPayment(payment: any) {\n    this.workingPayment = payment;\n  }\n\n  updateFields(fields: any[]): void {\n    this.fields = fields;\n    this._fields.next(this.fields);\n  }\n\n  postSignatureBlob() {\n    const blobFile = this.signatureBlob;\n    const formData = new FormData();\n    formData.append('signature', blobFile, blobFile['name']);\n    const request = new HttpRequest('POST', this._rForm_backend_url + '/signatures', formData);\n    return this.httpClient.request(request)\n      .toPromise()\n      .then(response => {\n        if (response && response['body']) {\n          return response['body'];\n        } else {\n          console.error('Failed to upload signature image');\n        }\n      });\n  }\n\n  postInitialBlob() {\n    const blobFile = this.initialBlob;\n    const formData = new FormData();\n    formData.append('initial', blobFile, blobFile['name']);\n    const request = new HttpRequest('POST', this._rForm_backend_url + '/initials', formData);\n    return this.httpClient.request(request)\n      .toPromise()\n      .then(response => {\n        if (response && response['body']) {\n          return response['body'];\n        } else {\n          console.error('Failed to upload Initial');\n        }\n      });\n  }\n\n  toggleSig(bool): void {\n    this._showSig.next(bool);\n  }\n\n  setSigId(id): void {\n    this.signatureId = id;\n    this.signatureIdSubject.next(id);\n  }\n\n  setInitialId(id): void {\n    this.initialId = id;\n    this.initialIdSubject.next(id);\n  }\n\n  setSignImg(url) {\n    this.signImg = url;\n    this.signImgSubject.next(this.signImg);\n  }\n\n  getSignImg() {\n    return this.signImg;\n  }\n\n  setInitialImg(url) {\n    this.initialImg = url;\n    this.initialImgSubject.next(this.initialImg);\n  }\n\n  getInitialImg() {\n    return this.initialImg;\n  }\n\n  putSignatureField(envelopeId, fieldName, signatureId) {\n    return new Promise<any>(async (resolve, reject) => {\n      const ipAddress = await this.getPublicIp();\n      this.httpClient\n        .put(this.envUrl + `/${envelopeId}/fields/${fieldName}/signature/${signatureId}`,\n          {\n            ip_address: ipAddress\n          }\n        ).toPromise().then(res => {\n          return resolve(res);\n        })\n    });\n  }\n\n  putInitialField(envelopeId, fieldName, initialId) {\n    return new Promise<any>(async (resolve, reject) => {\n      const ipAddress = await this.getPublicIp();\n      this.httpClient\n        .put(this.envUrl + `/${envelopeId}/fields/${fieldName}/initial/${initialId}`,\n          {\n            ip_address: ipAddress\n          }\n        ).toPromise().then(res => {\n          return resolve(res);\n        })\n    });\n  }\n\n  // refactor it to 4 functions\n  updateEnvelopeField(envelopeId, ifPrepared?: boolean) {\n    if (this.workingField && this.workingField.type) {\n      const result = this.getEnvelopeFieldValue(ifPrepared);\n      this.putEnvelopeField(envelopeId, result);\n    }\n  }\n\n  getEnvelopeFieldValue(isPrepared?: boolean) {\n    if (this.workingField && this.workingField.type) {\n      const result = {\n        value: ''\n      };\n      if (typeof (isPrepared) === 'boolean') {\n        result['prepared'] = isPrepared;\n      }\n      switch (this.workingField.type.toLowerCase()) {\n        case 'textbox':\n        case 'checkbox':\n        case 'date':\n          result.value = this.workingField.value;\n          break;\n        default:\n          break;\n      }\n      return result;\n    }\n    return null;\n  }\n\n  putEnvelopeField(envelopeId, result) {\n    return new Promise<any>((resolve, reject) => {\n      this.httpClient\n        .put(this.envUrl + `/${envelopeId}/fields/${this.workingField.fName}`,\n          result\n        ).toPromise().then(res => {\n          return resolve(res);\n        })\n    });\n  }\n\n  updateGroupedField(envelopeId, body, fieldName, ifPrepared?: boolean) {\n    if (typeof (ifPrepared) === 'boolean') {\n      body['prepared'] = ifPrepared;\n    }\n    return new Promise<any>((resolve, reject) => {\n      this.httpClient\n        .put(this.envUrl + `/${envelopeId}/fields/${fieldName}`,\n          body\n        ).toPromise().then(res => {\n          return resolve(res);\n        })\n    });\n  }\n\n  async prepareEnvelopeField(envelopeId, setPrepared): Promise<boolean> {\n    if (this.workingField && this.workingField.type) {\n      const fieldType = this.workingField.type.toLowerCase();\n      if (fieldType !== 'textbox' && fieldType !== 'date' && fieldType !== 'checkbox') {\n        return false;\n      } else {\n        const fieldResponse: any = await this.updateEnvelopeField(envelopeId, setPrepared);\n        if (fieldResponse) {\n          return fieldResponse.prepared;\n        }\n      }\n    }\n    return false\n  }\n\n  private getPublicIp() {\n    const apiUrl = 'https://api.ipify.org?format=jsonp';\n    const callback = 'callback=JSONP_CALLBACK';\n    return this.httpClient\n      .jsonp(apiUrl, callback)\n      .toPromise()\n      .then((res) => {\n        return res['ip']\n      }).catch((err) => {\n        console.error('Failed to get ip', err)\n        return 'ip_unavailable'\n      });\n  }\n\n  updateCurrentField(\n    fName: string,\n    result: string,\n    vName: string,\n    pageNum: number,\n    id: number,\n    required: boolean,\n    order: number,\n    type: string\n  ) {\n    this.workingField.fName = fName;\n    this.workingField.value = result;\n    this.workingField.pageNum = pageNum;\n    this.workingField.id = id;\n    this.workingField.vName = vName;\n    this.workingField.required = required;\n    this.workingField.order = order;\n    this.workingField.type = type;\n  }\n\n  setCurrentFields(fields: any[]) {\n    this.currentFields = fields;\n  }\n\n  get currField() {\n    return this.workingField;\n  }\n\n  errorMessages(pageNum, id) {\n    return this.currentFields[pageNum][id]['error'];\n  }\n\n  setEnvId(id): void {\n    this._envId.next(id);\n  }\n\n  setrName(role): void {\n    this.rName = role;\n    this._rName.next(role);\n  }\n\n  getSignatureUrl(data) {\n    if (data) {\n      const blob = dataURLtoBlob(data);\n      const url = URL.createObjectURL(blob);\n      return url;\n    }\n    return null;\n  }\n\n  setSignatureData(data) {\n    const blob = dataURLtoBlob(data);\n    const url = URL.createObjectURL(blob);\n    this.signatureBlob = blob;\n    this.setSignImg(url);\n  }\n\n  setInitialData(data) {\n    const blob = dataURLtoBlob(data);\n    const url = URL.createObjectURL(blob);\n    this.initialBlob = blob;\n    this.setInitialImg(url);\n  }\n\n  updateSigned(fName, result) {\n    this.workingField['value'] = 'signed';\n    this.signedFields[fName] = result;\n    this._signedFields.next(this.signedFields);\n  }\n\n  updateInitialed(fName, result) {\n    this.workingField['value'] = 'initialed';\n    this.signedFields[fName] = result;\n    this._signedFields.next(this.signedFields);\n  }\n\n  setSignatureId(id) {\n    this.signatureId = id;\n    this.signatureIdSubject.next(id);\n  }\n\n  setRecipient(recipient: string): void {\n    this._recipient.next(recipient);\n  }\n\n  setTotal(t: number) {\n    this._total = t;\n  }\n\n}\n","import { Injectable } from '@angular/core';\nimport { ReplaySubject } from 'rxjs';\n\nimport { SignatureService } from './envelope-signature.service';\n\n@Injectable()\nexport class EnvelopeViewService {\n  public recipientSubject = new ReplaySubject<any>();\n  public jumpCoordinateSubject = new ReplaySubject<any>();\n  public fieldTypeSubject = new ReplaySubject<string>();\n  public pdfUrlSubject = new ReplaySubject<any>();\n  public pdfBlobSubject = new ReplaySubject<any>();\n  public toggleNextSubject = new ReplaySubject<boolean>();\n  public viewModeSubject = new ReplaySubject<string>();\n  public agreedSubject = new ReplaySubject<boolean>(1, 500);\n  public attachmentsSubject = new ReplaySubject<any[]>();\n  public formValiditySubject = new ReplaySubject<any[]>();\n  public requestFormValiditySubject = new ReplaySubject<boolean>();\n  public mode: string;\n\n  private rName: string;\n\n  constructor(\n    private signatureService: SignatureService\n  ) {\n    this.signatureService._rName.subscribe(role => {\n      this.rName = role;\n    });\n  }\n\n  setMode(mode) {\n    this.mode = mode;\n    this.viewModeSubject.next(this.mode);\n  }\n\n  setSignatureService(signatureService) {\n    this.signatureService = signatureService;\n  }\n\n  requestFormValidity(value: boolean) {\n    this.requestFormValiditySubject.next(value);\n  }\n\n  setFormValidityData(value: any[]) {\n    this.formValiditySubject.next(value);\n  }\n\n  ifBelongsToPreparer(type) {\n    return type === 'textbox' || type === 'date' || type === 'checkbox';\n  }\n\n  ifBelongsToCurrentRecipient(field) {\n    if (this.mode === 'prepareview') {\n      return this.ifBelongsToPreparer(field.controlType);\n    } else {\n      return field.recipientRole === this.rName;\n    }\n  }\n}","import { Inject, PLATFORM_ID, RendererFactory2, ViewEncapsulation, Injector } from '@angular/core';\nimport { isPlatformBrowser, DOCUMENT } from '@angular/common';\nimport { Title, Meta } from '@angular/platform-browser';\nimport { filter, map, switchMap } from 'rxjs/operators';\nimport { ActivatedRoute, Router, NavigationEnd } from '@angular/router';\nimport { VerdocsStateService, VerdocsTokenObjectService } from '@verdocs/tokens';\nimport { EssentialsConfig, EssentialsConfigToken } from '../essentials.module';\n\nenum Robots {\n  Noindex = 'Noindex',\n  Index = 'Index',\n  Follow = 'Follow',\n  Noimageindex = 'Noimageindex',\n  None = 'None',\n  Noarchive = 'Noarchive',\n  Nocache = 'Nocache',\n  Nosnippet = 'Nosnippet'\n}\nexport class PageService {\n  private _config_token: EssentialsConfig;\n  private segmentIsInitialized = false;\n  private lazyTitle = false;\n\n  constructor(\n    private titleService: Title,\n    private injector: Injector,\n    private meta: Meta,\n    private rendererFactory: RendererFactory2,\n    private activatedRoute: ActivatedRoute,\n    private router: Router,\n    private vTokenStateService: VerdocsStateService,\n    private tokenObject: VerdocsTokenObjectService,\n    @Inject(PLATFORM_ID) private platform,\n    @Inject(DOCUMENT) private document\n  ) {\n    this._config_token = this.injector.get(EssentialsConfigToken);\n  }\n\n  inti() {\n    this.initializeSegment();\n    setTimeout(() => {\n      this.additionalSetupForWidgets();\n    }, 500);\n    this.router.events.pipe(\n      filter(event => event instanceof NavigationEnd),\n      map(() => this.activatedRoute),\n      map(route => {\n        let targetRoute = route;\n        while (targetRoute.firstChild) {\n          targetRoute = targetRoute.firstChild;\n        }\n        return targetRoute\n      }),\n      switchMap(route => route.data),\n      map((data) => {\n        this.lazyTitle = data.lazyTitle;\n        return data.title;\n      })\n    ).subscribe((title) => {\n      if (this.lazyTitle) {\n        this.lazyTitle = false;\n      } else {\n        this.setTitleAndRecord(title);\n      }\n    });\n  }\n\n  setTitleAndRecord(title: string, pageName?: string) {\n    let newTitle = 'Verdocs';\n    if (isPlatformBrowser(this.platform)) {\n      if (this.document.cookie.includes(this._config_token.rForm_cookie_name)) {\n        newTitle = title ? title : 'Verdocs'\n        window['analytics'].page(pageName || newTitle);\n      }\n    } else {\n      newTitle = 'Verdocs' + (title ? ` | ${title}` : '')\n    }\n    this.titleService.setTitle(newTitle);\n  }\n\n  setMetaProperty(property, content) {\n    if (!!content) {\n      if (!!this.getMetaTagProperty(property)) {\n        this.meta.updateTag(\n          { property, content },\n          `property=\"${property}\"`\n        );\n      } else {\n        this.meta.addTag(\n          { property, content },\n          true\n        );\n      }\n    } else {\n      if (!!this.getMetaTagProperty(property)) {\n        this.meta.removeTag(`property=â${property}â`);\n      }\n    }\n  }\n\n  setMetaName(property, content) {\n    if (!!content) {\n      if (!!this.getMetaTagProperty(property)) {\n        this.meta.updateTag(\n          { property, content },\n          `name=\"${property}\"`\n        );\n      } else {\n        this.meta.addTag(\n          { property, content },\n          true\n        );\n      }\n    } else {\n      if (!!this.getMetaTagProperty(property)) {\n        this.meta.removeTag(`name=â${property}â`);\n      }\n    }\n  }\n\n  setOpenGraphMeta(type: string, title: string, description: string, image: string, url: string) {\n    if (!!type) {\n      this.setMetaProperty('og:type', type);\n    }\n    if (!!title) {\n      this.setMetaProperty('og:title', title);\n    }\n    if (!!description) {\n      this.setMetaProperty('og:description', description);\n    }\n    if (!!image) {\n      this.setMetaProperty('og:image', image);\n    }\n    if (!!url) {\n      this.setMetaProperty('og:url', url);\n    }\n    if (!!this.getMetaTagProperty('og:site_name')) {\n      return;\n    } else {\n      this.meta.addTag(\n        { property: 'og:site_name', content: 'Verdocs' }\n      )\n    }\n  }\n  setRobotMeta(...robot_values: string[]) {\n    let parameters = '';\n    for (let x = 0; x < robot_values.length; x++) {\n      if (robot_values[x]) {\n        if (x === robot_values.length - 1) {\n          parameters += robot_values[x];\n        } else {\n          parameters += robot_values[x] + \", \"\n        }\n      }\n    }\n    const robot_parameters = parameters;\n    this.setMetaName('robots', robot_parameters);\n  }\n  setCanonicalUrl(tag: LinkDefinition) {\n    if (!tag.href) {\n      tag['href'] = this.document.url;\n    }\n    this.addTag(tag);\n  }\n  setDescriptionMeta(content: string) {\n    if (!!this.getMetaTag('description')) {\n      if (content) {\n        this.meta.updateTag(\n          { name: 'description', content: content },\n          `name='description'`\n        );\n      } else {\n        this.meta.removeTag(`name='description'`);\n      }\n    } else {\n      if (content) {\n        this.meta.addTag(\n          { name: 'description', content: content },\n          true\n        );\n      }\n    }\n  }\n\n  getMetaTag(name: string) {\n    return this.meta.getTag(`name='${name}'`);\n  }\n\n  getMetaTagProperty(property: string) {\n    return this.meta.getTag(`property='${property}'`);\n  }\n\n  private initializeSegment() {\n    if (isPlatformBrowser(this.platform)) {\n      const analytics = window['analytics'];\n      if (document.cookie.includes(this._config_token.rForm_cookie_name)) {\n        const idTokenSubscription = this.vTokenStateService.decodedIdTokenSubject.subscribe(decodedIdToken => {\n          idTokenSubscription.unsubscribe();\n          if (!this.segmentIsInitialized) {\n            this.segmentIsInitialized = true;\n            analytics.reset();\n            const profile = this.tokenObject.getProfile();\n            analytics.identify(decodedIdToken.sub, {\n              userId: decodedIdToken.sub,\n              email: decodedIdToken.email,\n              name: decodedIdToken.name,\n              'Verdoc plan': this.planType('verdoc'),\n              'Organization plan': this.planType('organization'),\n              'Current Profile Id': this.tokenObject.getProfileID(),\n              'Current Company': profile.organization.name,\n              company: {\n                id: profile.organization_id,\n                name: profile.organization.name\n              }\n            }, {\n              Intercom: { hideDefaultLauncher: true }\n            });\n          }\n        });\n      }\n    }\n  }\n\n  robotEnum() {\n    return Robots;\n  }\n\n  private planType(product) {\n    let productName = 'undefined';\n    switch (product) {\n      case 'verdoc':\n        productName = 'env';\n        break;\n      case 'organization':\n        productName = 'org'\n        break;\n    }\n    const plan = this.tokenObject.getPlans().find((p) => {\n      return p.includes(productName);\n    })\n    let planType = 'None';\n    if (plan) {\n      if (productName === 'env') {\n        planType = plan.includes('pro') ? 'Pro' : 'Essential';\n      } else {\n        planType = plan.includes('premium') ? 'Premium' : 'Standard';\n      }\n    }\n    return planType;\n  }\n  addTag(tag: LinkDefinition, forceCreation?: boolean) {\n    \n    const renderer = this.rendererFactory.createRenderer(this.document, {\n      id: '-1',\n      encapsulation: ViewEncapsulation.None,\n      styles: [],\n      data: {}\n    });\n    const link = renderer.createElement('link');\n    const head = this.document.head;\n    const selector = this._parseSelector(tag);\n\n    Object.keys(tag).forEach((prop: string) => {\n      return renderer.setAttribute(link, prop, tag[prop]);\n    });\n    try {\n\n\n      if (head === null) {\n        throw new Error('<head> not found within DOCUMENT.');\n      }\n\n\n      const existingLink = renderer.selectRootElement(selector)\n      if (!!existingLink) {\n        renderer.removeAttribute(existingLink, 'href');\n        renderer.setAttribute(existingLink, 'href', tag['href']);\n      } else {\n        renderer.appendChild(head, link);\n      }\n\n    } catch (e) {\n      // console.error('Error within linkService : ', e);\n      renderer.appendChild(head, link);\n    }\n  }\n\n  private _parseSelector(tag: LinkDefinition): string {\n    const attr: string = tag.rel ? 'rel' : 'hreflang';\n    return `link[${attr}=\"${tag[attr]}\"]`;\n  }\n\n  private additionalSetupForWidgets() {\n    if (isPlatformBrowser(this.platform)) {\n      if (window['Intercom']) {\n        window['Intercom']('onHide', function () {\n          window['intercomIsOpen'] = false;\n        });\n\n        window['Intercom']('onShow', function () {\n          window['intercomIsOpen'] = true;\n        });\n      }\n\n      window['lunchIntercom'] = function () {\n        if (window['Intercom']) {\n          if (window['intercomIsOpen'] && window['intercomIsOpen'] === true) {\n            window['Intercom']('hide');\n          } else {\n            window['Intercom']('show');\n          }\n        } else {\n          console.error('Intercom is not loaded!')\n        }\n      }\n\n      window['lunchElevio'] = function () {\n        if (window['_elev']) {\n          if (window['_elev'].widgetIsOpen()) {\n            window['_elev'].close()\n          } else {\n            window['_elev'].open()\n          }\n        } else {\n          console.error('Elevio is not loaded!')\n        }\n      }\n    }\n  }\n}\n\nexport declare type LinkDefinition = {\n  charset?: string;\n  crossorigin?: string;\n  href?: string;\n  hreflang?: string;\n  media?: string;\n  rel?: string;\n  rev?: string;\n  sizes?: string;\n  target?: string;\n  type?: string;\n} & {\n  [prop: string]: string;\n};\n","import { Injectable } from '@angular/core';\nimport { Subject ,  Observable } from 'rxjs';\nimport { ComponentData } from '@verdocs/sdk';\nimport { find } from 'lodash';\nimport { MatDialogRef } from '@angular/material/dialog';\n\n@Injectable()\nexport class ModalService {\n  private modals: MatDialogRef<any>[] = [];\n  private componentData: any;\n  private subject: Subject<ComponentData> = new Subject<ComponentData>();\n\n  add(modal: any) {\n    this.modals.push(modal);\n  }\n\n  open(id: string) {\n    const modal = find(this.modals, { id: id });\n  }\n\n  close(id: string) {\n    const modal = find(this.modals, { id: id });\n    modal.close();\n  }\n\n  setComponentData(componentData: any) {\n    this.componentData = componentData;\n    this.subject.next(componentData);\n  }\n\n  getComponentData(): Observable<any> {\n    return this.subject.asObservable();\n  }\n}\n","import { Component, OnInit, Injector } from '@angular/core';\nimport { VerdocsTokenObjectService } from '@verdocs/tokens';\nimport { Router } from '@angular/router';\n\nimport { EssentialsConfig, EssentialsConfigToken } from '../../essentials.module';\n\n@Component({\n  selector: 'four-oh-one-dialog',\n  templateUrl: './four-oh-one.dialog.html',\n  styleUrls: ['./four-oh-one.dialog.scss']\n})\nexport class FourOhOneDialog implements OnInit {\n  public error: any = null;\n  public currentProfile: any = null;\n  public error_code: string = null;\n  public error_title: string = null;\n  public error_message: string = null;\n  public rSecureUrl: string;\n  public rFormUrl: string;\n\n  private _config_token: EssentialsConfig;\n\n  constructor(\n    private router: Router,\n    private injector: Injector,\n    private vTokenObjectService: VerdocsTokenObjectService\n  ) {\n    this._config_token = this.injector.get(EssentialsConfigToken);\n    this.rSecureUrl = this._config_token.rSecure_frontend_url;\n    this.rFormUrl = this._config_token.rForm_frontend_url;\n  }\n\n  ngOnInit() {\n    this.currentProfile = this.vTokenObjectService.getProfile();\n    if (this.error && this.error.hasOwnProperty('error')) {\n      this.error_code = this.error.error.code || null;\n      if (this.error_code) {\n        this.prepareErroContent();\n      }\n    }\n  }\n\n  prepareErroContent() {\n    switch (this.error_code) {\n      case 'AUTH0002':\n        this.error_title = 'Authorization key is missing';\n        this.error_message = 'Try after ' + (this.currentProfile ? 'signing in again.' : 'signing in or signing up.');\n        break;\n      case 'T000001':\n        this.error_title = 'This document is not accessible';\n        this.error_message = (this.currentProfile ? 'Try using a different organization/account, ' : 'Try signing in, signing up, ') + 'or requesting access from the owner of this document.';\n        break;\n      case 'AUTH0003':\n        this.error_title = 'Cannot complete your request';\n        this.error_message = 'Try after ' + (this.currentProfile ? 'signing in again.' : 'signing in or signing up.');\n        break;\n      default:\n        this.error_title = 'Your request has been denied.';\n        this.error_message = null;\n        break;\n    }\n  }\n\n  goToDashboard() {\n    this.router.navigate(['/dashboard']);\n  }\n\n  signIn() {\n    if (window) {\n      window.location.href = `${this.rSecureUrl}/login?redirect_url=${this.rFormUrl + this.router.url}`;\n    }\n  }\n\n  signUp() {\n    if (window) {\n      window.location.href = `${this.rSecureUrl}/signup?redirect_url=${this.rFormUrl + this.router.url}`;\n    }\n  }\n}\n","import { Component, OnInit } from '@angular/core'\nimport { Router } from '@angular/router'\nimport { MatDialogRef } from '@angular/material/dialog';\n\n@Component({\n  selector: 'plans-dialog',\n  templateUrl: './plans-dialog.component.html',\n  styleUrls: ['./plans-dialog.component.scss']\n})\nexport class PlansDialog implements OnInit {\n  public redirectUrl: string = null;\n  public type: string = null;\n  public dialogTitle: string = null;\n  public dialogMessage: string = null;\n\n  constructor(\n    private router: Router,\n    private dialog: MatDialogRef<PlansDialog>\n  ) { }\n\n  ngOnInit() {\n    switch (this.type) {\n      case 'free':\n        this.dialogTitle = 'Upgrade to create another document';\n        this.dialogMessage = 'We are glad to see you are drawing value from Verdocs. You have reached your limit of three documents per month with your free account. Please upgrade to an Essentials or Pro subscription to create more documents.';\n        break;\n      case 'essential':\n        this.dialogTitle = 'Upgrade to access this feature';\n        this.dialogMessage = 'This feature requires an essentials subscription or above. Please upgrade to access this feature.';\n        break;\n      case 'pro':\n        this.dialogTitle = 'Upgrade to access this feature';\n        this.dialogMessage = 'This feature requires a pro subscription. Please upgrade to access this feature.';\n        break;\n      default:\n        this.dialog.close();\n        break;\n    }\n  }\n\n  goToBilling() {\n    if (window && !!this.redirectUrl && !!this.type) {\n      window.location.href = (this.redirectUrl);\n    } else {\n      this.dialog.close();\n    }\n  }\n\n  close() {\n    this.dialog.close();\n  }\n}\n","import { Injectable } from '@angular/core';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { FourOhOneDialog } from '../dialogs/error-dialogs/four-oh-one.dialog';\nimport { PlansDialog } from '../dialogs/plan-dialogs/plans-dialog.component';\n\nInjectable()\nexport class ErrorDialogService {\n  constructor(\n    private dialog: MatDialog\n  ) {\n        \n  }\n\n  show401ResponseError(err) {\n    const errorDialog = this.dialog.open(FourOhOneDialog, {\n      panelClass: 'error_dialog',\n      disableClose: true\n    });\n    errorDialog.componentInstance.error = err;\n  }\n\n  showPlansError(type: string, redirect_url: string, dialog_title?: string, dialog_message?: string) {\n    const planErrorDialog = this.dialog.open(PlansDialog, {\n      panelClass: 'error_dialog',\n      disableClose: true\n    });\n    if (type) {\n      planErrorDialog.componentInstance.type = type;\n    }\n    if (redirect_url) {\n      planErrorDialog.componentInstance.type = redirect_url;\n    }\n    if (dialog_title) {\n      planErrorDialog.componentInstance.dialogTitle = dialog_title;\n    }\n    if (dialog_message) {\n      planErrorDialog.componentInstance.dialogMessage = dialog_message;\n    }\n  }\n}\n","import { Injectable, Inject, Injector, PLATFORM_ID } from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\nimport { MatDialog } from '@angular/material/dialog';\n\nimport { PlansDialog } from '../dialogs/plan-dialogs/plans-dialog.component';\nimport { VerdocsStateService } from '@verdocs/tokens';\nimport { EssentialsConfig, EssentialsConfigToken } from '../essentials.module';\n\n@Injectable()\nexport class GuardService {\n  private _config_token: EssentialsConfig;\n  private _plans: {\n    'level-1': string;\n    'level-2': string;\n    'level-3': string;\n  };\n  private _rAccount_frontend_url: string;\n  private _redirectUrl = null;\n\n  constructor(\n    private injector: Injector,\n    private stateService: VerdocsStateService,\n    private dialog: MatDialog,\n    @Inject(PLATFORM_ID) private platform\n  ) {\n    this._config_token = this.injector.get(EssentialsConfigToken);\n    this._plans = this._config_token.plans;\n    this._rAccount_frontend_url = this._config_token.rAccount_frontend_url;\n  }\n\n  checkSubscription(type: string, subscriptionType: string, openDialog: boolean) {\n    const idToken = this.stateService.getIDToken();\n    const userId = this.toTokenObject(idToken)['sub'].slice(6);\n\n    this._redirectUrl = `${this._rAccount_frontend_url}/rAccount/user/${userId}/billing`;\n\n    switch (type) {\n      case 'reminders':\n        if (subscriptionType === this._plans['level-2'] || subscriptionType === this._plans['level-3']) {\n          return true;\n        } else {\n          if (openDialog === true) {\n            const essentialDialog = this.dialog.open(PlansDialog, {\n              panelClass: 'confirmation'\n            });\n            essentialDialog.componentInstance.type = 'essential';\n            essentialDialog.componentInstance.redirectUrl = this._redirectUrl;\n          }\n          return false;\n        }\n      case 'live-link':\n      case 'attachment':\n      case 'payment':\n        if (subscriptionType === this._plans['level-3']) {\n          return true;\n        } else {\n          if (openDialog === true) {\n            const proDialog = this.dialog.open(PlansDialog, {\n              panelClass: 'confirmation'\n            });\n            proDialog.componentInstance.type = 'pro';\n            proDialog.componentInstance.redirectUrl = this._redirectUrl;\n          }\n          return false;\n        }\n      case 'open-free-envelopes':\n        const freeDialog = this.dialog.open(PlansDialog, {\n          panelClass: 'confirmation'\n        });\n        freeDialog.componentInstance.type = 'free';\n        freeDialog.componentInstance.redirectUrl = this._redirectUrl;\n        return false;\n      default:\n        return false;\n    }\n  }\n\n  toTokenObject(accessToken) {\n    if (isPlatformBrowser(this.platform)) {\n      const base64Url = accessToken.split('.')[1];\n      const base64 = base64Url.replace('-', '+').replace('_', '/');\n      return JSON.parse(window.atob(base64));\n    }\n  }\n\n  getHighestEnvelopePlan(plans) {\n    let plan = null;\n    for (let x = 0; x < plans.length; x++) {\n      if (plans[x] === this._plans['level-3']) {\n        plan = plans[x];\n      } else if (plans[x] === this._plans['level-2'] && (plan === null || plan === 'env:free')) {\n        plan = plans[x];\n      } else if (plans[x] === this._plans['level-1'] && plan === null) {\n        plan = plans[x];\n      }\n    }\n    return plan;\n  }\n}\n","import { NgModule, InjectionToken } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { MatDialogModule } from '@angular/material/dialog'\nimport { AngularApiModule } from '@verdocs/sdk';\n\nimport { SnackbarService } from './snackbar/snackbar.service';\nimport { AccountService } from './account/account.service';\nimport { BrowserToiTextService } from './builder/browser-to-iText.service';\nimport { BuilderDataService } from './builder/builder-data.service';\nimport { BuilderService } from './builder/builder-settings.service';\nimport { ConversionService } from './fields/conversion.service';\nimport { SignatureService } from './fields/envelope-signature.service';\nimport { EnvelopeViewService } from './fields/envelope-view.service';\nimport { PageService } from './fields/page.service';\nimport { ModalService } from './modal/modal.service';\nimport { ErrorDialogService } from './error-dialogs/error-dialog.service';\nimport { GuardService } from './guards/guard.service';\n\nimport { FourOhOneDialog } from './dialogs/error-dialogs/four-oh-one.dialog';\nimport { PlansDialog } from './dialogs/plan-dialogs/plans-dialog.component';\n\nexport interface EssentialsConfig {\n  production: boolean;\n  domain: string;\n  rForm_backend_url: string;\n  rForm_frontend_url: string;\n  rSecure_frontend_url: string;\n  rSecure_backend_url: string;\n  rAccount_frontend_url: string;\n  rAccount_backend_url: string;\n  rNotification_backend_url: string;\n  rForm_cookie_name: string;\n  loginURL: string;\n  origin: 'rAccount' | 'rForm';\n  plans: {\n    'level-1': string;\n    'level-2': string;\n    'level-3': string;\n  }\n}\n\nexport const EssentialsConfigToken = new InjectionToken<EssentialsConfig>('EssentialsConfig');\n\n@NgModule({\n  imports: [\n    CommonModule\n  ],\n  providers: [],\n  declarations: [\n    FourOhOneDialog,\n    PlansDialog\n  ]\n})\n// @dynamic\nexport class EssentialsModule {\n\n  static initializeEssentials(config: EssentialsConfig) {\n\n    return {\n      ngModule: EssentialsModule,\n      import: [\n        CommonModule,\n        AngularApiModule.initSDK({\n          production: config.production,\n          domain: config.domain,\n          origin: config.origin,\n          loginURL: config.loginURL,\n          rForm_backend_url: config.rForm_backend_url,\n          rForm_frontend_url: config.rForm_frontend_url,\n          rSecure_backend_url: config.rSecure_backend_url,\n          rSecure_frontend_url: config.rSecure_frontend_url,\n          rAccount_backend_url: config.rAccount_backend_url,\n          rAccount_frontend_url: config.rAccount_frontend_url,\n          rNotification_backend_url: config.rNotification_backend_url,\n          plans: config.plans\n      }),\n      MatDialogModule\n    ], \n      providers: [\n        {\n          provide: EssentialsConfigToken,\n          useValue: config\n        },\n        SnackbarService,\n        AccountService,\n        BrowserToiTextService,\n        BuilderDataService,\n        BuilderService,\n        ConversionService,\n        SignatureService,\n        EnvelopeViewService,\n        PageService,\n        ModalService,\n        ErrorDialogService,\n        GuardService\n      ],\n      declarations: [\n        FourOhOneDialog,\n        PlansDialog\n      ],\n      EntryComponents: [\n        FourOhOneDialog,\n        PlansDialog\n      ],\n      exports: [\n        FourOhOneDialog,\n        PlansDialog\n      ]\n    }\n  }\n}\n","import { Injectable, Injector } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { ReplaySubject } from 'rxjs';\nimport { VerdocsStateService } from '@verdocs/tokens';\nimport { ProfileModel, ProfileCollection } from '@verdocs/profiles';\nimport { EssentialsConfig, EssentialsConfigToken } from '../essentials.module';\n\nimport { findIndex } from 'lodash';\n\n@Injectable()\nexport class AccountService {\n  public userDataSubject = new ReplaySubject<any>();\n  public userProfileSubject = new ReplaySubject<any>();\n  public profileLoadingSubject = new ReplaySubject<boolean>();\n  public currentProfileSubject = new ReplaySubject<any>();\n  public personalAccountSubject = new ReplaySubject<any>();\n  public profilesSubject = new ReplaySubject<any>();\n\n  private _config_token: EssentialsConfig;\n  private userFullname = '';\n  private userInitial = '';\n  private userEmail = '';\n  private userPhone = '';\n  private userData = {\n    name: this.userFullname,\n    initial: null,\n    email: this.userEmail,\n    phone: this.userPhone\n  };\n\n  private profileData: any;\n  private backend_url;\n  private rSecure_backend_url: string;\n  private rForm_backend_url: string;\n  private currentOrganizationId: string = null;\n  \n  constructor(\n    private http: HttpClient,\n    private router: Router,\n    private vTokenStateService: VerdocsStateService,\n    private injector: Injector\n  ) {\n    this._config_token = this.injector.get(EssentialsConfigToken);\n    this.backend_url = this._config_token.rAccount_backend_url;\n    this.rForm_backend_url = this._config_token.rForm_backend_url;\n    this.rSecure_backend_url = this._config_token.rSecure_backend_url;\n  }\n\n  getAccountData() {\n    /***********\n    * Refactor *\n    ***********/\n    // const headerService = this.injector.get(HeaderService);\n    // headerService.noHeader.subscribe(status => {\n      // if (status === false) {\n        this.getProfiles();\n      // }\n    // });\n  }\n\n  getProfiles() {\n    return this.http.get(this.backend_url + '/profiles').toPromise().then((res: any[]) => {\n      const personal = res.splice(findIndex(res, p => p.organization.name === 'realster'), 1);\n      this.personalAccountSubject.next(personal[0]);\n      this.profileData = res.sort((a, b) => {\n        if (a.organization.name < b.organization.name) {\n          return -1;\n        }\n        if (a.organization.name > b.organization.name) {\n          return 1;\n        }\n        return 0;\n      });\n      this.profileData.unshift(personal[0]);\n      const currentIndex = findIndex(this.profileData, { current: true });\n      if (this.profileData[currentIndex]['first_name']) {\n        this.userFullname = this.profileData[currentIndex]['first_name'] + ' ' + this.profileData[currentIndex]['last_name'];\n        this.userInitial = this.profileData[currentIndex]['first_name'].charAt(0) +\n          this.profileData[currentIndex]['last_name'].charAt(0);\n      } else {\n        this.userFullname = '';\n      }\n      if (this.profileData[currentIndex]['phone']) {\n        this.userPhone = this.profileData[currentIndex]['phone'];\n      } else {\n        this.userPhone = '';\n      }\n      if (this.profileData[currentIndex]['email']) {\n        this.userEmail = this.profileData[currentIndex]['email'];\n      }\n      this.userData = {\n        name: this.userFullname,\n        initial: this.userInitial,\n        email: this.userEmail,\n        phone: this.userPhone\n      };\n      this.userProfileSubject.next(this.profileData);\n      const currentProfile = this.profileData[currentIndex];\n      this.currentProfileSubject.next(currentProfile);\n      this.currentOrganizationId = currentProfile.organization_id;\n      this.userDataSubject.next(this.userData);\n      return this.userData;\n    });\n  }\n\n  getProfileCollection(profiles) {\n    const profileModels: ProfileModel[] = [];\n    profiles.forEach(profile => {\n      profileModels.push(new ProfileModel(profile));\n    });\n    const profileCollection = new ProfileCollection(profileModels);\n    return profileCollection;\n  }\n\n  removeFromProfileData(id) {\n    const removeIndex = findIndex(this.profileData, { organization_id: name });\n    if (removeIndex >= 0) {\n      this.profileData.splice(removeIndex, 1);\n      this.userProfileSubject.next(this.profileData);\n    }\n  }\n\n  getAllProfiles() {\n    return this.http.get<any[]>(this.backend_url + '/profiles/').toPromise();\n  }\n\n  switchProfile(profile_id) {\n    this.profileLoadingSubject.next(true);\n    return this.http.post(this.backend_url + '/profiles/' + profile_id + '/switch', null).toPromise().then(async (res: any) => {\n      this.vTokenStateService.setTokens(res.tokens);\n      this.profileLoadingSubject.next(false);\n      return Promise.resolve(res);\n    });\n  }\n\n  async updateTokens(sendMessage?: boolean) {\n    return new Promise((resolve, reject) => {\n      this.vTokenStateService.updateTokens(this.rSecure_backend_url).subscribe(tokens => {\n        if (tokens && tokens.length > 0) {\n          if (sendMessage) {\n            // this.snackbar.dismiss();\n            this.createSnackbar('Status updated');\n          }\n        }\n        this.getAccountData();\n        return resolve();\n      })\n    });\n  }\n\n  resendEmailVerification() {\n    this.http.post(this.rSecure_backend_url + '/user/email_verification', null).toPromise().then(() => {\n      this.createSnackbar('Verification email sent');\n    });\n  }\n  /********************************\n  * replace with snackbar service *\n  ********************************/\n  createSnackbar(message: string) {\n    // let snackbarConfig: MatSnackBarConfig\n    // if (window.innerWidth >= 920) {\n    //   snackbarConfig = {\n    //     verticalPosition: 'bottom',\n    //     horizontalPosition: 'left',\n    //     duration: 5000\n    //   }\n    // } else {\n    //   snackbarConfig = {\n    //     verticalPosition: 'top',\n    //     duration: 5000\n    //   }\n    // }\n    // this.snackbar.open(message, null, snackbarConfig);\n  }\n\n  putAccountData(userData) {\n    if (userData.email) {\n      this.userData.email = userData.email;\n    }\n    if (userData.first_name && userData.last_name) {\n      this.userData.name = userData.first_name + ' ' + userData.last_name;\n      this.userData.initial = userData.first_name.charAt(0) + userData.last_name.charAt(0);\n    }\n    if (userData.phone) {\n      this.userData.phone = userData.phone || '';\n    }\n    this.http.put(this.backend_url + '/profiles/' + userData.id, userData).toPromise().then(() => {\n      this.userDataSubject.next(this.userData);\n    });\n  }\n\n  deleteAccount() {\n    return this.http.delete(this.backend_url).toPromise();\n  }\n\n  changePassword(email, oldPassword, newPassword) {\n    return this.http.put(this.backend_url + 'updatepassword', {\n      email,\n      oldPassword,\n      newPassword\n    }).toPromise();\n  }\n\n  getNameValidity(name) {\n    return this.http.get(this.backend_url + '/organizations/is_valid?name=' + name, this.getOptions())\n      .toPromise()\n      .then(res => {\n        return Promise.resolve(res);\n      });\n  }\n\n  createOrganization(body) {\n    return this.http.post(this.backend_url + '/organizations', body, this.getOptions())\n      .toPromise()\n      .then(res => {\n        return Promise.resolve(res);\n      });\n  }\n\n  private getOptions(): any {\n    const rTokenCookie = this.vTokenStateService.getOtherCookieObject('rAccount_Verdocs');\n    const authValue = 'Bearer ' + rTokenCookie['accessToken'];\n    const headers = new Headers({\n      'Cache-Control': 'no-cache',\n      'Pragma': 'no-cache',\n      'Expires': 'Sat, 01 Jan 2000 00:00:00 GMT',\n      'If-Modified-Since': '0',\n      'Content-Type': 'application/json',\n      'Authorization': authValue,\n      'Accept': 'application/json'\n    });\n    return { 'headers': headers };\n  }\n\n  public fetchToken(id: string, roleName: string, invite: string, redirectReq?: string) {\n    const req = this.rForm_backend_url + `/envelopes/${id}/recipients/${roleName}/invitation/${invite}`;\n    return this.http.get<any>(req, {observe: 'response'}).subscribe(res => {\n      this.vTokenStateService.storeOtherCookie('signer_token', res['headers'].get('signer_token'));\n      if (redirectReq) {\n        this.router.navigate([`/view/sign/${id}/role/${roleName}`], { queryParams: { redirectReq: redirectReq } });\n      } else {\n        this.router.navigate([`/view/sign/${id}/role/${roleName}`]);\n      }\n    }, err => {\n      this.router.navigate([`/view/sign/${id}/role/${roleName}`, { error: err }]);\n    });\n  }\n}\n"]}