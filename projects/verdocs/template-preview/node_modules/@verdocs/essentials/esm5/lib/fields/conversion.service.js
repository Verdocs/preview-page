/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import { Injectable } from '@angular/core';
import { v4 as uuid } from 'uuid';
import { getDefaultHeight, getDefaultWidth, getUIFieldStyling } from '../functions/conversion';
var ConversionService = /** @class */ (function () {
    function ConversionService() {
        this.ITextWidth = 612;
        this.ITextHeight = 792;
        this.XRatio = 1;
        this.YRatio = 1;
        this.a3Portrait = {
            x: 842,
            y: 1191
        };
        this.a3Landscape = {
            x: this.a3Portrait.y,
            y: this.a3Portrait.x
        };
        this.a4Portrait = {
            x: 595,
            y: 842
        };
        this.a4Landscape = {
            x: this.a4Portrait.y,
            y: this.a4Portrait.x
        };
        this.a5Portrait = {
            x: 420,
            y: 595
        };
        this.a5Landscape = {
            x: this.a5Portrait.y,
            y: this.a5Portrait.x
        };
        this.letterPortrait = {
            x: 612,
            y: 792
        };
        this.letterLandscape = {
            x: this.letterPortrait.y,
            y: this.letterPortrait.x
        };
        this.legalPortrait = {
            x: 612,
            y: 1008
        };
        this.legalLandscape = {
            x: this.legalPortrait.y,
            y: this.legalPortrait.x
        };
        this.portraitSizes = [
            this.a3Portrait, this.a4Portrait, this.a5Portrait, this.letterPortrait, this.legalPortrait
        ];
        this.landscapeSizes = [
            this.a3Landscape, this.a4Landscape, this.a5Landscape, this.letterLandscape, this.legalLandscape
        ];
        this.rFormWidth = 0;
        this.rFormHeight = 0;
        this.pageCache = [];
    }
    /**
     * @param {?} width
     * @param {?} height
     * @return {?}
     */
    ConversionService.prototype.setRValue = /**
     * @param {?} width
     * @param {?} height
     * @return {?}
     */
    function (width, height) {
        this.rFormWidth = width;
        this.rFormHeight = height;
    };
    /**
     * @param {?} pageCache
     * @return {?}
     */
    ConversionService.prototype.setPageCache = /**
     * @param {?} pageCache
     * @return {?}
     */
    function (pageCache) {
        this.pageCache = pageCache;
    };
    Object.defineProperty(ConversionService.prototype, "xRatio", {
        get: /**
         * @return {?}
         */
        function () {
            return this.XRatio;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} value
     * @return {?}
     */
    ConversionService.prototype.setXRatio = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        this.XRatio = value;
    };
    Object.defineProperty(ConversionService.prototype, "yRatio", {
        get: /**
         * @return {?}
         */
        function () {
            return this.YRatio;
        },
        enumerable: true,
        configurable: true
    });
    /**
     * @param {?} value
     * @return {?}
     */
    ConversionService.prototype.setYRatio = /**
     * @param {?} value
     * @return {?}
     */
    function (value) {
        this.YRatio = value;
    };
    /**
     * @param {?} y
     * @param {?} fieldHeight
     * @param {?=} iTextHeight
     * @param {?=} yRatio
     * @return {?}
     */
    ConversionService.prototype.getRTop = /**
     * @param {?} y
     * @param {?} fieldHeight
     * @param {?=} iTextHeight
     * @param {?=} yRatio
     * @return {?}
     */
    function (y, fieldHeight, iTextHeight, yRatio) {
        if (!iTextHeight) {
            iTextHeight = this.ITextHeight;
        }
        if (!yRatio) {
            yRatio = this.yRatio;
        }
        return iTextHeight - ((y + fieldHeight) * yRatio);
    };
    /**
     * @param {?} y
     * @param {?=} ratio
     * @return {?}
     */
    ConversionService.prototype.getRValue = /**
     * @param {?} y
     * @param {?=} ratio
     * @return {?}
     */
    function (y, ratio) {
        if (!ratio) {
            ratio = this.yRatio;
        }
        return y * ratio;
    };
    /**
     * @param {?} x
     * @param {?=} ratio
     * @return {?}
     */
    ConversionService.prototype.getRLeft = /**
     * @param {?} x
     * @param {?=} ratio
     * @return {?}
     */
    function (x, ratio) {
        if (!ratio) {
            ratio = this.xRatio;
        }
        return x * ratio;
    };
    /**
     * @param {?} x
     * @param {?} xRatio
     * @return {?}
     */
    ConversionService.prototype.getITextLeft = /**
     * @param {?} x
     * @param {?} xRatio
     * @return {?}
     */
    function (x, xRatio) {
        if (!xRatio) {
            xRatio = this.xRatio;
        }
        return x / xRatio;
    };
    /**
     * @param {?} y
     * @param {?} fieldHeight
     * @param {?=} rFormHeight
     * @param {?=} yRatio
     * @return {?}
     */
    ConversionService.prototype.getITextBottomFromRTop = /**
     * @param {?} y
     * @param {?} fieldHeight
     * @param {?=} rFormHeight
     * @param {?=} yRatio
     * @return {?}
     */
    function (y, fieldHeight, rFormHeight, yRatio) {
        if (!rFormHeight) {
            rFormHeight = this.rFormHeight;
        }
        /** @type {?} */
        var uiHeight = fieldHeight;
        return (rFormHeight - y - uiHeight);
    };
    /**
     * @param {?} y
     * @return {?}
     */
    ConversionService.prototype.getITextBottom = /**
     * @param {?} y
     * @return {?}
     */
    function (y) {
        return y;
    };
    /**
     * @param {?} field
     * @return {?}
     */
    ConversionService.prototype.getDefaultHeight = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        return getDefaultHeight(field);
    };
    /**
     * @param {?} field
     * @return {?}
     */
    ConversionService.prototype.getDefaultWidth = /**
     * @param {?} field
     * @return {?}
     */
    function (field) {
        return getDefaultWidth(field);
    };
    /**
     * @param {?} field
     * @param {?} pageHeight
     * @param {?=} xRatio
     * @param {?=} yRatio
     * @return {?}
     */
    ConversionService.prototype.getUIFieldStyling = /**
     * @param {?} field
     * @param {?} pageHeight
     * @param {?=} xRatio
     * @param {?=} yRatio
     * @return {?}
     */
    function (field, pageHeight, xRatio, yRatio) {
        if (!xRatio) {
            xRatio = this.xRatio;
        }
        if (!yRatio) {
            yRatio = this.yRatio;
        }
        return getUIFieldStyling(field);
    };
    /**
     * @param {?} field
     * @param {?} x
     * @param {?} y
     * @param {?} pageHeight
     * @return {?}
     */
    ConversionService.prototype.getUIFieldSetting = /**
     * @param {?} field
     * @param {?} x
     * @param {?} y
     * @param {?} pageHeight
     * @return {?}
     */
    function (field, x, y, pageHeight) {
        /** @type {?} */
        var setting;
        if (field.type === 'textbox' || field.type === 'date' || field.type === 'placeholder') {
            setting = {
                width: field.setting.width ? field.setting.width : 150,
                height: field.setting.height ? field.setting.height : 15,
                x: field.setting.x ? field.setting.x : x,
                y: this.getITextBottomFromRTop(y, field.setting.height ? field.setting.height : 15, pageHeight)
            };
            if (field.type === 'date') {
                setting.width = 64;
            }
        }
        else if (field.type === 'timestamp') {
            setting = {
                width: field.setting.width ? field.setting.width : 64,
                height: field.setting.height ? field.setting.height : 15,
                x: field.setting.x ? field.setting.x : x,
                y: this.getITextBottomFromRTop(y, field.setting.height ? field.setting.height : 15, pageHeight)
            };
        }
        else if (field.type === 'signature' || field.type === 'initial') {
            setting = {
                x: field.setting.x ? field.setting.x : x,
                y: this.getITextBottomFromRTop(y, 36, pageHeight)
            };
        }
        else if (field.type === 'checkbox_group') {
            setting = {
                options: [{
                        id: uuid(),
                        x: field.setting.x ? field.setting.x : x,
                        y: this.getITextBottomFromRTop(y, 13.5, pageHeight),
                        checked: false,
                        value: 'Option 1'
                    }]
            };
        }
        else if (field.type === 'radio_button_group') {
            setting = {
                options: [{
                        id: uuid(),
                        x: field.setting.x ? field.setting.x : x,
                        y: this.getITextBottomFromRTop(y, 13.5, pageHeight),
                        selected: false,
                        value: 'Option 1'
                    }]
            };
        }
        else if (field.type === 'dropdown') {
            setting = {
                x: field.setting.x ? field.setting.x : x,
                y: this.getITextBottomFromRTop(y, 15, pageHeight),
                width: field.setting.width ? field.setting.width : 64,
                height: field.setting.height ? field.setting.height : 15,
                value: null,
                placeholder: 'Choose',
                options: [{
                        id: uuid(),
                        value: 'Option 1'
                    }]
            };
        }
        else if (field.type === 'attachment') {
            setting = {
                x: field.setting.x ? field.setting.x : x,
                y: this.getITextBottomFromRTop(y, 24, pageHeight),
                label: ''
            };
        }
        else if (field.type === 'payment') {
            setting = {
                x: field.setting.x ? field.setting.x : x,
                y: this.getITextBottomFromRTop(y, 24, pageHeight),
                account_id: '',
                currency: 'usd',
                payment_fee_type: 'static',
                amount: 1,
                if_transfer_fee: false
            };
        }
        return setting;
    };
    /**
     * @param {?} newHeight
     * @param {?} newWidth
     * @return {?}
     */
    ConversionService.prototype.updateITextValues = /**
     * @param {?} newHeight
     * @param {?} newWidth
     * @return {?}
     */
    function (newHeight, newWidth) {
        this.ITextHeight = newHeight;
        this.ITextWidth = newWidth;
    };
    ConversionService.decorators = [
        { type: Injectable }
    ];
    return ConversionService;
}());
export { ConversionService };
if (false) {
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.ITextWidth;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.ITextHeight;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.XRatio;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.YRatio;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.a3Portrait;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.a3Landscape;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.a4Portrait;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.a4Landscape;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.a5Portrait;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.a5Landscape;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.letterPortrait;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.letterLandscape;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.legalPortrait;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.legalLandscape;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.portraitSizes;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.landscapeSizes;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.rFormWidth;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.rFormHeight;
    /**
     * @type {?}
     * @private
     */
    ConversionService.prototype.pageCache;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udmVyc2lvbi5zZXJ2aWNlLmpzIiwic291cmNlUm9vdCI6Im5nOi8vQHZlcmRvY3MvZXNzZW50aWFscy8iLCJzb3VyY2VzIjpbImxpYi9maWVsZHMvY29udmVyc2lvbi5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzNDLE9BQU8sRUFBRSxFQUFFLElBQUksSUFBSSxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBRWxDLE9BQU8sRUFDTCxnQkFBZ0IsRUFDaEIsZUFBZSxFQUNmLGlCQUFpQixFQUNsQixNQUFNLHlCQUF5QixDQUFDO0FBRWpDO0lBQUE7UUFFVSxlQUFVLEdBQUcsR0FBRyxDQUFDO1FBQ2pCLGdCQUFXLEdBQUcsR0FBRyxDQUFDO1FBQ2xCLFdBQU0sR0FBRyxDQUFDLENBQUM7UUFDWCxXQUFNLEdBQUcsQ0FBQyxDQUFDO1FBQ1gsZUFBVSxHQUFHO1lBQ25CLENBQUMsRUFBRSxHQUFHO1lBQ04sQ0FBQyxFQUFFLElBQUk7U0FDUixDQUFDO1FBQ00sZ0JBQVcsR0FBRztZQUNwQixDQUFDLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1lBQ3BCLENBQUMsRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFDLENBQUM7U0FDckIsQ0FBQztRQUNNLGVBQVUsR0FBRztZQUNuQixDQUFDLEVBQUUsR0FBRztZQUNOLENBQUMsRUFBRSxHQUFHO1NBQ1AsQ0FBQztRQUNNLGdCQUFXLEdBQUc7WUFDcEIsQ0FBQyxFQUFFLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztZQUNwQixDQUFDLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO1NBQ3JCLENBQUM7UUFDTSxlQUFVLEdBQUc7WUFDbkIsQ0FBQyxFQUFFLEdBQUc7WUFDTixDQUFDLEVBQUUsR0FBRztTQUNQLENBQUM7UUFDTSxnQkFBVyxHQUFHO1lBQ3BCLENBQUMsRUFBRSxJQUFJLENBQUMsVUFBVSxDQUFD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QUFDOztnQkEvTkYsVUFBVTs7SUFnT1gsd0JBQUM7Q0FBQSxBQWhPRCxJQWdPQztTQS9OWSxpQkFBaUI7Ozs7OztJQUM1Qix1Q0FBeUI7Ozs7O0lBQ3pCLHdDQUEwQjs7Ozs7SUFDMUIsbUNBQW1COzs7OztJQUNuQixtQ0FBbUI7Ozs7O0lBQ25CLHVDQUdFOzs7OztJQUNGLHdDQUdFOzs7OztJQUNGLHVDQUdFOzs7OztJQUNGLHdDQUdFOzs7OztJQUNGLHVDQUdFOzs7OztJQUNGLHdDQUdFOzs7OztJQUNGLDJDQUdFOzs7OztJQUNGLDRDQUdDOzs7OztJQUNELDBDQUdFOzs7OztJQUNGLDJDQUdFOzs7OztJQUNGLDBDQUVFOzs7OztJQUNGLDJDQUVFOzs7OztJQUNGLHVDQUF1Qjs7Ozs7SUFDdkIsd0NBQXdCOzs7OztJQUN4QixzQ0FBdUIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBJbmplY3RhYmxlIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyB2NCBhcyB1dWlkIH0gZnJvbSAndXVpZCc7XG5cbmltcG9ydCB7XG4gIGdldERlZmF1bHRIZWlnaHQsXG4gIGdldERlZmF1bHRXaWR0aCxcbiAgZ2V0VUlGaWVsZFN0eWxpbmdcbn0gZnJvbSAnLi4vZnVuY3Rpb25zL2NvbnZlcnNpb24nO1xuXG5ASW5qZWN0YWJsZSgpXG5leHBvcnQgY2xhc3MgQ29udmVyc2lvblNlcnZpY2Uge1xuICBwcml2YXRlIElUZXh0V2lkdGggPSA2MTI7XG4gIHByaXZhdGUgSVRleHRIZWlnaHQgPSA3OTI7XG4gIHByaXZhdGUgWFJhdGlvID0gMTtcbiAgcHJpdmF0ZSBZUmF0aW8gPSAxO1xuICBwcml2YXRlIGEzUG9ydHJhaXQgPSB7XG4gICAgeDogODQyLFxuICAgIHk6IDExOTFcbiAgfTtcbiAgcHJpdmF0ZSBhM0xhbmRzY2FwZSA9IHtcbiAgICB4OiB0aGlzLmEzUG9ydHJhaXQueSxcbiAgICB5OiB0aGlzLmEzUG9ydHJhaXQueFxuICB9O1xuICBwcml2YXRlIGE0UG9ydHJhaXQgPSB7XG4gICAgeDogNTk1LFxuICAgIHk6IDg0MlxuICB9O1xuICBwcml2YXRlIGE0TGFuZHNjYXBlID0ge1xuICAgIHg6IHRoaXMuYTRQb3J0cmFpdC55LFxuICAgIHk6IHRoaXMuYTRQb3J0cmFpdC54XG4gIH07XG4gIHByaXZhdGUgYTVQb3J0cmFpdCA9IHtcbiAgICB4OiA0MjAsXG4gICAgeTogNTk1XG4gIH07XG4gIHByaXZhdGUgYTVMYW5kc2NhcGUgPSB7XG4gICAgeDogdGhpcy5hNVBvcnRyYWl0LnksXG4gICAgeTogdGhpcy5hNVBvcnRyYWl0LnhcbiAgfTtcbiAgcHJpdmF0ZSBsZXR0ZXJQb3J0cmFpdCA9IHtcbiAgICB4OiA2MTIsXG4gICAgeTogNzkyXG4gIH07XG4gIHByaXZhdGUgbGV0dGVyTGFuZHNjYXBlID0ge1xuICAgIHg6IHRoaXMubGV0dGVyUG9ydHJhaXQueSxcbiAgICB5OiB0aGlzLmxldHRlclBvcnRyYWl0LnhcbiAgfVxuICBwcml2YXRlIGxlZ2FsUG9ydHJhaXQgPSB7XG4gICAgeDogNjEyLFxuICAgIHk6IDEwMDhcbiAgfTtcbiAgcHJpdmF0ZSBsZWdhbExhbmRzY2FwZSA9IHtcbiAgICB4OiB0aGlzLmxlZ2FsUG9ydHJhaXQueSxcbiAgICB5OiB0aGlzLmxlZ2FsUG9ydHJhaXQueFxuICB9O1xuICBwcml2YXRlIHBvcnRyYWl0U2l6ZXMgPSBbXG4gICAgdGhpcy5hM1BvcnRyYWl0LCB0aGlzLmE0UG9ydHJhaXQsIHRoaXMuYTVQb3J0cmFpdCwgdGhpcy5sZXR0ZXJQb3J0cmFpdCwgdGhpcy5sZWdhbFBvcnRyYWl0XG4gIF07XG4gIHByaXZhdGUgbGFuZHNjYXBlU2l6ZXMgPSBbXG4gICAgdGhpcy5hM0xhbmRzY2FwZSwgdGhpcy5hNExhbmRzY2FwZSwgdGhpcy5hNUxhbmRzY2FwZSwgdGhpcy5sZXR0ZXJMYW5kc2NhcGUsIHRoaXMubGVnYWxMYW5kc2NhcGVcbiAgXTtcbiAgcHJpdmF0ZSByRm9ybVdpZHRoID0gMDtcbiAgcHJpdmF0ZSByRm9ybUhlaWdodCA9IDA7XG4gIHByaXZhdGUgcGFnZUNhY2hlID0gW107XG5cbiAgc2V0UlZhbHVlKHdpZHRoLCBoZWlnaHQpIHtcbiAgICB0aGlzLnJGb3JtV2lkdGggPSB3aWR0aDtcbiAgICB0aGlzLnJGb3JtSGVpZ2h0ID0gaGVpZ2h0O1xuICB9XG5cbiAgc2V0UGFnZUNhY2hlKHBhZ2VDYWNoZSkge1xuICAgIHRoaXMucGFnZUNhY2hlID0gcGFnZUNhY2hlO1xuICB9XG5cbiAgZ2V0IHhSYXRpbygpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLlhSYXRpbztcbiAgfVxuXG4gIHNldFhSYXRpbyh2YWx1ZTogbnVtYmVyKSB7XG4gICAgdGhpcy5YUmF0aW8gPSB2YWx1ZTtcbiAgfVxuXG4gIGdldCB5UmF0aW8oKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5ZUmF0aW87XG4gIH1cblxuICBzZXRZUmF0aW8odmFsdWU6IG51bWJlcikge1xuICAgIHRoaXMuWVJhdGlvID0gdmFsdWU7XG4gIH1cblxuICBnZXRSVG9wKHksIGZpZWxkSGVpZ2h0LCBpVGV4dEhlaWdodD8sIHlSYXRpbz8pIHtcbiAgICBpZiAoIWlUZXh0SGVpZ2h0KSB7XG4gICAgICBpVGV4dEhlaWdodCA9IHRoaXMuSVRleHRIZWlnaHQ7XG4gICAgfVxuXG4gICAgaWYgKCF5UmF0aW8pIHtcbiAgICAgIHlSYXRpbyA9IHRoaXMueVJhdGlvO1xuICAgIH1cbiAgICByZXR1cm4gaVRleHRIZWlnaHQgLSAoKHkgKyBmaWVsZEhlaWdodCkgKiB5UmF0aW8pO1xuICB9XG5cbiAgZ2V0UlZhbHVlKHksIHJhdGlvPykge1xuICAgIGlmICghcmF0aW8pIHtcbiAgICAgIHJhdGlvID0gdGhpcy55UmF0aW9cbiAgICB9XG4gICAgcmV0dXJuIHkgKiByYXRpbztcbiAgfVxuXG4gIGdldFJMZWZ0KHgsIHJhdGlvPykge1xuICAgIGlmICghcmF0aW8pIHtcbiAgICAgIHJhdGlvID0gdGhpcy54UmF0aW87XG4gICAgfVxuICAgIHJldHVybiB4ICogcmF0aW87XG4gIH1cblxuICBnZXRJVGV4dExlZnQoeCwgeFJhdGlvKSB7XG4gICAgaWYgKCF4UmF0aW8pIHtcbiAgICAgIHhSYXRpbyA9IHRoaXMueFJhdGlvO1xuICAgIH1cbiAgICByZXR1cm4geCAvIHhSYXRpbztcbiAgfVxuXG4gIGdldElUZXh0Qm90dG9tRnJvbVJUb3AoeSwgZmllbGRIZWlnaHQsIHJGb3JtSGVpZ2h0PywgeVJhdGlvPykge1xuICAgIGlmICghckZvcm1IZWlnaHQpIHtcbiAgICAgIHJGb3JtSGVpZ2h0ID0gdGhpcy5yRm9ybUhlaWdodDtcbiAgICB9XG4gICAgY29uc3QgdWlIZWlnaHQgPSBmaWVsZEhlaWdodDtcbiAgICByZXR1cm4gKHJGb3JtSGVpZ2h0IC0geSAtIHVpSGVpZ2h0KTtcbiAgfVxuXG4gIGdldElUZXh0Qm90dG9tKHkpIHtcbiAgICByZXR1cm4geTtcbiAgfVxuXG4gIGdldERlZmF1bHRIZWlnaHQoZmllbGQpIHtcbiAgICByZXR1cm4gZ2V0RGVmYXVsdEhlaWdodChmaWVsZCk7XG4gIH1cblxuICBnZXREZWZhdWx0V2lkdGgoZmllbGQpIHtcbiAgICByZXR1cm4gZ2V0RGVmYXVsdFdpZHRoKGZpZWxkKTtcbiAgfVxuXG4gIGdldFVJRmllbGRTdHlsaW5nKGZpZWxkLCBwYWdlSGVpZ2h0LCB4UmF0aW8/LCB5UmF0aW8/KSB7XG4gICAgaWYgKCF4UmF0aW8pIHtcbiAgICAgIHhSYXRpbyA9IHRoaXMueFJhdGlvO1xuICAgIH1cbiAgICBpZiAoIXlSYXRpbykge1xuICAgICAgeVJhdGlvID0gdGhpcy55UmF0aW87XG4gICAgfVxuICAgIHJldHVybiBnZXRVSUZpZWxkU3R5bGluZyhmaWVsZCk7XG4gIH1cblxuICBnZXRVSUZpZWxkU2V0dGluZyhmaWVsZCwgeCwgeSwgcGFnZUhlaWdodCkge1xuICAgIGxldCBzZXR0aW5nO1xuICAgIGlmIChmaWVsZC50eXBlID09PSAndGV4dGJveCcgfHwgZmllbGQudHlwZSA9PT0gJ2RhdGUnIHx8IGZpZWxkLnR5cGUgPT09ICdwbGFjZWhvbGRlcicpIHtcbiAgICAgIHNldHRpbmcgPSB7XG4gICAgICAgIHdpZHRoOiBmaWVsZC5zZXR0aW5nLndpZHRoID8gZmllbGQuc2V0dGluZy53aWR0aCA6IDE1MCxcbiAgICAgICAgaGVpZ2h0OiBmaWVsZC5zZXR0aW5nLmhlaWdodCA/IGZpZWxkLnNldHRpbmcuaGVpZ2h0IDogMTUsXG4gICAgICAgIHg6IGZpZWxkLnNldHRpbmcueCA/IGZpZWxkLnNldHRpbmcueCA6IHgsXG4gICAgICAgIHk6IHRoaXMuZ2V0SVRleHRCb3R0b21Gcm9tUlRvcCh5LCBmaWVsZC5zZXR0aW5nLmhlaWdodCA/IGZpZWxkLnNldHRpbmcuaGVpZ2h0IDogMTUsIHBhZ2VIZWlnaHQpXG4gICAgICB9XG4gICAgICBpZiAoZmllbGQudHlwZSA9PT0gJ2RhdGUnKSB7XG4gICAgICAgIHNldHRpbmcud2lkdGggPSA2NDtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGZpZWxkLnR5cGUgPT09ICd0aW1lc3RhbXAnKSB7XG4gICAgICBzZXR0aW5nID0ge1xuICAgICAgICB3aWR0aDogZmllbGQuc2V0dGluZy53aWR0aCA/IGZpZWxkLnNldHRpbmcud2lkdGggOiA2NCxcbiAgICAgICAgaGVpZ2h0OiBmaWVsZC5zZXR0aW5nLmhlaWdodCA/IGZpZWxkLnNldHRpbmcuaGVpZ2h0IDogMTUsXG4gICAgICAgIHg6IGZpZWxkLnNldHRpbmcueCA/IGZpZWxkLnNldHRpbmcueCA6IHgsXG4gICAgICAgIHk6IHRoaXMuZ2V0SVRleHRCb3R0b21Gcm9tUlRvcCh5LCBmaWVsZC5zZXR0aW5nLmhlaWdodCA/IGZpZWxkLnNldHRpbmcuaGVpZ2h0IDogMTUsIHBhZ2VIZWlnaHQpXG4gICAgICB9XG4gICAgfSBlbHNlIGlmIChmaWVsZC50eXBlID09PSAnc2lnbmF0dXJlJyB8fCBmaWVsZC50eXBlID09PSAnaW5pdGlhbCcpIHtcbiAgICAgIHNldHRpbmcgPSB7XG4gICAgICAgIHg6IGZpZWxkLnNldHRpbmcueCA/IGZpZWxkLnNldHRpbmcueCA6IHgsXG4gICAgICAgIHk6IHRoaXMuZ2V0SVRleHRCb3R0b21Gcm9tUlRvcCh5LCAzNiwgcGFnZUhlaWdodClcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmIChmaWVsZC50eXBlID09PSAnY2hlY2tib3hfZ3JvdXAnKSB7XG4gICAgICBzZXR0aW5nID0ge1xuICAgICAgICBvcHRpb25zOiBbe1xuICAgICAgICAgIGlkOiB1dWlkKCksXG4gICAgICAgICAgeDogZmllbGQuc2V0dGluZy54ID8gZmllbGQuc2V0dGluZy54IDogeCxcbiAgICAgICAgICB5OiB0aGlzLmdldElUZXh0Qm90dG9tRnJvbVJUb3AoeSwgMTMuNSwgcGFnZUhlaWdodCksXG4gICAgICAgICAgY2hlY2tlZDogZmFsc2UsXG4gICAgICAgICAgdmFsdWU6ICdPcHRpb24gMSdcbiAgICAgICAgfV1cbiAgICAgIH07XG4gICAgfSBlbHNlIGlmIChmaWVsZC50eXBlID09PSAncmFkaW9fYnV0dG9uX2dyb3VwJykge1xuICAgICAgc2V0dGluZyA9IHtcbiAgICAgICAgb3B0aW9uczogW3tcbiAgICAgICAgICBpZDogdXVpZCgpLFxuICAgICAgICAgIHg6IGZpZWxkLnNldHRpbmcueCA/IGZpZWxkLnNldHRpbmcueCA6IHgsXG4gICAgICAgICAgeTogdGhpcy5nZXRJVGV4dEJvdHRvbUZyb21SVG9wKHksIDEzLjUsIHBhZ2VIZWlnaHQpLFxuICAgICAgICAgIHNlbGVjdGVkOiBmYWxzZSxcbiAgICAgICAgICB2YWx1ZTogJ09wdGlvbiAxJ1xuICAgICAgICB9XVxuICAgICAgfTtcbiAgICB9IGVsc2UgaWYgKGZpZWxkLnR5cGUgPT09ICdkcm9wZG93bicpIHtcbiAgICAgIHNldHRpbmcgPSB7XG4gICAgICAgIHg6IGZpZWxkLnNldHRpbmcueCA/IGZpZWxkLnNldHRpbmcueCA6IHgsXG4gICAgICAgIHk6IHRoaXMuZ2V0SVRleHRCb3R0b21Gcm9tUlRvcCh5LCAxNSwgcGFnZUhlaWdodCksXG4gICAgICAgIHdpZHRoOiBmaWVsZC5zZXR0aW5nLndpZHRoID8gZmllbGQuc2V0dGluZy53aWR0aCA6IDY0LFxuICAgICAgICBoZWlnaHQ6IGZpZWxkLnNldHRpbmcuaGVpZ2h0ID8gZmllbGQuc2V0dGluZy5oZWlnaHQgOiAxNSxcbiAgICAgICAgdmFsdWU6IG51bGwsXG4gICAgICAgIHBsYWNlaG9sZGVyOiAnQ2hvb3NlJyxcbiAgICAgICAgb3B0aW9uczogW3tcbiAgICAgICAgICBpZDogdXVpZCgpLFxuICAgICAgICAgIHZhbHVlOiAnT3B0aW9uIDEnXG4gICAgICAgIH1dXG4gICAgICB9O1xuICAgIH0gZWxzZSBpZiAoZmllbGQudHlwZSA9PT0gJ2F0dGFjaG1lbnQnKSB7XG4gICAgICBzZXR0aW5nID0ge1xuICAgICAgICB4OiBmaWVsZC5zZXR0aW5nLnggPyBmaWVsZC5zZXR0aW5nLnggOiB4LFxuICAgICAgICB5OiB0aGlzLmdldElUZXh0Qm90dG9tRnJvbVJUb3AoeSwgMjQsIHBhZ2VIZWlnaHQpLFxuICAgICAgICBsYWJlbDogJydcbiAgICAgIH07XG4gICAgfSBlbHNlIGlmIChmaWVsZC50eXBlID09PSAncGF5bWVudCcpIHtcbiAgICAgIHNldHRpbmcgPSB7XG4gICAgICAgIHg6IGZpZWxkLnNldHRpbmcueCA/IGZpZWxkLnNldHRpbmcueCA6IHgsXG4gICAgICAgIHk6IHRoaXMuZ2V0SVRleHRCb3R0b21Gcm9tUlRvcCh5LCAyNCwgcGFnZUhlaWdodCksXG4gICAgICAgIGFjY291bnRfaWQ6ICcnLFxuICAgICAgICBjdXJyZW5jeTogJ3VzZCcsXG4gICAgICAgIHBheW1lbnRfZmVlX3R5cGU6ICdzdGF0aWMnLFxuICAgICAgICBhbW91bnQ6IDEsXG4gICAgICAgIGlmX3RyYW5zZmVyX2ZlZTogZmFsc2VcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHNldHRpbmc7XG4gIH1cblxuICB1cGRhdGVJVGV4dFZhbHVlcyhuZXdIZWlnaHQsIG5ld1dpZHRoKSB7XG4gICAgdGhpcy5JVGV4dEhlaWdodCA9IG5ld0hlaWdodDtcbiAgICB0aGlzLklUZXh0V2lkdGggPSBuZXdXaWR0aDtcbiAgfVxufVxuIl19