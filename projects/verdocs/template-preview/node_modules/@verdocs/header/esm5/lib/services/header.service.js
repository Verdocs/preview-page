/**
 * @fileoverview added by tsickle
 * @suppress {checkTypes,constantProperty,extraRequire,missingOverride,missingReturn,unusedPrivateMembers,uselessCode} checked by tsc
 */
import * as tslib_1 from "tslib";
import { Injectable, Injector, Inject, PLATFORM_ID } from '@angular/core';
import { isPlatformServer, isPlatformBrowser } from '@angular/common';
import { HttpClient, HttpResponse, HttpRequest, HttpHeaders } from '@angular/common/http';
import { Router } from '@angular/router';
import { MatSnackBar } from '@angular/material/snack-bar';
import { MatDialog } from '@angular/material/dialog';
import { ReplaySubject, Subject, BehaviorSubject, EMPTY } from 'rxjs';
import { map, catchError } from 'rxjs/operators';
import { findIndex, filter } from 'lodash';
import { saveAs } from 'file-saver';
import { ProfileModel, ProfileCollection } from '@verdocs/profiles';
import { VerdocsStateService, VerdocsTokenObjectService } from '@verdocs/tokens';
import { connectionConfigToken } from '../header.module';
import { TemplatesGuardService } from './templates.guard';
import { TemplateActions } from '../models/verdocs.model';
import { FourOhOneDialog } from '../error-dialogs/four-oh-one.dialog';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "@angular/router";
import * as i3 from "@angular/material/snack-bar";
import * as i4 from "@angular/material/dialog";
import * as i5 from "./templates.guard";
import * as i6 from "@verdocs/tokens";
var VerdocsHeaderService = /** @class */ (function () {
    function VerdocsHeaderService(injector, http, router, snackbar, dialog, templateGuard, vTokenStateService, vTokenObjectService, platform) {
        this.injector = injector;
        this.http = http;
        this.router = router;
        this.snackbar = snackbar;
        this.dialog = dialog;
        this.templateGuard = templateGuard;
        this.vTokenStateService = vTokenStateService;
        this.vTokenObjectService = vTokenObjectService;
        this.platform = platform;
        this.titleSubject = new ReplaySubject();
        this.csvBlobSubject = new ReplaySubject();
        this.templates = new Subject();
        this.saveStatusSubject = new ReplaySubject();
        this.templateDetailToggleSubject = new Subject();
        this.profileLoadingSubject = new ReplaySubject();
        this.templateSubject = new Subject();
        this.allEnvelopes = new BehaviorSubject([]);
        this.sideNavStateSubject = new ReplaySubject();
        this.initiateBuilderAutofocus = new ReplaySubject();
        this.createToggleSubscription = new Subject();
        this._toggleSidenavSource = new BehaviorSubject(false);
        this._title = new BehaviorSubject('');
        this._selected = new BehaviorSubject(false);
        this._pdfUrl = new BehaviorSubject('');
        this._env = new BehaviorSubject({
            id: '',
            template_id: '',
            status: '',
            user_id: '',
            envelope_document_id: ''
        });
        this._envDoc = new BehaviorSubject({
            id: '',
            url: '',
            name: '',
            page_numbers: 0,
            mime: '',
        });
        this.userFullname = '';
        this.userInitial = '';
        this.userEmail = '';
        this.userPhone = '';
        this.userData = {
            name: this.userFullname,
            initial: null,
            email: this.userEmail,
            phone: this.userPhone
        };
        this.isAtOrigin = false;
        this.currentOrganizationId = null;
        this.sidenavOpened = false;
        this.toggleSidenav$ = this._toggleSidenavSource.asObservable();
        this.selectStatus$ = this._selected.asObservable();
        this.env$ = this._env.asObservable();
        this.titleValue$ = this._title.asObservable();
        this.pdfUrl$ = this._pdfUrl.asObservable();
        this.envDoc$ = this._envDoc.asObservable();
        this.userDataSubject = new ReplaySubject();
        this.userProfileSubject = new ReplaySubject();
        this.currentProfileSubject = new ReplaySubject();
        this.personalAccountSubject = new ReplaySubject();
        this.profilesSubject = new ReplaySubject();
        this.tokenConfig = this.injector.get(connectionConfigToken);
        this.envUrl = this.tokenConfig.rForm_backend_url + '/envelopes';
        this.rForm_url = this.tokenConfig.rForm_frontend_url;
        this.rAccount_url = this.tokenConfig.rAccount_frontend_url;
        this.rSecure_url = this.tokenConfig.rSecure_frontend_url;
    }
    /**
     * @param {?} originType
     * @return {?}
     */
    VerdocsHeaderService.prototype.getAtOrigin = /**
     * @param {?} originType
     * @return {?}
     */
    function (originType) {
        this.isAtOrigin = originType && this.tokenConfig.origin && originType === this.tokenConfig.origin;
        return this.isAtOrigin;
    };
    /**
     * @param {?} bool
     * @return {?}
     */
    VerdocsHeaderService.prototype.toggleSidenav = /**
     * @param {?} bool
     * @return {?}
     */
    function (bool) {
        this.updateToggleStatus(bool);
        this._toggleSidenavSource.next(this.sidenavOpened);
    };
    /**
     * @param {?} bool
     * @return {?}
     */
    VerdocsHeaderService.prototype.updateToggleStatus = /**
     * @param {?} bool
     * @return {?}
     */
    function (bool) {
        this.sidenavOpened = bool;
    };
    /**
     * @param {?} string
     * @return {?}
     */
    VerdocsHeaderService.prototype.updateTitle = /**
     * @param {?} string
     * @return {?}
     */
    function (string) {
        this._title.next(string);
    };
    /**
     * @param {?} bool
     * @return {?}
     */
    VerdocsHeaderService.prototype.updateSelectStatus = /**
     * @param {?} bool
     * @return {?}
     */
    function (bool) {
        this._selected.next(bool);
    };
    /**
     * @param {?} string
     * @return {?}
     */
    VerdocsHeaderService.prototype.updatePdfUrl = /**
     * @param {?} string
     * @return {?}
     */
    function (string) {
        this._pdfUrl.next(string);
    };
    /**
     * @param {?} string
     * @return {?}
     */
    VerdocsHeaderService.prototype.updateEnv = /**
     * @param {?} string
     * @return {?}
     */
    function (string) {
        this._env.next(string);
    };
    /**
     * @param {?} IEnvelopeDocument
     * @return {?}
     */
    VerdocsHeaderService.prototype.updateEnvDoc = /**
     * @param {?} IEnvelopeDocument
     * @return {?}
     */
    function (IEnvelopeDocument) {
        this._envDoc.next(IEnvelopeDocument);
    };
    /**
     * @return {?}
     */
    VerdocsHeaderService.prototype.initNotificationService = /**
     * @return {?}
     */
    function () { };
    /**
     * @param {?} envelopes
     * @return {?}
     */
    VerdocsHeaderService.prototype.updateEnvelopes = /**
     * @param {?} envelopes
     * @return {?}
     */
    function (envelopes) {
        this.allEnvelopes.next(envelopes);
    };
    /**
     * @return {?}
     */
    VerdocsHeaderService.prototype.toggleCreate = /**
     * @return {?}
     */
    function () {
        this.createToggleSubscription.next(true);
    };
    /**
     * @param {?} searchParams
     * @return {?}
     */
    VerdocsHeaderService.prototype.searchEnvelopes = /**
     * @param {?} searchParams
     * @return {?}
     */
    function (searchParams) {
        var _this = this;
        for (var key in searchParams) {
            if (searchParams.hasOwnProperty(key)) {
                if (searchParams[key] === null) {
                    delete searchParams[key];
                }
            }
        }
        return this.http.request(new HttpRequest('POST', this.envUrl + '/search', searchParams, {
            reportProgress: true,
            responseType: 'json'
        })).pipe(map((/**
         * @param {?} event
         * @return {?}
         */
        function (event) {
            if (event instanceof HttpResponse) {
                _this.updateEnvelopes(event.body);
            }
            return event;
        })));
    };
    /**
     * @param {?} searchParams
     * @return {?}
     */
    VerdocsHeaderService.prototype.searchTemplates = /**
     * @param {?} searchParams
     * @return {?}
     */
    function (searchParams) {
        for (var key in searchParams) {
            if (searchParams.hasOwnProperty(key)) {
                if (searchParams[key] === null) {
                    delete searchParams[key];
                }
            }
        }
        return this.http.request(new HttpRequest('POST', this.tokenConfig.rForm_backend_url + '/templates/search', searchParams, {
            reportProgress: true,
            responseType: 'json'
        })).pipe(map((/**
         * @param {?} event
         * @return {?}
         */
        function (event) {
            return event;
        })));
    };
    /**
     * @param {?} template
     * @return {?}
     */
    VerdocsHeaderService.prototype.downloadTemplateDocument = /**
     * @param {?} template
     * @return {?}
     */
    function (template) {
        var _this = this;
        this.getTemplateDocument(template.id, template.template_documents[0]).then((/**
         * @param {?} template_file
         * @return {?}
         */
        function (template_file) {
            if (isPlatformBrowser(_this.platform)) {
                if (window && window.URL) {
                    /** @type {?} */
                    var fileUrl = URL.createObjectURL(template_file);
                    saveAs(fileUrl, template.template_documents[0].name + '.pdf');
                }
            }
        }));
    };
    /**
     * @param {?} templateId
     * @param {?} templateDocument
     * @return {?}
     */
    VerdocsHeaderService.prototype.getTemplateDocument = /**
     * @param {?} templateId
     * @param {?} templateDocument
     * @return {?}
     */
    function (templateId, templateDocument) {
        return this.http.get(this.tokenConfig.rForm_backend_url + '/templates/' + templateId + '/documents/' +
            templateDocument.id + '?file=true', { responseType: 'blob' }).toPromise();
    };
    /**
     * @param {?} templates
     * @return {?}
     */
    VerdocsHeaderService.prototype.updateTemplates = /**
     * @param {?} templates
     * @return {?}
     */
    function (templates) {
        this.templates.next(templates);
    };
    /**
     * @return {?}
     */
    VerdocsHeaderService.prototype.toggleBuilderSideNav = /**
     * @return {?}
     */
    function () {
        this.builderSideNavState = !this.builderSideNavState;
        this.sideNavStateSubject.next(this.builderSideNavState);
        if (this.builderSideNavState === false) {
            this.initiateBuilderAutofocus.next(false);
        }
    };
    /**
     * @param {?} template
     * @return {?}
     */
    VerdocsHeaderService.prototype.canUserEdit = /**
     * @param {?} template
     * @return {?}
     */
    function (template) {
        /** @type {?} */
        var response = this.templateGuard.canPerformAction(TemplateActions.WRITE, template);
        return response['canPerform'];
    };
    /**
     * @param {?} templateId
     * @param {?} body
     * @return {?}
     */
    VerdocsHeaderService.prototype.updateTemplate = /**
     * @param {?} templateId
     * @param {?} body
     * @return {?}
     */
    function (templateId, body) {
        return this.http
            .put(this.tokenConfig.rForm_backend_url + '/templates/' + templateId, body)
            .toPromise().then((/**
         * @param {?} template
         * @return {?}
         */
        function (template) { return template; }));
    };
    /**
     * @param {?} template
     * @return {?}
     */
    VerdocsHeaderService.prototype.openTemplate = /**
     * @param {?} template
     * @return {?}
     */
    function (template) {
        if (this.canUserPreview(template)) {
            location.href = this.tokenConfig.rForm_frontend_url + "/document/" + template.id;
        }
        else if (this.canUserEdit(template)) {
            location.href = this.tokenConfig.rForm_frontend_url + "/builder/" + template.id + "/fields";
        }
        else {
            this.snackbar.open("Template is in build mode, and not ready for use.  Please check back soon.");
        }
    };
    /**
     * @param {?=} searchKeyword
     * @return {?}
     */
    VerdocsHeaderService.prototype.openTemplates = /**
     * @param {?=} searchKeyword
     * @return {?}
     */
    function (searchKeyword) {
        if (this.tokenConfig.origin === 'rForm') {
            if (searchKeyword.trim() !== '') {
                this.router.navigate(['documents'], { queryParams: { name: searchKeyword } });
            }
            else {
                this.router.navigate(['documents']);
            }
        }
        else {
            if (searchKeyword.trim() !== '') {
                location.href = this.tokenConfig.rForm_frontend_url + "/documents?name=" + searchKeyword;
            }
            else {
                location.href = this.tokenConfig.rForm_frontend_url + "/documents";
            }
        }
    };
    /**
     * @param {?} id
     * @return {?}
     */
    VerdocsHeaderService.prototype.getTemplateOwnerInfo = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        return this.http.get(this.tokenConfig.rForm_backend_url + "/templates/" + id + "?owner_info=true")
            .toPromise().then((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            return res;
        }));
    };
    /**
     * @param {?} template
     * @return {?}
     */
    VerdocsHeaderService.prototype.canUserPreview = /**
     * @param {?} template
     * @return {?}
     */
    function (template) {
        var e_1, _a;
        /** @type {?} */
        var hasPermission = (this.templateGuard.canPerformAction(TemplateActions.READ, template)).canPerform;
        /** @type {?} */
        var canPreview;
        /** @type {?} */
        var roles = template.roles;
        /** @type {?} */
        var signers = filter(roles, { type: 'signer' });
        canPreview = signers && signers.length > 0;
        try {
            for (var signers_1 = tslib_1.__values(signers), signers_1_1 = signers_1.next(); !signers_1_1.done; signers_1_1 = signers_1.next()) {
                var signer = signers_1_1.value;
                canPreview = signer['fields'] && signer['fields'].length > 0;
            }
        }
        catch (e_1_1) { e_1 = { error: e_1_1 }; }
        finally {
            try {
                if (signers_1_1 && !signers_1_1.done && (_a = signers_1.return)) _a.call(signers_1);
            }
            finally { if (e_1) throw e_1.error; }
        }
        return hasPermission && canPreview;
    };
    /**
     * @param {?} id
     * @return {?}
     */
    VerdocsHeaderService.prototype.starTemplate = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        return this.http.post(this.tokenConfig.rForm_backend_url + ("/templates/" + id + "/stars"), {}).pipe(catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            if (err && err.status === 401) {
                /** @type {?} */
                var errorDialog = _this.dialog.open(FourOhOneDialog, {
                    panelClass: 'error__dialog',
                    disableClose: true
                });
                errorDialog.componentInstance.error = err;
            }
            return EMPTY;
        })), map((/**
         * @param {?} res
         * @return {?}
         */
        function (res) { return res; })));
    };
    /**
     * @param {?} id
     * @return {?}
     */
    VerdocsHeaderService.prototype.unstarTemplate = /**
     * @param {?} id
     * @return {?}
     */
    function (id) {
        var _this = this;
        return this.http.delete(this.tokenConfig.rForm_backend_url + ("/templates/" + id + "/stars")).pipe(catchError((/**
         * @param {?} err
         * @return {?}
         */
        function (err) {
            if (err && err.status === 401) {
                /** @type {?} */
                var errorDialog = _this.dialog.open(FourOhOneDialog, {
                    panelClass: 'error__dialog',
                    disableClose: true
                });
                errorDialog.componentInstance.error = err;
            }
            return EMPTY;
        })), map((/**
         * @param {?} res
         * @return {?}
         */
        function (res) { return res; })));
    };
    //Account Services
    //Account Services
    /**
     * @param {?=} sendMessage
     * @return {?}
     */
    VerdocsHeaderService.prototype.updateTokens = 
    //Account Services
    /**
     * @param {?=} sendMessage
     * @return {?}
     */
    function (sendMessage) {
        return tslib_1.__awaiter(this, void 0, void 0, function () {
            var _this = this;
            return tslib_1.__generator(this, function (_a) {
                return [2 /*return*/, new Promise((/**
                     * @param {?} resolve
                     * @param {?} reject
                     * @return {?}
                     */
                    function (resolve, reject) {
                        _this.vTokenStateService.updateTokens(_this.tokenConfig.rSecure_backend_url).subscribe((/**
                         * @param {?} tokens
                         * @return {?}
                         */
                        function (tokens) {
                            if (tokens && tokens.length > 0) {
                                if (sendMessage) {
                                    _this.snackbar.dismiss();
                                    _this.snackbar.open('Status updated');
                                }
                            }
                            _this.getAccountData();
                            return resolve();
                        }));
                    }))];
            });
        });
    };
    /**
     * @return {?}
     */
    VerdocsHeaderService.prototype.getAccountData = /**
     * @return {?}
     */
    function () {
        // might need if header needs to show condition
        /** @type {?} */
        var profile = this.vTokenObjectService.getProfile();
        if (profile) {
            this.getProfiles();
        }
    };
    /**
     * @return {?}
     */
    VerdocsHeaderService.prototype.getProfiles = /**
     * @return {?}
     */
    function () {
        var _this = this;
        return this.http.get(this.tokenConfig.rAccount_backend_url + '/profiles').toPromise().then((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            /** @type {?} */
            var personal = res.splice(findIndex(res, (/**
             * @param {?} p
             * @return {?}
             */
            function (p) { return p.organization.name === 'realster'; })), 1);
            _this.personalAccountSubject.next(personal[0]);
            _this.profileData = res.sort((/**
             * @param {?} a
             * @param {?} b
             * @return {?}
             */
            function (a, b) {
                if (a.organization.name < b.organization.name) {
                    return -1;
                }
                if (a.organization.name > b.organization.name) {
                    return 1;
                }
                return 0;
            }));
            _this.profileData.unshift(personal[0]);
            /** @type {?} */
            var currentIndex = findIndex(_this.profileData, { current: true });
            if (_this.profileData[currentIndex]['first_name']) {
                _this.userFullname = _this.profileData[currentIndex]['first_name'] + ' ' + _this.profileData[currentIndex]['last_name'];
                _this.userInitial = _this.profileData[currentIndex]['first_name'].charAt(0) +
                    _this.profileData[currentIndex]['last_name'].charAt(0);
            }
            else {
                _this.userFullname = '';
            }
            if (_this.profileData[currentIndex]['phone']) {
                _this.userPhone = _this.profileData[currentIndex]['phone'];
            }
            else {
                _this.userPhone = '';
            }
            if (_this.profileData[currentIndex]['email']) {
                _this.userEmail = _this.profileData[currentIndex]['email'];
            }
            _this.userData = {
                name: _this.userFullname,
                initial: _this.userInitial,
                email: _this.userEmail,
                phone: _this.userPhone
            };
            _this.userProfileSubject.next(_this.profileData);
            /** @type {?} */
            var currentProfile = _this.profileData[currentIndex];
            _this.currentProfileSubject.next(currentProfile);
            _this.currentOrganizationId = currentProfile.organization_id;
            _this.userDataSubject.next(_this.userData);
            return _this.userData;
        }));
    };
    /**
     * @param {?} profiles
     * @return {?}
     */
    VerdocsHeaderService.prototype.getProfileCollection = /**
     * @param {?} profiles
     * @return {?}
     */
    function (profiles) {
        /** @type {?} */
        var profileModels = [];
        profiles.forEach((/**
         * @param {?} profile
         * @return {?}
         */
        function (profile) {
            profileModels.push(new ProfileModel(profile));
        }));
        /** @type {?} */
        var profileCollection = new ProfileCollection(profileModels);
        return profileCollection;
    };
    /**
     * @param {?} profile_id
     * @return {?}
     */
    VerdocsHeaderService.prototype.switchProfile = /**
     * @param {?} profile_id
     * @return {?}
     */
    function (profile_id) {
        var _this = this;
        this.profileLoadingSubject.next(true);
        return this.http.post(this.tokenConfig.rAccount_backend_url + '/profiles/' + profile_id + '/switch', null).toPromise().then((/**
         * @param {?} res
         * @return {?}
         */
        function (res) { return tslib_1.__awaiter(_this, void 0, void 0, function () {
            return tslib_1.__generator(this, function (_a) {
                this.vTokenStateService.setTokens(res.tokens);
                this.profileLoadingSubject.next(false);
                return [2 /*return*/, Promise.resolve(res)];
            });
        }); }));
    };
    /**
     * @return {?}
     */
    VerdocsHeaderService.prototype.resendEmailVerification = /**
     * @return {?}
     */
    function () {
        var _this = this;
        this.http.post(this.tokenConfig.rSecure_backend_url + '/user/email_verification', null).toPromise().then((/**
         * @return {?}
         */
        function () {
            _this.snackbar.open('Verification email sent');
        }));
    };
    /**
     * @param {?} name
     * @return {?}
     */
    VerdocsHeaderService.prototype.getNameValidity = /**
     * @param {?} name
     * @return {?}
     */
    function (name) {
        return this.http.get(this.tokenConfig.rAccount_backend_url + '/organizations/is_valid?name=' + name, this.getOptions())
            .toPromise()
            .then((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            return Promise.resolve(res);
        }));
    };
    /**
     * @param {?} body
     * @return {?}
     */
    VerdocsHeaderService.prototype.createOrganization = /**
     * @param {?} body
     * @return {?}
     */
    function (body) {
        return this.http.post(this.tokenConfig.rAccount_backend_url + '/organizations', body, this.getOptions())
            .toPromise()
            .then((/**
         * @param {?} res
         * @return {?}
         */
        function (res) {
            return Promise.resolve(res);
        }));
    };
    /**
     * @private
     * @return {?}
     */
    VerdocsHeaderService.prototype.getOptions = /**
     * @private
     * @return {?}
     */
    function () {
        if (isPlatformServer(this.platform)) {
            return;
        }
        /** @type {?} */
        var vTokenCookie = this.vTokenStateService.getOtherCookieObject('rAccount_Verdocs');
        /** @type {?} */
        var authValue = 'Bearer ' + vTokenCookie['accessToken'];
        /** @type {?} */
        var headers = new HttpHeaders({
            'Cache-Control': 'no-cache',
            'Pragma': 'no-cache',
            'Expires': 'Sat, 01 Jan 2000 00:00:00 GMT',
            'If-Modified-Since': '0',
            'Content-Type': 'application/json',
            'Authorization': authValue,
            'Accept': 'application/json'
        });
        return { headers: headers };
    };
    // End of Account Services
    // End of Account Services
    /**
     * @param {?} name
     * @param {?=} index
     * @return {?}
     */
    VerdocsHeaderService.prototype.getRoleColor = 
    // End of Account Services
    /**
     * @param {?} name
     * @param {?=} index
     * @return {?}
     */
    function (name, index) {
        if (index) {
            return this.getRGBA(index);
        }
        else if (this.template && this.template.roles && this.template.roles.length > 0) {
            index = findIndex(this.template.roles, { name: name });
            if (index >= 0) {
                return this.template.roles[index].rgba ? this.template.roles[index].rgba : this.getRGBA(index);
            }
            else {
                return this.nameToRGBA(name);
            }
        }
        else {
            return this.nameToRGBA(name);
        }
    };
    /**
     * @param {?} rgba
     * @return {?}
     */
    VerdocsHeaderService.prototype.getRGB = /**
     * @param {?} rgba
     * @return {?}
     */
    function (rgba) {
        /** @type {?} */
        var rgbNumbers = rgba.replace('rgba(', '').replace(')', '').split(',');
        /** @type {?} */
        var rgbObject = {
            red: rgbNumbers[0],
            green: rgbNumbers[1],
            blue: rgbNumbers[2],
            alpha: rgbNumbers[3]
        };
        /** @type {?} */
        var alpha = 1 - rgbObject.alpha;
        /** @type {?} */
        var red = Math.round((rgbObject.alpha * (rgbObject.red / 255) + alpha) * 255);
        /** @type {?} */
        var green = Math.round((rgbObject.alpha * (rgbObject.green / 255) + alpha) * 255);
        /** @type {?} */
        var blue = Math.round((rgbObject.alpha * (rgbObject.blue / 255) + alpha) * 255);
        return ('#' + this.rgbToHex(red) + this.rgbToHex(green) + this.rgbToHex(blue));
    };
    /**
     * @param {?} rgb
     * @return {?}
     */
    VerdocsHeaderService.prototype.rgbToHex = /**
     * @param {?} rgb
     * @return {?}
     */
    function (rgb) {
        /** @type {?} */
        var hex = rgb.toString(16);
        if (hex.length < 2) {
            return '0' + hex;
        }
        return hex;
    };
    /**
     * @param {?} index
     * @return {?}
     */
    VerdocsHeaderService.prototype.getRGBA = /**
     * @param {?} index
     * @return {?}
     */
    function (index) {
        switch (index % 10) {
            case 0:
                return index === 0 ? 'rgba(255, 193, 7, 0.4)' : 'rgba(134, 134, 134, 0.3)'; //#FFE69C
            case 1:
                return 'rgba(156, 39, 176, .4)'; //'#E3C3E9'
            case 2:
                return 'rgba(33, 150, 243, .4)'; //'#C1E1FB'
            case 3:
                return 'rgba(220, 231, 117, 0.3)';
            case 4:
                return 'rgba(121, 134, 203, 0.3)';
            case 5:
                return 'rgba(77, 182, 172, 0.3)';
            case 6:
                return 'rgba(255, 202, 165, 0.3)';
            case 7:
                return 'rgba(2, 247, 190, 0.3)';
            case 8:
                return 'rgba(255, 138, 101, 0.3)';
            case 9:
                return 'rgba(82, 255, 79, 0.3)';
            default:
                return 'rgba(229, 115, 155, 0.3)';
        }
    };
    /**
     * @param {?} str
     * @return {?}
     */
    VerdocsHeaderService.prototype.nameToRGBA = /**
     * @param {?} str
     * @return {?}
     */
    function (str) {
        if (!!str) {
            /** @type {?} */
            var validNum = parseInt(str.slice(-1), 10);
            if (!isNaN(validNum)) {
                str += (validNum * 99).toString();
            }
            /** @type {?} */
            var hash = 0;
            for (var i = 0; i < str.length; i++) {
                hash = str.charCodeAt(i) + ((hash << 5) - hash);
            }
            hash = Math.round(hash / 1.3);
            /** @type {?} */
            var c = (hash & 0x00FFFF08)
                .toString(16)
                .toUpperCase();
            /** @type {?} */
            var hex = '#' + '00000'.substring(0, 6 - c.length) + c;
            /** @type {?} */
            var result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
            /** @type {?} */
            var color = {
                r: parseInt(result[1], 16),
                g: parseInt(result[2], 16),
                b: parseInt(result[3], 16)
            };
            return "rgba(" + color.r + ", " + color.g + ", " + color.b + ", 0.2)";
        }
    };
    VerdocsHeaderService.decorators = [
        { type: Injectable, args: [{
                    providedIn: 'root'
                },] }
    ];
    /** @nocollapse */
    VerdocsHeaderService.ctorParameters = function () { return [
        { type: Injector },
        { type: HttpClient },
        { type: Router },
        { type: MatSnackBar },
        { type: MatDialog },
        { type: TemplatesGuardService },
        { type: VerdocsStateService },
        { type: VerdocsTokenObjectService },
        { type: undefined, decorators: [{ type: Inject, args: [PLATFORM_ID,] }] }
    ]; };
    /** @nocollapse */ VerdocsHeaderService.ngInjectableDef = i0.ɵɵdefineInjectable({ factory: function VerdocsHeaderService_Factory() { return new VerdocsHeaderService(i0.ɵɵinject(i0.INJECTOR), i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router), i0.ɵɵinject(i3.MatSnackBar), i0.ɵɵinject(i4.MatDialog), i0.ɵɵinject(i5.TemplatesGuardService), i0.ɵɵinject(i6.VerdocsStateService), i0.ɵɵinject(i6.VerdocsTokenObjectService), i0.ɵɵinject(i0.PLATFORM_ID)); }, token: VerdocsHeaderService, providedIn: "root" });
    return VerdocsHeaderService;
}());
export { VerdocsHeaderService };
if (false) {
    /** @type {?} */
    VerdocsHeaderService.prototype.tokenConfig;
    /** @type {?} */
    VerdocsHeaderService.prototype.titleSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.csvBlobSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.templates;
    /** @type {?} */
    VerdocsHeaderService.prototype.saveStatusSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.templateDetailToggleSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.profileLoadingSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.templateSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.template;
    /** @type {?} */
    VerdocsHeaderService.prototype.allEnvelopes;
    /** @type {?} */
    VerdocsHeaderService.prototype.sideNavStateSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.initiateBuilderAutofocus;
    /** @type {?} */
    VerdocsHeaderService.prototype.createToggleSubscription;
    /** @type {?} */
    VerdocsHeaderService.prototype.rAccount_url;
    /** @type {?} */
    VerdocsHeaderService.prototype.rSecure_url;
    /** @type {?} */
    VerdocsHeaderService.prototype.rForm_url;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.envUrl;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype._toggleSidenavSource;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype._title;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype._selected;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype._pdfUrl;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype._env;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype._envDoc;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.builderSideNavState;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.userFullname;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.userInitial;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.userEmail;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.userPhone;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.userData;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.profileData;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.isAtOrigin;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.currentOrigin;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.currentOrganizationId;
    /** @type {?} */
    VerdocsHeaderService.prototype.sidenavOpened;
    /** @type {?} */
    VerdocsHeaderService.prototype.toggleSidenav$;
    /** @type {?} */
    VerdocsHeaderService.prototype.selectStatus$;
    /** @type {?} */
    VerdocsHeaderService.prototype.env$;
    /** @type {?} */
    VerdocsHeaderService.prototype.titleValue$;
    /** @type {?} */
    VerdocsHeaderService.prototype.pdfUrl$;
    /** @type {?} */
    VerdocsHeaderService.prototype.envDoc$;
    /** @type {?} */
    VerdocsHeaderService.prototype.userDataSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.userProfileSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.currentProfileSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.personalAccountSubject;
    /** @type {?} */
    VerdocsHeaderService.prototype.profilesSubject;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.injector;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.http;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.router;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.snackbar;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.dialog;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.templateGuard;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.vTokenStateService;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.vTokenObjectService;
    /**
     * @type {?}
     * @private
     */
    VerdocsHeaderService.prototype.platform;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaGVhZGVyLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9AdmVyZG9jcy9oZWFkZXIvIiwic291cmNlcyI6WyJsaWIvc2VydmljZXMvaGVhZGVyLnNlcnZpY2UudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQSxPQUFPLEVBQUUsVUFBVSxFQUFFLFFBQVEsRUFBRSxNQUFNLEVBQUUsV0FBVyxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzFFLE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxpQkFBaUIsRUFBRSxNQUFNLGlCQUFpQixDQUFBO0FBQ3JFLE9BQU8sRUFBRSxVQUFVLEVBQUUsWUFBWSxFQUFFLFdBQVcsRUFBRSxXQUFXLEVBQUUsTUFBTSxzQkFBc0IsQ0FBQztBQUMxRixPQUFPLEVBQUUsTUFBTSxFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFDekMsT0FBTyxFQUFFLFdBQVcsRUFBRSxNQUFNLDZCQUE2QixDQUFDO0FBQzFELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSwwQkFBMEIsQ0FBQztBQUNyRCxPQUFPLEVBQUUsYUFBYSxFQUFFLE9BQU8sRUFBRSxlQUFlLEVBQUUsS0FBSyxFQUFjLE1BQU0sTUFBTSxDQUFDO0FBQ2xGLE9BQU8sRUFBRSxHQUFHLEVBQUUsVUFBVSxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDakQsT0FBTyxFQUFFLFNBQVMsRUFBRSxNQUFNLEVBQUUsTUFBTSxRQUFRLENBQUM7QUFDM0MsT0FBTyxFQUFFLE1BQU0sRUFBRSxNQUFNLFlBQVksQ0FBQztBQUNwQyxPQUFPLEVBQUUsWUFBWSxFQUFFLGlCQUFpQixFQUFFLE1BQU0sbUJBQW1CLENBQUM7QUFDcEUsT0FBTyxFQUFFLG1CQUFtQixFQUFFLHlCQUF5QixFQUFFLE1BQU0saUJBQWlCLENBQUM7QUFFakYsT0FBTyxFQUFvQixxQkFBcUIsRUFBRSxNQUFNLGtCQUFrQixDQUFDO0FBQzNFLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLG1CQUFtQixDQUFDO0FB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MkNBQXFDOztJQUNyQyw0Q0FBa0Q7O0lBQ2xELDhDQUFrRDs7SUFDbEQseUNBQW9FOztJQUNwRSxpREFBOEU7O0lBQzlFLDJEQUE4RTs7SUFDOUUscURBQTREOztJQUM1RCwrQ0FBc0U7O0lBQ3RFLHdDQUEyQjs7SUFDM0IsNENBQTBEOztJQUMxRCxtREFBeUU7O0lBQ3pFLHdEQUE4RTs7SUFDOUUsd0RBQTJFOztJQUMzRSw0Q0FBNEI7O0lBQzVCLDJDQUEyQjs7SUFDM0IseUNBQXlCOzs7OztJQUV6QixzQ0FBdUI7Ozs7O0lBQ3ZCLG9EQUFtRTs7Ozs7SUFDbkUsc0NBQWlEOzs7OztJQUNqRCx5Q0FBd0Q7Ozs7O0lBQ3hELHVDQUFrRDs7Ozs7SUFDbEQsb0NBTUc7Ozs7O0lBQ0gsdUNBTUc7Ozs7O0lBQ0gsbURBQXFDOzs7OztJQUNyQyw0Q0FBMEI7Ozs7O0lBQzFCLDJDQUF5Qjs7Ozs7SUFDekIseUNBQXVCOzs7OztJQUN2Qix5Q0FBdUI7Ozs7O0lBQ3ZCLHdDQUtFOzs7OztJQUNGLDJDQUF5Qjs7Ozs7SUFDekIsMENBQW9DOzs7OztJQUNwQyw2Q0FBK0Q7Ozs7O0lBQy9ELHFEQUE2Qzs7SUFDN0MsNkNBQTZCOztJQUU3Qiw4Q0FBMEQ7O0lBQzFELDZDQUE4Qzs7SUFDOUMsb0NBQWdDOztJQUNoQywyQ0FBeUM7O0lBQ3pDLHVDQUFzQzs7SUFDdEMsdUNBQXNDOztJQUN0QywrQ0FBa0Q7O0lBQ2xELGtEQUFxRDs7SUFDckQscURBQXdEOztJQUN4RCxzREFBeUQ7O0lBQ3pELCtDQUFrRDs7Ozs7SUFHaEQsd0NBQTBCOzs7OztJQUMxQixvQ0FBd0I7Ozs7O0lBQ3hCLHNDQUFzQjs7Ozs7SUFDdEIsd0NBQTZCOzs7OztJQUM3QixzQ0FBeUI7Ozs7O0lBQ3pCLDZDQUE0Qzs7Ozs7SUFDNUMsa0RBQStDOzs7OztJQUMvQyxtREFBc0Q7Ozs7O0lBQ3RELHdDQUFxQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEluamVjdGFibGUsIEluamVjdG9yLCBJbmplY3QsIFBMQVRGT1JNX0lEIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBpc1BsYXRmb3JtU2VydmVyLCBpc1BsYXRmb3JtQnJvd3NlciB9IGZyb20gJ0Bhbmd1bGFyL2NvbW1vbidcbmltcG9ydCB7IEh0dHBDbGllbnQsIEh0dHBSZXNwb25zZSwgSHR0cFJlcXVlc3QsIEh0dHBIZWFkZXJzIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uL2h0dHAnO1xuaW1wb3J0IHsgUm91dGVyIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IE1hdFNuYWNrQmFyIH0gZnJvbSAnQGFuZ3VsYXIvbWF0ZXJpYWwvc25hY2stYmFyJztcbmltcG9ydCB7IE1hdERpYWxvZyB9IGZyb20gJ0Bhbmd1bGFyL21hdGVyaWFsL2RpYWxvZyc7XG5pbXBvcnQgeyBSZXBsYXlTdWJqZWN0LCBTdWJqZWN0LCBCZWhhdmlvclN1YmplY3QsIEVNUFRZLCBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyBtYXAsIGNhdGNoRXJyb3IgfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5pbXBvcnQgeyBmaW5kSW5kZXgsIGZpbHRlciB9IGZyb20gJ2xvZGFzaCc7XG5pbXBvcnQgeyBzYXZlQXMgfSBmcm9tICdmaWxlLXNhdmVyJztcbmltcG9ydCB7IFByb2ZpbGVNb2RlbCwgUHJvZmlsZUNvbGxlY3Rpb24gfSBmcm9tICdAdmVyZG9jcy9wcm9maWxlcyc7XG5pbXBvcnQgeyBWZXJkb2NzU3RhdGVTZXJ2aWNlLCBWZXJkb2NzVG9rZW5PYmplY3RTZXJ2aWNlIH0gZnJvbSAnQHZlcmRvY3MvdG9rZW5zJztcblxuaW1wb3J0IHsgY29ubmVjdGlvbkNvbmZpZywgY29ubmVjdGlvbkNvbmZpZ1Rva2VuIH0gZnJvbSAnLi4vaGVhZGVyLm1vZHVsZSc7XG5pbXBvcnQgeyBUZW1wbGF0ZXNHdWFyZFNlcnZpY2UgfSBmcm9tICcuL3RlbXBsYXRlcy5ndWFyZCc7XG5cbmltcG9ydCB7IElUZW1wbGF0ZSwgRW52ZWxvcGUsIElFbnZlbG9wZVNlYXJjaFBhcmFtcywgSVRlbXBsYXRlU2VhcmNoUGFyYW1zLCBJRW52ZWxvcGVEb2N1bWVudCwgVGVtcGxhdGVBY3Rpb25zIH0gZnJvbSAnLi4vbW9kZWxzL3ZlcmRvY3MubW9kZWwnO1xuXG5pbXBvcnQgeyBGb3VyT2hPbmVEaWFsb2cgfSBmcm9tICcuLi9lcnJvci1kaWFsb2dzL2ZvdXItb2gtb25lLmRpYWxvZyc7XG5cbkBJbmplY3RhYmxlKHtcbiAgcHJvdmlkZWRJbjogJ3Jvb3QnXG59KVxuZXhwb3J0IGNsYXNzIFZlcmRvY3NIZWFkZXJTZXJ2aWNlIHtcblxuICBwdWJsaWMgdG9rZW5Db25maWc6IGNvbm5lY3Rpb25Db25maWc7XG4gIHB1YmxpYyB0aXRsZVN1YmplY3QgPSBuZXcgUmVwbGF5U3ViamVjdDxzdHJpbmc+KCk7XG4gIHB1YmxpYyBjc3ZCbG9iU3ViamVjdCA9IG5ldyBSZXBsYXlTdWJqZWN0PEJsb2I+KCk7XG4gIHB1YmxpYyB0ZW1wbGF0ZXM6IFN1YmplY3Q8SVRlbXBsYXRlW10+ID0gbmV3IFN1YmplY3Q8SVRlbXBsYXRlW10+KCk7XG4gIHB1YmxpYyBzYXZlU3RhdHVzU3ViamVjdDogUmVwbGF5U3ViamVjdDxzdHJpbmc+ID0gbmV3IFJlcGxheVN1YmplY3Q8c3RyaW5nPigpO1xuICBwdWJsaWMgdGVtcGxhdGVEZXRhaWxUb2dnbGVTdWJqZWN0OiBTdWJqZWN0PGJvb2xlYW4+ID0gbmV3IFN1YmplY3Q8Ym9vbGVhbj4oKTtcbiAgcHVibGljIHByb2ZpbGVMb2FkaW5nU3ViamVjdCA9IG5ldyBSZXBsYXlTdWJqZWN0PGJvb2xlYW4+KCk7XG4gIHB1YmxpYyB0ZW1wbGF0ZVN1YmplY3Q6IFN1YmplY3Q8SVRlbXBsYXRlPiA9IG5ldyBTdWJqZWN0PElUZW1wbGF0ZT4oKTtcbiAgcHVibGljIHRlbXBsYXRlOiBJVGVtcGxhdGU7XG4gIHB1YmxpYyBhbGxFbnZlbG9wZXMgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PEVudmVsb3BlW10+KFtdKTtcbiAgcHVibGljIHNpZGVOYXZTdGF0ZVN1YmplY3Q6IFJlcGxheVN1YmplY3Q8Ym9vbGVhbj4gPSBuZXcgUmVwbGF5U3ViamVjdCgpO1xuICBwdWJsaWMgaW5pdGlhdGVCdWlsZGVyQXV0b2ZvY3VzOiBSZXBsYXlTdWJqZWN0PGJvb2xlYW4+ID0gbmV3IFJlcGxheVN1YmplY3QoKTtcbiAgcHVibGljIGNyZWF0ZVRvZ2dsZVN1YnNjcmlwdGlvbjogU3ViamVjdDxib29sZWFuPiA9IG5ldyBTdWJqZWN0PGJvb2xlYW4+KCk7XG4gIHB1YmxpYyByQWNjb3VudF91cmw6IHN0cmluZztcbiAgcHVibGljIHJTZWN1cmVfdXJsOiBzdHJpbmc7XG4gIHB1YmxpYyByRm9ybV91cmw6IHN0cmluZztcblxuICBwcml2YXRlIGVudlVybDogc3RyaW5nO1xuICBwcml2YXRlIF90b2dnbGVTaWRlbmF2U291cmNlID0gbmV3IEJlaGF2aW9yU3ViamVjdDxib29sZWFuPihmYWxzZSk7XG4gIHByaXZhdGUgX3RpdGxlID0gbmV3IEJlaGF2aW9yU3ViamVjdDxzdHJpbmc+KCcnKTtcbiAgcHJpdmF0ZSBfc2VsZWN0ZWQgPSBuZXcgQmVoYXZpb3JTdWJqZWN0PGJvb2xlYW4+KGZhbHNlKTtcbiAgcHJpdmF0ZSBfcGRmVXJsID0gbmV3IEJlaGF2aW9yU3ViamVjdDxzdHJpbmc+KCcnKTtcbiAgcHJpdmF0ZSBfZW52ID0gbmV3IEJlaGF2aW9yU3ViamVjdDxFbnZlbG9wZT4oe1xuICAgIGlkOiAnJyxcbiAgICB0ZW1wbGF0ZV9pZDogJycsXG4gICAgc3RhdHVzOiAnJyxcbiAgICB1c2VyX2lkOiAnJyxcbiAgICBlbnZlbG9wZV9kb2N1bWVudF9pZDogJydcbiAgfSk7XG4gIHByaXZhdGUgX2VudkRvYyA9IG5ldyBCZWhhdmlvclN1YmplY3Q8SUVudmVsb3BlRG9jdW1lbnQ+KHtcbiAgICBpZDogJycsXG4gICAgdXJsOiAnJyxcbiAgICBuYW1lOiAnJyxcbiAgICBwYWdlX251bWJlcnM6IDAsXG4gICAgbWltZTogJycsXG4gIH0pO1xuICBwcml2YXRlIGJ1aWxkZXJTaWRlTmF2U3RhdGU6IGJvb2xlYW47XG4gIHByaXZhdGUgdXNlckZ1bGxuYW1lID0gJyc7XG4gIHByaXZhdGUgdXNlckluaXRpYWwgPSAnJztcbiAgcHJpdmF0ZSB1c2VyRW1haWwgPSAnJztcbiAgcHJpdmF0ZSB1c2VyUGhvbmUgPSAnJztcbiAgcHJpdmF0ZSB1c2VyRGF0YSA9IHtcbiAgICBuYW1lOiB0aGlzLnVzZXJGdWxsbmFtZSxcbiAgICBpbml0aWFsOiBudWxsLFxuICAgIGVtYWlsOiB0aGlzLnVzZXJFbWFpbCxcbiAgICBwaG9uZTogdGhpcy51c2VyUGhvbmVcbiAgfTtcbiAgcHJpdmF0ZSBwcm9maWxlRGF0YTogYW55O1xuICBwcml2YXRlIGlzQXRPcmlnaW46IGJvb2xlYW4gPSBmYWxzZTtcbiAgcHJpdmF0ZSBjdXJyZW50T3JpZ2luOiAnckFjY291bnQnIHwgJ3JGb3JtJyB8ICdyU2VjdXJlJyB8IG51bGw7XG4gIHByaXZhdGUgY3VycmVudE9yZ2FuaXphdGlvbklkOiBzdHJpbmcgPSBudWxsO1xuICBwdWJsaWMgc2lkZW5hdk9wZW5lZCA9IGZhbHNlO1xuXG4gIHRvZ2dsZVNpZGVuYXYkID0gdGhpcy5fdG9nZ2xlU2lkZW5hdlNvdXJjZS5hc09ic2VydmFibGUoKTtcbiAgc2VsZWN0U3RhdHVzJCA9IHRoaXMuX3NlbGVjdGVkLmFzT2JzZXJ2YWJsZSgpO1xuICBlbnYkID0gdGhpcy5fZW52LmFzT2JzZXJ2YWJsZSgpO1xuICB0aXRsZVZhbHVlJCA9IHRoaXMuX3RpdGxlLmFzT2JzZXJ2YWJsZSgpO1xuICBwZGZVcmwkID0gdGhpcy5fcGRmVXJsLmFzT2JzZXJ2YWJsZSgpO1xuICBlbnZEb2MkID0gdGhpcy5fZW52RG9jLmFzT2JzZXJ2YWJsZSgpO1xuICBwdWJsaWMgdXNlckRhdGFTdWJqZWN0ID0gbmV3IFJlcGxheVN1YmplY3Q8YW55PigpO1xuICBwdWJsaWMgdXNlclByb2ZpbGVTdWJqZWN0ID0gbmV3IFJlcGxheVN1YmplY3Q8YW55PigpO1xuICBwdWJsaWMgY3VycmVudFByb2ZpbGVTdWJqZWN0ID0gbmV3IFJlcGxheVN1YmplY3Q8YW55PigpO1xuICBwdWJsaWMgcGVyc29uYWxBY2NvdW50U3ViamVjdCA9IG5ldyBSZXBsYXlTdWJqZWN0PGFueT4oKTtcbiAgcHVibGljIHByb2ZpbGVzU3ViamVjdCA9IG5ldyBSZXBsYXlTdWJqZWN0PGFueT4oKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIGluamVjdG9yOiBJbmplY3RvcixcbiAgICBwcml2YXRlIGh0dHA6IEh0dHBDbGllbnQsXG4gICAgcHJpdmF0ZSByb3V0ZXI6IFJvdXRlcixcbiAgICBwcml2YXRlIHNuYWNrYmFyOiBNYXRTbmFja0JhcixcbiAgICBwcml2YXRlIGRpYWxvZzogTWF0RGlhbG9nLFxuICAgIHByaXZhdGUgdGVtcGxhdGVHdWFyZDogVGVtcGxhdGVzR3VhcmRTZXJ2aWNlLFxuICAgIHByaXZhdGUgdlRva2VuU3RhdGVTZXJ2aWNlOiBWZXJkb2NzU3RhdGVTZXJ2aWNlLFxuICAgIHByaXZhdGUgdlRva2VuT2JqZWN0U2VydmljZTogVmVyZG9jc1Rva2VuT2JqZWN0U2VydmljZSxcbiAgICBASW5qZWN0KFBMQVRGT1JNX0lEKSBwcml2YXRlIHBsYXRmb3JtXG4gICkge1xuICAgIHRoaXMudG9rZW5Db25maWcgPSB0aGlzLmluamVjdG9yLmdldChjb25uZWN0aW9uQ29uZmlnVG9rZW4pO1xuICAgIHRoaXMuZW52VXJsID0gdGhpcy50b2tlbkNvbmZpZy5yRm9ybV9iYWNrZW5kX3VybCArICcvZW52ZWxvcGVzJztcbiAgICB0aGlzLnJGb3JtX3VybCA9IHRoaXMudG9rZW5Db25maWcuckZvcm1fZnJvbnRlbmRfdXJsO1xuICAgIHRoaXMuckFjY291bnRfdXJsID0gdGhpcy50b2tlbkNvbmZpZy5yQWNjb3VudF9mcm9udGVuZF91cmw7XG4gICAgdGhpcy5yU2VjdXJlX3VybCA9IHRoaXMudG9rZW5Db25maWcuclNlY3VyZV9mcm9udGVuZF91cmw7XG4gIH1cblxuICBwdWJsaWMgZ2V0QXRPcmlnaW4ob3JpZ2luVHlwZSkge1xuICAgIHRoaXMuaXNBdE9yaWdpbiA9IG9yaWdpblR5cGUgJiYgdGhpcy50b2tlbkNvbmZpZy5vcmlnaW4gJiYgb3JpZ2luVHlwZSA9PT0gdGhpcy50b2tlbkNvbmZpZy5vcmlnaW47XG4gICAgcmV0dXJuIHRoaXMuaXNBdE9yaWdpbjtcbiAgfVxuXG4gIHB1YmxpYyB0b2dnbGVTaWRlbmF2KGJvb2wpIHtcbiAgICB0aGlzLnVwZGF0ZVRvZ2dsZVN0YXR1cyhib29sKTtcbiAgICB0aGlzLl90b2dnbGVTaWRlbmF2U291cmNlLm5leHQodGhpcy5zaWRlbmF2T3BlbmVkKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVUb2dnbGVTdGF0dXMoYm9vbCkge1xuICAgIHRoaXMuc2lkZW5hdk9wZW5lZCA9IGJvb2w7XG4gIH1cblxuICBwdWJsaWMgdXBkYXRlVGl0bGUoc3RyaW5nKSB7XG4gICAgdGhpcy5fdGl0bGUubmV4dChzdHJpbmcpO1xuICB9XG5cbiAgcHVibGljIHVwZGF0ZVNlbGVjdFN0YXR1cyhib29sKSB7XG4gICAgdGhpcy5fc2VsZWN0ZWQubmV4dChib29sKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVQZGZVcmwoc3RyaW5nKSB7XG4gICAgdGhpcy5fcGRmVXJsLm5leHQoc3RyaW5nKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVFbnYoc3RyaW5nKSB7XG4gICAgdGhpcy5fZW52Lm5leHQoc3RyaW5nKTtcbiAgfVxuXG4gIHB1YmxpYyB1cGRhdGVFbnZEb2MoSUVudmVsb3BlRG9jdW1lbnQpIHtcbiAgICB0aGlzLl9lbnZEb2MubmV4dChJRW52ZWxvcGVEb2N1bWVudCk7XG4gIH1cblxuICBpbml0Tm90aWZpY2F0aW9uU2VydmljZSgpIHsgfVxuXG4gIHB1YmxpYyB1cGRhdGVFbnZlbG9wZXMoZW52ZWxvcGVzKSB7XG4gICAgdGhpcy5hbGxFbnZlbG9wZXMubmV4dChlbnZlbG9wZXMpO1xuICB9XG5cbiAgcHVibGljIHRvZ2dsZUNyZWF0ZSgpIHtcbiAgICB0aGlzLmNyZWF0ZVRvZ2dsZVN1YnNjcmlwdGlvbi5uZXh0KHRydWUpO1xuICB9XG5cbiAgc2VhcmNoRW52ZWxvcGVzKHNlYXJjaFBhcmFtczogSUVudmVsb3BlU2VhcmNoUGFyYW1zKSB7XG4gICAgZm9yIChjb25zdCBrZXkgaW4gc2VhcmNoUGFyYW1zKSB7XG4gICAgICBpZiAoc2VhcmNoUGFyYW1zLmhhc093blByb3BlcnR5KGtleSkpIHtcbiAgICAgICAgaWYgKHNlYXJjaFBhcmFtc1trZXldID09PSBudWxsKSB7XG4gICAgICAgICAgZGVsZXRlIHNlYXJjaFBhcmFtc1trZXldO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmh0dHAucmVxdWVzdChuZXcgSHR0cFJlcXVlc3QoXG4gICAgICAnUE9TVCcsXG4gICAgICB0aGlzLmVudlVybCArICcvc2VhcmNoJyxcbiAgICAgIHNlYXJjaFBhcmFtcyxcbiAgICAgIHtcbiAgICAgICAgcmVwb3J0UHJvZ3Jlc3M6IHRydWUsXG4gICAgICAgIHJlc3BvbnNlVHlwZTogJ2pzb24nXG4gICAgICB9XG4gICAgKSkucGlwZShcbiAgICAgIG1hcChldmVudCA9PiB7XG4gICAgICAgIGlmIChldmVudCBpbnN0YW5jZW9mIEh0dHBSZXNwb25zZSkge1xuICAgICAgICAgIHRoaXMudXBkYXRlRW52ZWxvcGVzKGV2ZW50LmJvZHkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBldmVudDtcbiAgICAgIH0pXG4gICAgKTtcbiAgfVxuXG4gIHNlYXJjaFRlbXBsYXRlcyhzZWFyY2hQYXJhbXM6IElUZW1wbGF0ZVNlYXJjaFBhcmFtcykge1xuICAgIGZvciAoY29uc3Qga2V5IGluIHNlYXJjaFBhcmFtcykge1xuICAgICAgaWYgKHNlYXJjaFBhcmFtcy5oYXNPd25Qcm9wZXJ0eShrZXkpKSB7XG4gICAgICAgIGlmIChzZWFyY2hQYXJhbXNba2V5XSA9PT0gbnVsbCkge1xuICAgICAgICAgIGRlbGV0ZSBzZWFyY2hQYXJhbXNba2V5XTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdGhpcy5odHRwLnJlcXVlc3QobmV3IEh0dHBSZXF1ZXN0KFxuICAgICAgJ1BPU1QnLFxuICAgICAgdGhpcy50b2tlbkNvbmZpZy5yRm9ybV9iYWNrZW5kX3VybCArICcvdGVtcGxhdGVzL3NlYXJjaCcsXG4gICAgICBzZWFyY2hQYXJhbXMsXG4gICAgICB7XG4gICAgICAgIHJlcG9ydFByb2dyZXNzOiB0cnVlLFxuICAgICAgICByZXNwb25zZVR5cGU6ICdqc29uJ1xuICAgICAgfVxuICAgICkpLnBpcGUoXG4gICAgICBtYXAoZXZlbnQgPT4ge1xuICAgICAgICByZXR1cm4gZXZlbnQ7XG4gICAgICB9KVxuICAgICk7XG4gIH1cblxuICBkb3dubG9hZFRlbXBsYXRlRG9jdW1lbnQodGVtcGxhdGU6IElUZW1wbGF0ZSkge1xuICAgIHRoaXMuZ2V0VGVtcGxhdGVEb2N1bWVudCh0ZW1wbGF0ZS5pZCwgdGVtcGxhdGUudGVtcGxhdGVfZG9jdW1lbnRzWzBdKS50aGVuKHRlbXBsYXRlX2ZpbGUgPT4ge1xuICAgICAgaWYgKGlzUGxhdGZvcm1Ccm93c2VyKHRoaXMucGxhdGZvcm0pKSB7XG4gICAgICAgIGlmICh3aW5kb3cgJiYgd2luZG93LlVSTCkge1xuICAgICAgICAgIGNvbnN0IGZpbGVVcmwgPSBVUkwuY3JlYXRlT2JqZWN0VVJMKHRlbXBsYXRlX2ZpbGUpO1xuICAgICAgICAgIHNhdmVBcyhmaWxlVXJsLCB0ZW1wbGF0ZS50ZW1wbGF0ZV9kb2N1bWVudHNbMF0ubmFtZSArICcucGRmJyk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGdldFRlbXBsYXRlRG9jdW1lbnQodGVtcGxhdGVJZCwgdGVtcGxhdGVEb2N1bWVudCkge1xuICAgIHJldHVybiB0aGlzLmh0dHAuZ2V0KHRoaXMudG9rZW5Db25maWcuckZvcm1fYmFja2VuZF91cmwgKyAnL3RlbXBsYXRlcy8nICsgdGVtcGxhdGVJZCArICcvZG9jdW1lbnRzLycgK1xuICAgICAgdGVtcGxhdGVEb2N1bWVudC5pZCArICc/ZmlsZT10cnVlJywgeyByZXNwb25zZVR5cGU6ICdibG9iJyB9KS50b1Byb21pc2UoKTtcbiAgfVxuXG4gIHVwZGF0ZVRlbXBsYXRlcyh0ZW1wbGF0ZXMpIHtcbiAgICB0aGlzLnRlbXBsYXRlcy5uZXh0KHRlbXBsYXRlcyk7XG4gIH1cblxuICB0b2dnbGVCdWlsZGVyU2lkZU5hdigpIHtcbiAgICB0aGlzLmJ1aWxkZXJTaWRlTmF2U3RhdGUgPSAhdGhpcy5idWlsZGVyU2lkZU5hdlN0YXRlO1xuICAgIHRoaXMuc2lkZU5hdlN0YXRlU3ViamVjdC5uZXh0KHRoaXMuYnVpbGRlclNpZGVOYXZTdGF0ZSk7XG4gICAgaWYgKHRoaXMuYnVpbGRlclNpZGVOYXZTdGF0ZSA9PT0gZmFsc2UpIHtcbiAgICAgIHRoaXMuaW5pdGlhdGVCdWlsZGVyQXV0b2ZvY3VzLm5leHQoZmFsc2UpO1xuICAgIH1cbiAgfVxuXG4gIGNhblVzZXJFZGl0KHRlbXBsYXRlOiBJVGVtcGxhdGUpIHtcbiAgICBjb25zdCByZXNwb25zZSA9IHRoaXMudGVtcGxhdGVHdWFyZC5jYW5QZXJmb3JtQWN0aW9uKFRlbXBsYXRlQWN0aW9ucy5XUklURSwgdGVtcGxhdGUpO1xuICAgIHJldHVybiByZXNwb25zZVsnY2FuUGVyZm9ybSddXG4gIH1cblxuICB1cGRhdGVUZW1wbGF0ZSh0ZW1wbGF0ZUlkOiBzdHJpbmcsIGJvZHkpOiBQcm9taXNlPElUZW1wbGF0ZT4ge1xuICAgIHJldHVybiB0aGlzLmh0dHBcbiAgICAgIC5wdXQ8SVRlbXBsYXRlPih0aGlzLnRva2VuQ29uZmlnLnJGb3JtX2JhY2tlbmRfdXJsICsgJy90ZW1wbGF0ZXMvJyArIHRlbXBsYXRlSWQsIGJvZHkpXG4gICAgICAudG9Qcm9taXNlKCkudGhlbih0ZW1wbGF0ZSA9PiB0ZW1wbGF0ZSk7XG4gIH1cblxuICBvcGVuVGVtcGxhdGUodGVtcGxhdGU6IElUZW1wbGF0ZSkge1xuICAgIGlmICh0aGlzLmNhblVzZXJQcmV2aWV3KHRlbXBsYXRlKSkge1xuICAgICAgbG9jYXRpb24uaHJlZiA9IGAke3RoaXMudG9rZW5Db25maWcuckZvcm1fZnJvbnRlbmRfdXJsfS9kb2N1bWVudC8ke3RlbXBsYXRlLmlkfWA7XG4gICAgfSBlbHNlIGlmICh0aGlzLmNhblVzZXJFZGl0KHRlbXBsYXRlKSkge1xuICAgICAgbG9jYXRpb24uaHJlZiA9IGAke3RoaXMudG9rZW5Db25maWcuckZvcm1fZnJvbnRlbmRfdXJsfS9idWlsZGVyLyR7dGVtcGxhdGUuaWR9L2ZpZWxkc2A7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuc25hY2tiYXIub3BlbihgVGVtcGxhdGUgaXMgaW4gYnVpbGQgbW9kZSwgYW5kIG5vdCByZWFkeSBmb3IgdXNlLiAgUGxlYXNlIGNoZWNrIGJhY2sgc29vbi5gKVxuICAgIH1cbiAgfVxuXG4gIG9wZW5UZW1wbGF0ZXMoc2VhcmNoS2V5d29yZD86IHN0cmluZykge1xuICAgIGlmICh0aGlzLnRva2VuQ29uZmlnLm9yaWdpbiA9PT0gJ3JGb3JtJykge1xuICAgICAgaWYgKHNlYXJjaEtleXdvcmQudHJpbSgpICE9PSAnJykge1xuICAgICAgICB0aGlzLnJvdXRlci5uYXZpZ2F0ZShbJ2RvY3VtZW50cyddLCB7IHF1ZXJ5UGFyYW1zOiB7IG5hbWU6IHNlYXJjaEtleXdvcmQgfSB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucm91dGVyLm5hdmlnYXRlKFsnZG9jdW1lbnRzJ10pO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoc2VhcmNoS2V5d29yZC50cmltKCkgIT09ICcnKSB7XG4gICAgICAgIGxvY2F0aW9uLmhyZWYgPSBgJHt0aGlzLnRva2VuQ29uZmlnLnJGb3JtX2Zyb250ZW5kX3VybH0vZG9jdW1lbnRzP25hbWU9JHtzZWFyY2hLZXl3b3JkfWA7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsb2NhdGlvbi5ocmVmID0gYCR7dGhpcy50b2tlbkNvbmZpZy5yRm9ybV9mcm9udGVuZF91cmx9L2RvY3VtZW50c2A7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0VGVtcGxhdGVPd25lckluZm8oaWQ6IHN0cmluZyk6IFByb21pc2U8eyBwcm9maWxlX2lkOiBzdHJpbmcsIGVtYWlsOiBzdHJpbmcsIG5hbWU6IHN0cmluZyB9PiB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQ8eyBwcm9maWxlX2lkOiBzdHJpbmcsIGVtYWlsOiBzdHJpbmcsIG5hbWU6IHN0cmluZyB9PihgJHt0aGlzLnRva2VuQ29uZmlnLnJGb3JtX2JhY2tlbmRfdXJsfS90ZW1wbGF0ZXMvJHtpZH0/b3duZXJfaW5mbz10cnVlYClcbiAgICAgIC50b1Byb21pc2UoKS50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgICB9KTtcbiAgfVxuXG4gIGNhblVzZXJQcmV2aWV3KHRlbXBsYXRlOiBJVGVtcGxhdGUpIHtcbiAgICBjb25zdCBoYXNQZXJtaXNzaW9uID0gKHRoaXMudGVtcGxhdGVHdWFyZC5jYW5QZXJmb3JtQWN0aW9uKFRlbXBsYXRlQWN0aW9ucy5SRUFELCB0ZW1wbGF0ZSkpLmNhblBlcmZvcm07XG4gICAgbGV0IGNhblByZXZpZXc7XG4gICAgY29uc3Qgcm9sZXMgPSB0ZW1wbGF0ZS5yb2xlcztcbiAgICBjb25zdCBzaWduZXJzID0gZmlsdGVyKHJvbGVzLCB7IHR5cGU6ICdzaWduZXInIH0pO1xuICAgIGNhblByZXZpZXcgPSBzaWduZXJzICYmIHNpZ25lcnMubGVuZ3RoID4gMDtcbiAgICBmb3IgKGNvbnN0IHNpZ25lciBvZiBzaWduZXJzKSB7XG4gICAgICBjYW5QcmV2aWV3ID0gc2lnbmVyWydmaWVsZHMnXSAmJiBzaWduZXJbJ2ZpZWxkcyddLmxlbmd0aCA+IDA7XG4gICAgfVxuICAgIHJldHVybiBoYXNQZXJtaXNzaW9uICYmIGNhblByZXZpZXc7XG4gIH1cblxuICBzdGFyVGVtcGxhdGUoaWQpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCh0aGlzLnRva2VuQ29uZmlnLnJGb3JtX2JhY2tlbmRfdXJsICsgYC90ZW1wbGF0ZXMvJHtpZH0vc3RhcnNgLCB7fSkucGlwZShcbiAgICAgIGNhdGNoRXJyb3IoZXJyID0+IHtcbiAgICAgICAgaWYgKGVyciAmJiBlcnIuc3RhdHVzID09PSA0MDEpIHtcbiAgICAgICAgICBjb25zdCBlcnJvckRpYWxvZyA9IHRoaXMuZGlhbG9nLm9wZW4oRm91ck9oT25lRGlhbG9nLCB7XG4gICAgICAgICAgICBwYW5lbENsYXNzOiAnZXJyb3JfX2RpYWxvZycsXG4gICAgICAgICAgICBkaXNhYmxlQ2xvc2U6IHRydWVcbiAgICAgICAgICB9KVxuICAgICAgICAgIGVycm9yRGlhbG9nLmNvbXBvbmVudEluc3RhbmNlLmVycm9yID0gZXJyO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBFTVBUWVxuICAgICAgfSksXG4gICAgICBtYXAocmVzID0+IHJlcylcbiAgICApO1xuICB9XG5cbiAgdW5zdGFyVGVtcGxhdGUoaWQpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgIHJldHVybiB0aGlzLmh0dHAuZGVsZXRlKHRoaXMudG9rZW5Db25maWcuckZvcm1fYmFja2VuZF91cmwgKyBgL3RlbXBsYXRlcy8ke2lkfS9zdGFyc2ApLnBpcGUoXG4gICAgICBjYXRjaEVycm9yKGVyciA9PiB7XG4gICAgICAgIGlmIChlcnIgJiYgZXJyLnN0YXR1cyA9PT0gNDAxKSB7XG4gICAgICAgICAgY29uc3QgZXJyb3JEaWFsb2cgPSB0aGlzLmRpYWxvZy5vcGVuKEZvdXJPaE9uZURpYWxvZywge1xuICAgICAgICAgICAgcGFuZWxDbGFzczogJ2Vycm9yX19kaWFsb2cnLFxuICAgICAgICAgICAgZGlzYWJsZUNsb3NlOiB0cnVlXG4gICAgICAgICAgfSlcbiAgICAgICAgICBlcnJvckRpYWxvZy5jb21wb25lbnRJbnN0YW5jZS5lcnJvciA9IGVycjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gRU1QVFlcbiAgICAgIH0pLFxuICAgICAgbWFwKHJlcyA9PiByZXMpXG4gICAgKTtcbiAgfVxuXG4gIC8vQWNjb3VudCBTZXJ2aWNlc1xuICBhc3luYyB1cGRhdGVUb2tlbnMoc2VuZE1lc3NhZ2U/OiBib29sZWFuKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHRoaXMudlRva2VuU3RhdGVTZXJ2aWNlLnVwZGF0ZVRva2Vucyh0aGlzLnRva2VuQ29uZmlnLnJTZWN1cmVfYmFja2VuZF91cmwpLnN1YnNjcmliZSh0b2tlbnMgPT4ge1xuICAgICAgICBpZiAodG9rZW5zICYmIHRva2Vucy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgaWYgKHNlbmRNZXNzYWdlKSB7XG4gICAgICAgICAgICB0aGlzLnNuYWNrYmFyLmRpc21pc3MoKTtcbiAgICAgICAgICAgIHRoaXMuc25hY2tiYXIub3BlbignU3RhdHVzIHVwZGF0ZWQnKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5nZXRBY2NvdW50RGF0YSgpO1xuICAgICAgICByZXR1cm4gcmVzb2x2ZSgpO1xuICAgICAgfSlcbiAgICB9KTtcbiAgfVxuXG4gIGdldEFjY291bnREYXRhKCkge1xuICAgIC8vIG1pZ2h0IG5lZWQgaWYgaGVhZGVyIG5lZWRzIHRvIHNob3cgY29uZGl0aW9uXG4gICAgY29uc3QgcHJvZmlsZSA9IHRoaXMudlRva2VuT2JqZWN0U2VydmljZS5nZXRQcm9maWxlKCk7XG4gICAgaWYgKHByb2ZpbGUpIHtcbiAgICAgIHRoaXMuZ2V0UHJvZmlsZXMoKTtcbiAgICB9XG4gIH1cblxuICBnZXRQcm9maWxlcygpIHtcbiAgICByZXR1cm4gdGhpcy5odHRwLmdldCh0aGlzLnRva2VuQ29uZmlnLnJBY2NvdW50X2JhY2tlbmRfdXJsICsgJy9wcm9maWxlcycpLnRvUHJvbWlzZSgpLnRoZW4oKHJlczogYW55W10pID0+IHtcbiAgICAgIGNvbnN0IHBlcnNvbmFsID0gcmVzLnNwbGljZShmaW5kSW5kZXgocmVzLCBwID0+IHAub3JnYW5pemF0aW9uLm5hbWUgPT09ICdyZWFsc3RlcicpLCAxKTtcbiAgICAgIHRoaXMucGVyc29uYWxBY2NvdW50U3ViamVjdC5uZXh0KHBlcnNvbmFsWzBdKTtcbiAgICAgIHRoaXMucHJvZmlsZURhdGEgPSByZXMuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICBpZiAoYS5vcmdhbml6YXRpb24ubmFtZSA8IGIub3JnYW5pemF0aW9uLm5hbWUpIHtcbiAgICAgICAgICByZXR1cm4gLTE7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGEub3JnYW5pemF0aW9uLm5hbWUgPiBiLm9yZ2FuaXphdGlvbi5uYW1lKSB7XG4gICAgICAgICAgcmV0dXJuIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgICB9KTtcbiAgICAgIHRoaXMucHJvZmlsZURhdGEudW5zaGlmdChwZXJzb25hbFswXSk7XG4gICAgICBjb25zdCBjdXJyZW50SW5kZXggPSBmaW5kSW5kZXgodGhpcy5wcm9maWxlRGF0YSwgeyBjdXJyZW50OiB0cnVlIH0pO1xuICAgICAgaWYgKHRoaXMucHJvZmlsZURhdGFbY3VycmVudEluZGV4XVsnZmlyc3RfbmFtZSddKSB7XG4gICAgICAgIHRoaXMudXNlckZ1bGxuYW1lID0gdGhpcy5wcm9maWxlRGF0YVtjdXJyZW50SW5kZXhdWydmaXJzdF9uYW1lJ10gKyAnICcgKyB0aGlzLnByb2ZpbGVEYXRhW2N1cnJlbnRJbmRleF1bJ2xhc3RfbmFtZSddO1xuICAgICAgICB0aGlzLnVzZXJJbml0aWFsID0gdGhpcy5wcm9maWxlRGF0YVtjdXJyZW50SW5kZXhdWydmaXJzdF9uYW1lJ10uY2hhckF0KDApICtcbiAgICAgICAgICB0aGlzLnByb2ZpbGVEYXRhW2N1cnJlbnRJbmRleF1bJ2xhc3RfbmFtZSddLmNoYXJBdCgwKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMudXNlckZ1bGxuYW1lID0gJyc7XG4gICAgICB9XG4gICAgICBpZiAodGhpcy5wcm9maWxlRGF0YVtjdXJyZW50SW5kZXhdWydwaG9uZSddKSB7XG4gICAgICAgIHRoaXMudXNlclBob25lID0gdGhpcy5wcm9maWxlRGF0YVtjdXJyZW50SW5kZXhdWydwaG9uZSddO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy51c2VyUGhvbmUgPSAnJztcbiAgICAgIH1cbiAgICAgIGlmICh0aGlzLnByb2ZpbGVEYXRhW2N1cnJlbnRJbmRleF1bJ2VtYWlsJ10pIHtcbiAgICAgICAgdGhpcy51c2VyRW1haWwgPSB0aGlzLnByb2ZpbGVEYXRhW2N1cnJlbnRJbmRleF1bJ2VtYWlsJ107XG4gICAgICB9XG4gICAgICB0aGlzLnVzZXJEYXRhID0ge1xuICAgICAgICBuYW1lOiB0aGlzLnVzZXJGdWxsbmFtZSxcbiAgICAgICAgaW5pdGlhbDogdGhpcy51c2VySW5pdGlhbCxcbiAgICAgICAgZW1haWw6IHRoaXMudXNlckVtYWlsLFxuICAgICAgICBwaG9uZTogdGhpcy51c2VyUGhvbmVcbiAgICAgIH07XG4gICAgICB0aGlzLnVzZXJQcm9maWxlU3ViamVjdC5uZXh0KHRoaXMucHJvZmlsZURhdGEpO1xuICAgICAgY29uc3QgY3VycmVudFByb2ZpbGUgPSB0aGlzLnByb2ZpbGVEYXRhW2N1cnJlbnRJbmRleF07XG4gICAgICB0aGlzLmN1cnJlbnRQcm9maWxlU3ViamVjdC5uZXh0KGN1cnJlbnRQcm9maWxlKTtcbiAgICAgIHRoaXMuY3VycmVudE9yZ2FuaXphdGlvbklkID0gY3VycmVudFByb2ZpbGUub3JnYW5pemF0aW9uX2lkO1xuICAgICAgdGhpcy51c2VyRGF0YVN1YmplY3QubmV4dCh0aGlzLnVzZXJEYXRhKTtcbiAgICAgIHJldHVybiB0aGlzLnVzZXJEYXRhO1xuICAgIH0pO1xuICB9XG5cbiAgZ2V0UHJvZmlsZUNvbGxlY3Rpb24ocHJvZmlsZXMpIHtcbiAgICBjb25zdCBwcm9maWxlTW9kZWxzOiBQcm9maWxlTW9kZWxbXSA9IFtdO1xuICAgIHByb2ZpbGVzLmZvckVhY2gocHJvZmlsZSA9PiB7XG4gICAgICBwcm9maWxlTW9kZWxzLnB1c2gobmV3IFByb2ZpbGVNb2RlbChwcm9maWxlKSk7XG4gICAgfSk7XG4gICAgY29uc3QgcHJvZmlsZUNvbGxlY3Rpb24gPSBuZXcgUHJvZmlsZUNvbGxlY3Rpb24ocHJvZmlsZU1vZGVscyk7XG4gICAgcmV0dXJuIHByb2ZpbGVDb2xsZWN0aW9uO1xuICB9XG5cbiAgc3dpdGNoUHJvZmlsZShwcm9maWxlX2lkKSB7XG4gICAgdGhpcy5wcm9maWxlTG9hZGluZ1N1YmplY3QubmV4dCh0cnVlKTtcbiAgICByZXR1cm4gdGhpcy5odHRwLnBvc3QodGhpcy50b2tlbkNvbmZpZy5yQWNjb3VudF9iYWNrZW5kX3VybCArICcvcHJvZmlsZXMvJyArIHByb2ZpbGVfaWQgKyAnL3N3aXRjaCcsIG51bGwpLnRvUHJvbWlzZSgpLnRoZW4oYXN5bmMgKHJlczogYW55KSA9PiB7XG4gICAgICB0aGlzLnZUb2tlblN0YXRlU2VydmljZS5zZXRUb2tlbnMocmVzLnRva2Vucyk7XG4gICAgICB0aGlzLnByb2ZpbGVMb2FkaW5nU3ViamVjdC5uZXh0KGZhbHNlKTtcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzKTtcbiAgICB9KTtcbiAgfVxuXG4gIHJlc2VuZEVtYWlsVmVyaWZpY2F0aW9uKCkge1xuICAgIHRoaXMuaHR0cC5wb3N0KHRoaXMudG9rZW5Db25maWcuclNlY3VyZV9iYWNrZW5kX3VybCArICcvdXNlci9lbWFpbF92ZXJpZmljYXRpb24nLCBudWxsKS50b1Byb21pc2UoKS50aGVuKCgpID0+IHtcbiAgICAgIHRoaXMuc25hY2tiYXIub3BlbignVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnQnKTtcbiAgICB9KTtcbiAgfVxuXG4gIGdldE5hbWVWYWxpZGl0eShuYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMuaHR0cC5nZXQodGhpcy50b2tlbkNvbmZpZy5yQWNjb3VudF9iYWNrZW5kX3VybCArICcvb3JnYW5pemF0aW9ucy9pc192YWxpZD9uYW1lPScgKyBuYW1lLCB0aGlzLmdldE9wdGlvbnMoKSlcbiAgICAgIC50b1Byb21pc2UoKVxuICAgICAgLnRoZW4ocmVzID0+IHtcbiAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShyZXMpO1xuICAgICAgfSk7XG4gIH1cblxuICBjcmVhdGVPcmdhbml6YXRpb24oYm9keSkge1xuICAgIHJldHVybiB0aGlzLmh0dHAucG9zdCh0aGlzLnRva2VuQ29uZmlnLnJBY2NvdW50X2JhY2tlbmRfdXJsICsgJy9vcmdhbml6YXRpb25zJywgYm9keSwgdGhpcy5nZXRPcHRpb25zKCkpXG4gICAgICAudG9Qcm9taXNlKClcbiAgICAgIC50aGVuKHJlcyA9PiB7XG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUocmVzKTtcbiAgICAgIH0pO1xuICB9XG5cbiAgcHJpdmF0ZSBnZXRPcHRpb25zKCk6IGFueSB7XG4gICAgaWYgKGlzUGxhdGZvcm1TZXJ2ZXIodGhpcy5wbGF0Zm9ybSkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgdlRva2VuQ29va2llID0gdGhpcy52VG9rZW5TdGF0ZVNlcnZpY2UuZ2V0T3RoZXJDb29raWVPYmplY3QoJ3JBY2NvdW50X1ZlcmRvY3MnKTtcbiAgICBjb25zdCBhdXRoVmFsdWUgPSAnQmVhcmVyICcgKyB2VG9rZW5Db29raWVbJ2FjY2Vzc1Rva2VuJ107XG4gICAgY29uc3QgaGVhZGVycyA9IG5ldyBIdHRwSGVhZGVycyh7XG4gICAgICAnQ2FjaGUtQ29udHJvbCc6ICduby1jYWNoZScsXG4gICAgICAnUHJhZ21hJzogJ25vLWNhY2hlJyxcbiAgICAgICdFeHBpcmVzJzogJ1NhdCwgMDEgSmFuIDIwMDAgMDA6MDA6MDAgR01UJyxcbiAgICAgICdJZi1Nb2RpZmllZC1TaW5jZSc6ICcwJyxcbiAgICAgICdDb250ZW50LVR5cGUnOiAnYXBwbGljYXRpb24vanNvbicsXG4gICAgICAnQXV0aG9yaXphdGlvbic6IGF1dGhWYWx1ZSxcbiAgICAgICdBY2NlcHQnOiAnYXBwbGljYXRpb24vanNvbidcbiAgICB9KTtcbiAgICByZXR1cm4geyBoZWFkZXJzIH07XG4gIH1cblxuICAvLyBFbmQgb2YgQWNjb3VudCBTZXJ2aWNlc1xuXG4gIGdldFJvbGVDb2xvcihuYW1lLCBpbmRleD8pIHtcbiAgICBpZiAoaW5kZXgpIHtcbiAgICAgIHJldHVybiB0aGlzLmdldFJHQkEoaW5kZXgpO1xuICAgIH0gZWxzZSBpZiAodGhpcy50ZW1wbGF0ZSAmJiB0aGlzLnRlbXBsYXRlLnJvbGVzICYmIHRoaXMudGVtcGxhdGUucm9sZXMubGVuZ3RoID4gMCkge1xuICAgICAgaW5kZXggPSBmaW5kSW5kZXgodGhpcy50ZW1wbGF0ZS5yb2xlcywgeyBuYW1lOiBuYW1lIH0pO1xuICAgICAgaWYgKGluZGV4ID49IDApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMudGVtcGxhdGUucm9sZXNbaW5kZXhdLnJnYmEgPyB0aGlzLnRlbXBsYXRlLnJvbGVzW2luZGV4XS5yZ2JhIDogdGhpcy5nZXRSR0JBKGluZGV4KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHJldHVybiB0aGlzLm5hbWVUb1JHQkEobmFtZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiB0aGlzLm5hbWVUb1JHQkEobmFtZSk7XG4gICAgfVxuICB9XG5cbiAgZ2V0UkdCKHJnYmEpIHtcbiAgICBjb25zdCByZ2JOdW1iZXJzID0gcmdiYS5yZXBsYWNlKCdyZ2JhKCcsICcnKS5yZXBsYWNlKCcpJywgJycpLnNwbGl0KCcsJyk7XG4gICAgY29uc3QgcmdiT2JqZWN0ID0ge1xuICAgICAgcmVkOiByZ2JOdW1iZXJzWzBdLFxuICAgICAgZ3JlZW46IHJnYk51bWJlcnNbMV0sXG4gICAgICBibHVlOiByZ2JOdW1iZXJzWzJdLFxuICAgICAgYWxwaGE6IHJnYk51bWJlcnNbM11cbiAgICB9O1xuICAgIGNvbnN0IGFscGhhID0gMSAtIHJnYk9iamVjdC5hbHBoYTtcbiAgICBjb25zdCByZWQgPSBNYXRoLnJvdW5kKChyZ2JPYmplY3QuYWxwaGEgKiAocmdiT2JqZWN0LnJlZCAvIDI1NSkgKyBhbHBoYSkgKiAyNTUpO1xuICAgIGNvbnN0IGdyZWVuID0gTWF0aC5yb3VuZCgocmdiT2JqZWN0LmFscGhhICogKHJnYk9iamVjdC5ncmVlbiAvIDI1NSkgKyBhbHBoYSkgKiAyNTUpO1xuICAgIGNvbnN0IGJsdWUgPSBNYXRoLnJvdW5kKChyZ2JPYmplY3QuYWxwaGEgKiAocmdiT2JqZWN0LmJsdWUgLyAyNTUpICsgYWxwaGEpICogMjU1KTtcbiAgICByZXR1cm4gKCcjJyArIHRoaXMucmdiVG9IZXgocmVkKSArIHRoaXMucmdiVG9IZXgoZ3JlZW4pICsgdGhpcy5yZ2JUb0hleChibHVlKSk7XG4gIH1cblxuICByZ2JUb0hleChyZ2I6IG51bWJlcikge1xuICAgIGNvbnN0IGhleCA9IHJnYi50b1N0cmluZygxNik7XG4gICAgaWYgKGhleC5sZW5ndGggPCAyKSB7XG4gICAgICByZXR1cm4gJzAnICsgaGV4O1xuICAgIH1cbiAgICByZXR1cm4gaGV4O1xuICB9XG5cbiAgZ2V0UkdCQShpbmRleCkge1xuICAgIHN3aXRjaCAoaW5kZXggJSAxMCkge1xuICAgICAgY2FzZSAwOlxuICAgICAgICByZXR1cm4gaW5kZXggPT09IDAgPyAncmdiYSgyNTUsIDE5MywgNywgMC40KScgOiAncmdiYSgxMzQsIDEzNCwgMTM0LCAwLjMpJzsgLy8jRkZFNjlDXG4gICAgICBjYXNlIDE6XG4gICAgICAgIHJldHVybiAncmdiYSgxNTYsIDM5LCAxNzYsIC40KSc7IC8vJyNFM0MzRTknXG4gICAgICBjYXNlIDI6XG4gICAgICAgIHJldHVybiAncmdiYSgzMywgMTUwLCAyNDMsIC40KSc7IC8vJyNDMUUxRkInXG4gICAgICBjYXNlIDM6XG4gICAgICAgIHJldHVybiAncmdiYSgyMjAsIDIzMSwgMTE3LCAwLjMpJztcbiAgICAgIGNhc2UgNDpcbiAgICAgICAgcmV0dXJuICdyZ2JhKDEyMSwgMTM0LCAyMDMsIDAuMyknO1xuICAgICAgY2FzZSA1OlxuICAgICAgICByZXR1cm4gJ3JnYmEoNzcsIDE4MiwgMTcyLCAwLjMpJztcbiAgICAgIGNhc2UgNjpcbiAgICAgICAgcmV0dXJuICdyZ2JhKDI1NSwgMjAyLCAxNjUsIDAuMyknO1xuICAgICAgY2FzZSA3OlxuICAgICAgICByZXR1cm4gJ3JnYmEoMiwgMjQ3LCAxOTAsIDAuMyknO1xuICAgICAgY2FzZSA4OlxuICAgICAgICByZXR1cm4gJ3JnYmEoMjU1LCAxMzgsIDEwMSwgMC4zKSc7XG4gICAgICBjYXNlIDk6XG4gICAgICAgIHJldHVybiAncmdiYSg4MiwgMjU1LCA3OSwgMC4zKSc7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICByZXR1cm4gJ3JnYmEoMjI5LCAxMTUsIDE1NSwgMC4zKSc7XG4gICAgfVxuICB9XG5cbiAgbmFtZVRvUkdCQShzdHIpIHtcbiAgICBpZiAoISFzdHIpIHtcbiAgICAgIGNvbnN0IHZhbGlkTnVtID0gcGFyc2VJbnQoc3RyLnNsaWNlKC0xKSwgMTApO1xuICAgICAgaWYgKCFpc05hTih2YWxpZE51bSkpIHtcbiAgICAgICAgc3RyICs9ICh2YWxpZE51bSAqIDk5KS50b1N0cmluZygpO1xuICAgICAgfVxuICAgICAgbGV0IGhhc2ggPSAwO1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaGFzaCA9IHN0ci5jaGFyQ29kZUF0KGkpICsgKChoYXNoIDw8IDUpIC0gaGFzaCk7XG4gICAgICB9XG4gICAgICBoYXNoID0gTWF0aC5yb3VuZChoYXNoIC8gMS4zKTtcbiAgICAgIGNvbnN0IGMgPSAoaGFzaCAmIDB4MDBGRkZGMDgpXG4gICAgICAgIC50b1N0cmluZygxNilcbiAgICAgICAgLnRvVXBwZXJDYXNlKCk7XG4gICAgICBjb25zdCBoZXggPSAnIycgKyAnMDAwMDAnLnN1YnN0cmluZygwLCA2IC0gYy5sZW5ndGgpICsgYztcbiAgICAgIGNvbnN0IHJlc3VsdCA9IC9eIz8oW2EtZlxcZF17Mn0pKFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkkL2kuZXhlYyhoZXgpO1xuICAgICAgY29uc3QgY29sb3IgPSB7XG4gICAgICAgIHI6IHBhcnNlSW50KHJlc3VsdFsxXSwgMTYpLFxuICAgICAgICBnOiBwYXJzZUludChyZXN1bHRbMl0sIDE2KSxcbiAgICAgICAgYjogcGFyc2VJbnQocmVzdWx0WzNdLCAxNilcbiAgICAgIH07XG4gICAgICByZXR1cm4gYHJnYmEoJHtjb2xvci5yfSwgJHtjb2xvci5nfSwgJHtjb2xvci5ifSwgMC4yKWA7XG4gICAgfVxuICB9XG59XG4iXX0=