{"version":3,"sources":["../../../../node_modules/tslib/tslib.es6.js","ng://@verdocs/header/lib/models/verdocs.model.ts","ng://@verdocs/header/lib/services/templates.guard.ts","ng://@verdocs/header/lib/error-dialogs/four-oh-one.dialog.ts","ng://@verdocs/header/lib/services/header.service.ts","ng://@verdocs/header/lib/template/recipients/recipients-editor.component.ts","ng://@verdocs/header/lib/template/source-file/source-file.component.ts","ng://@verdocs/header/lib/template/visibility/visibility-editor.component.ts","ng://@verdocs/header/lib/header.component.ts","ng://@verdocs/header/lib/components/header-tools.component.ts","ng://@verdocs/header/lib/header.module.ts"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","throw","return","Symbol","iterator","this","n","v","op","TypeError","call","pop","length","push","__values","o","m","i","CREATOR","ORGANIZATION_MEMBER","ORGANIZATION_MEMBER_AS_CREATOR","EVERYONE","EVERYONE_AS_CREATOR","TEMPLATE_CREATOR_CREATE_PUBLIC","TEMPLATE_CREATOR_CREATE_ORG","TEMPLATE_CREATOR_CREATE_PERSONAL","TEMPLATE_CREATOR_DELETE","TEMPLATE_CREATOR_VISIBILITY","TEMPLATE_MEMBER_READ","TEMPLATE_MEMBER_WRITE","TEMPLATE_MEMBER_DELETE","TEMPLATE_MEMBER_VISIBILITY","CREATE_PERSONAL","CREATE_ORG","CREATE_PUBLIC","READ","WRITE","DELETE","CHANGE_VISIBILITY_PERSONAL","CHANGE_VISIBILITY_ORG","CHANGE_VISIBILITY_PUBLIC","TemplatesGuardService","vTokenObjectService","prototype","canPerformAction","action","template","canPerform","message","neededPermissions","includes","error","userProfile","getProfile","isCreator","profile_id","id","isSameOrg","organization_id","isPersonal","is_personal","isPublic","is_public","TemplateActions","TemplatePermissions","hasPermissions","toString","err","console","requiredPermissions","userPermissions","getPermissions","intersection","canBeSender","sender","TemplateSenderTypes","canUserCreateTemplate","Injectable","VerdocsTokenObjectService","FourOhOneDialog","router","verdocsTokenObjectService","injector","currentProfile","error_code","error_title","error_message","tokenConfig","get","connectionConfigToken","rSecureUrl","rSecure_frontend_url","rFormUrl","rForm_frontend_url","ngOnInit","hasOwnProperty","code","prepareErroContent","goToDashboard","navigate","signIn","window","location","href","url","signUp","Component","args","selector","Router","Injector","VerdocsHeaderService","http","snackbar","dialog","templateGuard","vTokenStateService","platform","titleSubject","ReplaySubject","csvBlobSubject","templates","Subject","saveStatusSubject","templateDetailToggleSubject","profileLoadingSubject","templateSubject","allEnvelopes","BehaviorSubject","sideNavStateSubject","initiateBuilderAutofocus","createToggleSubscription","_toggleSidenavSource","_title","_selected","_pdfUrl","_env","template_id","status","user_id","envelope_document_id","_envDoc","name","page_numbers","mime","userFullname","userInitial","userEmail","userPhone","userData","initial","email","phone","isAtOrigin","currentOrganizationId","sidenavOpened","toggleSidenav$","asObservable","selectStatus$","env$","titleValue$","pdfUrl$","envDoc$","userDataSubject","userProfileSubject","currentProfileSubject","personalAccountSubject","profilesSubject","envUrl","rForm_backend_url","rForm_url","rAccount_url","rAccount_frontend_url","rSecure_url","getAtOrigin","originType","origin","toggleSidenav","bool","updateToggleStatus","updateTitle","string","updateSelectStatus","updatePdfUrl","updateEnv","updateEnvDoc","IEnvelopeDocument","initNotificationService","updateEnvelopes","envelopes","toggleCreate","searchEnvelopes","searchParams","_this","key","request","HttpRequest","reportProgress","responseType","pipe","map","event","HttpResponse","searchTemplates","downloadTemplateDocument","getTemplateDocument","template_documents","template_file","isPlatformBrowser","URL","fileUrl","createObjectURL","saveAs","templateId","templateDocument","toPromise","updateTemplates","toggleBuilderSideNav","builderSideNavState","canUserEdit","updateTemplate","put","openTemplate","canUserPreview","open","openTemplates","searchKeyword","trim","queryParams","getTemplateOwnerInfo","res","canPreview","hasPermission","roles","signers","filter","type","signers_1","tslib_1.__values","signers_1_1","signer","starTemplate","post","catchError","panelClass","disableClose","componentInstance","EMPTY","unstarTemplate","delete","updateTokens","sendMessage","rSecure_backend_url","subscribe","tokens","dismiss","getAccountData","getProfiles","rAccount_backend_url","personal","splice","findIndex","p","organization","profileData","sort","a","b","unshift","currentIndex","current","charAt","getProfileCollection","profiles","profileModels","forEach","profile","ProfileModel","ProfileCollection","switchProfile","setTokens","resendEmailVerification","getNameValidity","getOptions","createOrganization","isPlatformServer","authValue","getOtherCookieObject","headers","HttpHeaders","Cache-Control","Pragma","Expires","If-Modified-Since","Content-Type","Authorization","Accept","getRoleColor","index","getRGBA","rgba","nameToRGBA","getRGB","rgbNumbers","replace","split","rgbObject","alpha","red","Math","round","green","blue","rgbToHex","rgb","hex","str","validNum","parseInt","slice","isNaN","hash","charCodeAt","c","toUpperCase","substring","exec","color","r","providedIn","HttpClient","MatSnackBar","MatDialog","VerdocsStateService","Inject","PLATFORM_ID","RecipientEditorComponent","verdocsHeaderService","sender_name","ngOnChanges","prepareSender","prepareExistingRoles","updateSenderName","_a","ownerInfo","first_name","last_name","recipients","sequence","setStyles","roleIndex","sequenceIndex","undefined","role","full_name","border","background-color","background","Input","TemplateSourceComponent","templatesService","changes","VisibilityEditorComponent","updateVisibility","isSaving","isEditMode","_canShareWithOrg","_canMakeItPrivate","_canShareWithPublic","template_visibility","getTemplateVisibility","ngOnDestroy","visibility","setUpdateVisibility","original_visibility","saveChanges","Object","defineProperty","canMakeItPrivate","canShareWithOrg","canShareWithPublic","HeaderComponent","vAuthService","cdr","compiler","pageLoading","isAuthenticated","headerTitle","mode","searchActive","templateName","newTemplateName","saveStatus","notifications","loading","csvBlob","templateDetailsExpanded","isSearching","inputFocused","isLiveView","app_version","currentAt","_canStar","_canCreate","_canEdit","_userStarred","metaDataSubscription","Subscription","titleSubscription","titleInputSubscription","titleKeyDownSubscription","templateNameSubscription","templateSubscription","saveStatusSubscription","profileLoadingSubscription","userDataSubscription","modeSubscription","previewInputSubscription","generalInputSubscription","navigationEventSubscription","csvBlobSubscription","connections","myAccountUrl","termsUrl","privacyUrl","organizationImgSrc","verdocs_url","manageLink","templatesLink","rSecureFrontEnd","rFormFrontEnd","currentOrigin","updateStar","protocol","hostname","port","emailVerified","getEmailVerification","events","NavigationEnd","isAtOriginalOrigin","image_url","checkCanStar","NavigationStart","title","blob","ngAfterViewChecked","detectChanges","unsubscribe","clearCache","init","getIDToken","previewInputEvent","clearTimeout","inputTimer","setTimeout","getSearchResults","previewInput","nativeElement","generalInputEvent","generalInput","prepareSearchInput","listenForPreviewInput","listenForGeneralInput","fromEvent","debounceTime","distinctUntilChanged","keyName","response","permissions","getVerdocsPermissions","permission","selected","option","_element","click","search_string","envelope_name","row","envelopeResult","templateResult","recipientTracking","item","toggleMenu","sidenavOpen","setInputFocused","hasProp","obj","roleColor","toggleTemplateDetails","reset","getRoleNames","last_index","names_string","x","getTemplateStats","getTemplatePages","getTemplateSequence","getTemplateRecipients","pages","hasPreparer","maxSequence","totalSequence","totalRecipients","goToEnvelope","envelope_id","clearSearchInputs","goToTemplate","goToTemplates","keyword","getSearchKeyword","searchRecipients","recipient_name","template_stars","existingStarIndex","canStar","createTemplate","removedStarIndex","editTemplate","canEdit","VerdocsAuthService","ChangeDetectorRef","Compiler","ViewChild","static","HeaderToolsComponent","verdocsStateService","verdocsObjectService","verdocsAuthGuardService","organizationDialogService","notificationsService","apps","profileLoading","hasProfile","profileOverride","top","right","sidenav","notificationsSubscription","loginUrl","signupUrl","verdocs_logo_url","checkEmailVerification","newProfile","setNewProfile","Notificatations","ngAfterContentChecked","innerWidth","setEmailVerified","hasAccessToAdmin","removeNotification","notification","dismissNotification","signOut","switch","switchAndGoToAdmin","updateTokenStatus","createSnackbar","checkNameValidity","setNameValidation","organizationGroup","checkAccess","clientName","hasAccessTo","jumpTo","getRAccountRoles","buttonTitle","snackbarConfig","verticalPosition","horizontalPosition","duration","lunchElevio","lunchIntercom","VerdocsAuthGuardService","OrganizationDialogService","NotificationService","InjectionToken","HeaderModule","initVerdocsHeader","config","ngModule","providers","provide","useValue","NgModule","declarations","entryComponents","imports","CommonModule","FormsModule","HttpClientModule","RouterModule","ReactiveFormsModule","MatSnackBarModule","MatIconModule","MatAutocompleteModule","MatButtonModule","MatSelectModule","MatDialogModule","MatChipsModule","MatProgressSpinnerModule","MatRadioModule","MatTooltipModule","NotificationsModule","ProfilesModule","TokensModule","exports","created_at","updated_at","canceled_at","envelope_status","CREATED_AT","UPDATED_AT","NAME","LAST_USED_AT","COUNTER","STAR_COUNTER"],"mappings":"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","sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","export interface ITemplate {\n  template_documents?: ITemplateDocument[];\n  pages?: IPage[];\n  roles?: IRole[];\n  counter?: number;\n  name: string;\n  id?: string;\n  profile_id?: string;\n  created_at?: Date;\n  updated_at?: Date;\n  token?: string;\n  tags?: any[];\n  description?: string;\n  reminder_id?: string;\n  reminder?: object;\n  template_stars?: any[];\n  organization_id?: string;\n  is_personal?: boolean;\n  is_public?: boolean;\n  sender?: TemplateSenderTypes;\n  last_used?: { at: string }[];\n}\n\nexport interface Envelope {\n  id?: string;\n  template_id: string;\n  status?: string;\n  user_id: string;\n  envelope_document_id: string;\n  created_at?: Date;\n  updated_at?: Date;\n  canceled_at?: Date;\n  recipients?: Recipient[];\n  document?: IEnvelopeDocument;\n  component?: EnvelopeComponent;\n  histories?: IEnvelopeHistory[];\n}\n\nexport enum TemplateSenderTypes {\n  CREATOR = 'creator', // same as legacy\n  ORGANIZATION_MEMBER = 'organization_member',\n  ORGANIZATION_MEMBER_AS_CREATOR = 'organization_member_as_creator',\n  EVERYONE = 'everyone',\n  EVERYONE_AS_CREATOR = 'everyone_as_creator' // Creator would be sender of envelope no matter who creates the envelope\n}\n\nexport enum TemplatePermissions {\n  TEMPLATE_CREATOR_CREATE_PUBLIC = 'template:creator:create:public',\n  TEMPLATE_CREATOR_CREATE_ORG = 'template:creator:create:org',\n  TEMPLATE_CREATOR_CREATE_PERSONAL = 'template:creator:create:personal',\n  TEMPLATE_CREATOR_DELETE = 'template:creator:delete',\n  TEMPLATE_CREATOR_VISIBILITY = 'template:creator:visibility',\n  TEMPLATE_MEMBER_READ = 'template:member:read',\n  TEMPLATE_MEMBER_WRITE = 'template:member:write',\n  TEMPLATE_MEMBER_DELETE = 'template:member:delete',\n  TEMPLATE_MEMBER_VISIBILITY = 'template:member:visibility'\n};\n\nexport enum TemplateActions {\n  CREATE_PERSONAL = 'create_personal',\n  CREATE_ORG = 'create_org',\n  CREATE_PUBLIC = 'create_public',\n  READ = 'read',\n  WRITE = 'write',\n  DELETE = 'delete',\n  CHANGE_VISIBILITY_PERSONAL = 'change_visibility_personal',\n  CHANGE_VISIBILITY_ORG = 'change_visibility_org',\n  CHANGE_VISIBILITY_PUBLIC = 'change_visibility_public'\n}\n\nexport interface IRole {\n  id?: string;\n  template_id: string;\n  name: string;\n  full_name?: string;\n  old_name?: string;\n  email?: string;\n  type: string;\n  sequence: number;\n  fields?: IField[];\n  message?: string;\n  rgba?: string;\n  delegator: boolean;\n}\n\nexport interface IPage {\n  template_id: string;\n  document_id: string;\n  document?: ITemplateDocument;\n  sequence: number;\n  page_number: number;\n  thumbnail_url?: string;\n  thumbnail_safe?: any;\n  fields?: IField[];\n}\n\nexport interface IField {\n  label: string;\n  name: string;\n  role_name: string;\n  template_id: string;\n  type: string;\n  required: boolean;\n  setting: Object;\n  page_sequence: number;\n  validator?: string;\n}\n\nexport interface ITemplateDocument {\n  url: string;\n  name: string;\n  page_numbers: number;\n  id?: string;\n  updated_at?: Date;\n  created_at?: Date;\n  template_id: string;\n  thumbnail_url: string;\n  thumbnail_safe?: any;\n  mime: string;\n}\n\nexport interface IEnvelopeDocument {\n  id?: string;\n  url: string;\n  name: string;\n  created_at?: Date;\n  updated_at?: Date;\n  page_numbers: number;\n  mime: string;\n}\n\nexport interface IEnvelopeHistory {\n  id?: string;\n  envelope_id?: string;\n  role_name?: string;\n  event: string;\n  event_detail?: string;\n  created_at: Date;\n}\n\nexport interface IActivity {\n  date: string;\n  log: string;\n  icon: string;\n}\n\nexport interface Recipient {\n  role_name: string;\n  envelope_id: string;\n  status: string;\n  email: string;\n  full_name: string;\n  sequence: number;\n  type: string;\n  user_id: string;\n  created_at: Date;\n  updated_at: Date;\n  token: string;\n  message: string;\n  signatureUrl?: any,\n  signatures: IEnvelopeSignature[],\n  rgba?: string\n}\n\nexport interface IEnvelopeSignature {\nenvelope_id: string;\nsignature_id: string;\nrole_name: string;\nsigned_at?: Date;\nip_address?: string;\nhash?: string;\n}\n\nexport interface EnvelopeComponent {\n  progress?: number;\n  status_color?: string;\n  selected_format_time?: string;\n  format_time?: string;\n  selected?: boolean;\n  envelope__list__class?: string;\n}\n\nexport interface IEnvelopeSearchParams {\n  envelope_status?: string[];\n  recipient_status?: string[];\n  envelope_name?: string;\n  recipient_name?: string;\n  recipient_email?: string;\n  updated_at?: ITimePeriod;\n  canceled_at?: ITimePeriod;\n  created_at?: ITimePeriod;\n  text_field_value?: string;\n  is_owner?: boolean;\n  is_recipient?: boolean;\n  sort_by?: SortOptions;\n  ascending?: boolean;\n  row?: number;\n  page?: number;\n  template_id?: string;\n  recipient_claimed?: boolean;\n}\n\nexport interface ITimePeriod {\n  start_time: string; // Date\n  end_time: string; // Date\n}\n\nexport enum SortOptions {\n  created_at = 'created_at',\n  updated_at = 'updated_at',\n  envelope_name = 'envelope_name',\n  canceled_at = 'canceled_at',\n  envelope_status = 'envelope_status'\n}\n\nexport interface ITemplateSearchParams {\n  name?: string;\n  sender?: string;\n  description?: string;\n  profile_id?: string;\n  organization_id?: string;\n  updated_at?: ITimePeriod;\n  created_at?: ITimePeriod;\n  last_used_at?: ITimePeriod;\n  is_personal?: boolean;\n  is_public?: boolean;\n  tags?: string[];\n  document_name?: string;\n  sort_by?: TemplateSortOptions;\n  ascending?: boolean;\n  row?: number;\n  page?: number;\n}\n\nexport enum TemplateSortOptions {\n  CREATED_AT = 'created_at',\n  UPDATED_AT = 'updated_at',\n  NAME = 'name',\n  LAST_USED_AT = 'last_used_at',\n  COUNTER = 'counter',\n  STAR_COUNTER = 'star_counter'\n}\n","import { VerdocsTokenObjectService } from '@verdocs/tokens';\nimport { intersection } from 'lodash';\n\nimport { Injectable } from '@angular/core';\nimport { ITemplate, TemplateActions, TemplatePermissions, TemplateSenderTypes } from '../models/verdocs.model';\n\n@Injectable()\nexport class TemplatesGuardService {\n\n\n  constructor(\n    private vTokenObjectService: VerdocsTokenObjectService\n  ) { }\n\n\n  public canPerformAction(action: TemplateActions, template: ITemplate): { canPerform: boolean, message: string } {\n    try {\n      let canPerform = false;\n      let message = null;\n      const neededPermissions = [];\n      if (!template && action && !action.includes('create')) {\n        throw {\n          error:\n            'You need to provide template object'\n        }\n      }\n      const userProfile = this.vTokenObjectService.getProfile();\n      const isCreator = userProfile ? template && template.profile_id === userProfile.id : false;\n      const isSameOrg = userProfile ? template && template.organization_id === userProfile.organization_id : false;\n      const isPersonal = template ? template.is_personal : null;\n      const isPublic = template ? template.is_public : null;\n      switch (action) {\n        case TemplateActions.CREATE_PERSONAL:\n          neededPermissions.push(TemplatePermissions.TEMPLATE_CREATOR_CREATE_PERSONAL)\n          break;\n        case TemplateActions.CREATE_ORG:\n          neededPermissions.push(TemplatePermissions.TEMPLATE_CREATOR_CREATE_ORG);\n          break;\n        case TemplateActions.CREATE_PUBLIC:\n          neededPermissions.push(TemplatePermissions.TEMPLATE_CREATOR_CREATE_PUBLIC)\n          break;\n        case TemplateActions.READ:\n          if (!isCreator) {\n            if ((!isPersonal && isSameOrg) || !isPublic) {\n              neededPermissions.push(TemplatePermissions.TEMPLATE_MEMBER_READ);\n            }\n          }\n          break;\n        case TemplateActions.WRITE:\n          if (!isCreator) {\n            neededPermissions.push(TemplatePermissions.TEMPLATE_MEMBER_READ);\n            neededPermissions.push(TemplatePermissions.TEMPLATE_MEMBER_WRITE);\n          }\n          break;\n        case TemplateActions.CHANGE_VISIBILITY_PERSONAL:\n          if (isCreator) {\n            neededPermissions.push(TemplatePermissions.TEMPLATE_CREATOR_CREATE_PERSONAL);\n            // neededPermission.push(TemplatePermissions.TEMPLATE_CREATOR_VISIBILITY);\n          } else {\n            neededPermissions.push(TemplatePermissions.TEMPLATE_MEMBER_VISIBILITY);\n          }\n          break;\n        case TemplateActions.CHANGE_VISIBILITY_ORG:\n          if (isCreator) {\n            neededPermissions.push(TemplatePermissions.TEMPLATE_CREATOR_CREATE_ORG);\n            // neededPermission.push(TemplatePermissions.TEMPLATE_CREATOR_VISIBILITY);\n          } else {\n            neededPermissions.push(TemplatePermissions.TEMPLATE_MEMBER_VISIBILITY);\n          }\n          break;\n        case TemplateActions.CHANGE_VISIBILITY_PUBLIC:\n          if (isCreator) {\n            neededPermissions.push(TemplatePermissions.TEMPLATE_CREATOR_CREATE_PUBLIC);\n            neededPermissions.push(TemplatePermissions.TEMPLATE_CREATOR_VISIBILITY);\n          } else {\n            neededPermissions.push(TemplatePermissions.TEMPLATE_MEMBER_VISIBILITY);\n          }\n          break;\n        case TemplateActions.DELETE:\n          if (isCreator) {\n            neededPermissions.push(TemplatePermissions.TEMPLATE_CREATOR_DELETE);\n          } else {\n            neededPermissions.push(TemplatePermissions.TEMPLATE_MEMBER_DELETE);\n          }\n          break;\n        default:\n          throw {\n            error: 'Action is not defined'\n          }\n      }\n      if (this.hasPermissions(neededPermissions)) {\n        canPerform = true;\n      } else {\n        message = `Insufficient access to perform '${action}'. Needed permissions: ${neededPermissions.toString()}`;\n      }\n      return {\n        canPerform,\n        message\n      }\n    } catch (err) {\n      console.error({\n        message: `Failed to check whether action (${action}) can be done, in TemplateGuardService`,\n        err: err\n      });\n    }\n  }\n\n  private hasPermissions(requiredPermissions: string[]) {\n    const userPermissions = this.vTokenObjectService.getPermissions();\n    const hasPermissions = intersection(userPermissions, requiredPermissions).length === requiredPermissions.length;\n    return hasPermissions;\n  }\n\n  public canBeSender(template): boolean {\n    const userProfile = this.vTokenObjectService.getProfile();\n    if (!userProfile) {\n      return false;\n    }\n    switch (template.sender) {\n      case TemplateSenderTypes.CREATOR:\n        return userProfile.id === template.profile_id;\n      case TemplateSenderTypes.ORGANIZATION_MEMBER:\n      case TemplateSenderTypes.ORGANIZATION_MEMBER_AS_CREATOR:\n        return userProfile.id === template.profile_id || template.organization_id === userProfile.organization_id;\n      default:\n        return true;\n    }\n  }\n\n  canUserCreateTemplate() {\n    return this.canPerformAction(TemplateActions.CREATE_PERSONAL, null)['canPerform']\n      || this.canPerformAction(TemplateActions.CREATE_ORG, null)['canPerform']\n      || this.canPerformAction(TemplateActions.CREATE_PUBLIC, null)['canPerform']\n  }\n\n}\n","import { Component, OnInit, Injector } from '@angular/core';\nimport { VerdocsTokenObjectService } from '@verdocs/tokens';\nimport { Router } from '@angular/router';\n\nimport { connectionConfig, connectionConfigToken } from '../header.module';\n\n@Component({\n  selector: 'four-oh-one-dialog',\n  templateUrl: './four-oh-one.dialog.html',\n  styleUrls: ['./four-oh-one.dialog.scss']\n})\nexport class FourOhOneDialog implements OnInit {\n  public error: any = null;\n  public tokenConfig: connectionConfig\n  public currentProfile: any = null;\n  public error_code: string = null;\n  public error_title: string = null;\n  public error_message: string = null;\n  public rSecureUrl: string;\n  public rFormUrl: string;\n\n  constructor(\n    private router: Router,\n    private verdocsTokenObjectService: VerdocsTokenObjectService,\n    private injector: Injector\n  ) {\n    this.tokenConfig = this.injector.get(connectionConfigToken);\n    this.rSecureUrl = this.tokenConfig.rSecure_frontend_url;\n    this.rFormUrl = this.tokenConfig.rForm_frontend_url;\n  }\n\n  ngOnInit() {\n    this.currentProfile = this.verdocsTokenObjectService.getProfile();\n    if (this.error && this.error.hasOwnProperty('error')) {\n      this.error_code = this.error.error.code || null;\n      if (this.error_code) {\n        this.prepareErroContent();\n      }\n    }\n  }\n\n  prepareErroContent() {\n    switch(this.error_code) {\n      case 'AUTH0002':\n      case 'T000001':\n      this.error_title = 'This document is not accessible';\n      this.error_message = (this.currentProfile ? 'Try using a different organization/account, ' : 'Try signing in, signing up, ') + 'or requesting access from the owner of this document.';\n      break;\n      case 'AUTH0003':\n      this.error_title = 'Cannot complete your request';\n      this.error_message = 'Try after ' + (this.currentProfile ? 'signing in again.' : 'signing in or signing up.');\n      break;\n      default:\n      this.error_title = 'Your request has been denied.';\n      this.error_message = null;\n      break;\n    }\n  }\n\n  goToDashboard() {\n    this.router.navigate(['/dashboard']);\n  }\n\n  signIn() {\n    if (window) {\n      window.location.href = `${this.rSecureUrl}/login?redirect_url=${this.rFormUrl + this.router.url}`;\n    }\n  }\n\n  signUp() {\n    if (window) {\n      window.location.href = `${this.rSecureUrl}/signup?redirect_url=${this.rFormUrl + this.router.url}`;\n    }\n  }\n}\n","import { Injectable, Injector, Inject, PLATFORM_ID } from '@angular/core';\nimport { isPlatformServer, isPlatformBrowser } from '@angular/common'\nimport { HttpClient, HttpResponse, HttpRequest, HttpHeaders } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { MatSnackBar } from '@angular/material/snack-bar';\nimport { MatDialog } from '@angular/material/dialog';\nimport { ReplaySubject, Subject, BehaviorSubject, EMPTY, Observable } from 'rxjs';\nimport { map, catchError } from 'rxjs/operators';\nimport { findIndex, filter } from 'lodash';\nimport { saveAs } from 'file-saver';\nimport { ProfileModel, ProfileCollection } from '@verdocs/profiles';\nimport { VerdocsStateService, VerdocsTokenObjectService } from '@verdocs/tokens';\n\nimport { connectionConfig, connectionConfigToken } from '../header.module';\nimport { TemplatesGuardService } from './templates.guard';\n\nimport { ITemplate, Envelope, IEnvelopeSearchParams, ITemplateSearchParams, IEnvelopeDocument, TemplateActions } from '../models/verdocs.model';\n\nimport { FourOhOneDialog } from '../error-dialogs/four-oh-one.dialog';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class VerdocsHeaderService {\n\n  public tokenConfig: connectionConfig;\n  public titleSubject = new ReplaySubject<string>();\n  public csvBlobSubject = new ReplaySubject<Blob>();\n  public templates: Subject<ITemplate[]> = new Subject<ITemplate[]>();\n  public saveStatusSubject: ReplaySubject<string> = new ReplaySubject<string>();\n  public templateDetailToggleSubject: Subject<boolean> = new Subject<boolean>();\n  public profileLoadingSubject = new ReplaySubject<boolean>();\n  public templateSubject: Subject<ITemplate> = new Subject<ITemplate>();\n  public template: ITemplate;\n  public allEnvelopes = new BehaviorSubject<Envelope[]>([]);\n  public sideNavStateSubject: ReplaySubject<boolean> = new ReplaySubject();\n  public initiateBuilderAutofocus: ReplaySubject<boolean> = new ReplaySubject();\n  public createToggleSubscription: Subject<boolean> = new Subject<boolean>();\n  public rAccount_url: string;\n  public rSecure_url: string;\n  public rForm_url: string;\n\n  private envUrl: string;\n  private _toggleSidenavSource = new BehaviorSubject<boolean>(false);\n  private _title = new BehaviorSubject<string>('');\n  private _selected = new BehaviorSubject<boolean>(false);\n  private _pdfUrl = new BehaviorSubject<string>('');\n  private _env = new BehaviorSubject<Envelope>({\n    id: '',\n    template_id: '',\n    status: '',\n    user_id: '',\n    envelope_document_id: ''\n  });\n  private _envDoc = new BehaviorSubject<IEnvelopeDocument>({\n    id: '',\n    url: '',\n    name: '',\n    page_numbers: 0,\n    mime: '',\n  });\n  private builderSideNavState: boolean;\n  private userFullname = '';\n  private userInitial = '';\n  private userEmail = '';\n  private userPhone = '';\n  private userData = {\n    name: this.userFullname,\n    initial: null,\n    email: this.userEmail,\n    phone: this.userPhone\n  };\n  private profileData: any;\n  private isAtOrigin: boolean = false;\n  private currentOrigin: 'rAccount' | 'rForm' | 'rSecure' | null;\n  private currentOrganizationId: string = null;\n  public sidenavOpened = false;\n\n  toggleSidenav$ = this._toggleSidenavSource.asObservable();\n  selectStatus$ = this._selected.asObservable();\n  env$ = this._env.asObservable();\n  titleValue$ = this._title.asObservable();\n  pdfUrl$ = this._pdfUrl.asObservable();\n  envDoc$ = this._envDoc.asObservable();\n  public userDataSubject = new ReplaySubject<any>();\n  public userProfileSubject = new ReplaySubject<any>();\n  public currentProfileSubject = new ReplaySubject<any>();\n  public personalAccountSubject = new ReplaySubject<any>();\n  public profilesSubject = new ReplaySubject<any>();\n\n  constructor(\n    private injector: Injector,\n    private http: HttpClient,\n    private router: Router,\n    private snackbar: MatSnackBar,\n    private dialog: MatDialog,\n    private templateGuard: TemplatesGuardService,\n    private vTokenStateService: VerdocsStateService,\n    private vTokenObjectService: VerdocsTokenObjectService,\n    @Inject(PLATFORM_ID) private platform\n  ) {\n    this.tokenConfig = this.injector.get(connectionConfigToken);\n    this.envUrl = this.tokenConfig.rForm_backend_url + '/envelopes';\n    this.rForm_url = this.tokenConfig.rForm_frontend_url;\n    this.rAccount_url = this.tokenConfig.rAccount_frontend_url;\n    this.rSecure_url = this.tokenConfig.rSecure_frontend_url;\n  }\n\n  public getAtOrigin(originType) {\n    this.isAtOrigin = originType && this.tokenConfig.origin && originType === this.tokenConfig.origin;\n    return this.isAtOrigin;\n  }\n\n  public toggleSidenav(bool) {\n    this.updateToggleStatus(bool);\n    this._toggleSidenavSource.next(this.sidenavOpened);\n  }\n\n  public updateToggleStatus(bool) {\n    this.sidenavOpened = bool;\n  }\n\n  public updateTitle(string) {\n    this._title.next(string);\n  }\n\n  public updateSelectStatus(bool) {\n    this._selected.next(bool);\n  }\n\n  public updatePdfUrl(string) {\n    this._pdfUrl.next(string);\n  }\n\n  public updateEnv(string) {\n    this._env.next(string);\n  }\n\n  public updateEnvDoc(IEnvelopeDocument) {\n    this._envDoc.next(IEnvelopeDocument);\n  }\n\n  initNotificationService() { }\n\n  public updateEnvelopes(envelopes) {\n    this.allEnvelopes.next(envelopes);\n  }\n\n  public toggleCreate() {\n    this.createToggleSubscription.next(true);\n  }\n\n  searchEnvelopes(searchParams: IEnvelopeSearchParams) {\n    for (const key in searchParams) {\n      if (searchParams.hasOwnProperty(key)) {\n        if (searchParams[key] === null) {\n          delete searchParams[key];\n        }\n      }\n    }\n    return this.http.request(new HttpRequest(\n      'POST',\n      this.envUrl + '/search',\n      searchParams,\n      {\n        reportProgress: true,\n        responseType: 'json'\n      }\n    )).pipe(\n      map(event => {\n        if (event instanceof HttpResponse) {\n          this.updateEnvelopes(event.body);\n        }\n        return event;\n      })\n    );\n  }\n\n  searchTemplates(searchParams: ITemplateSearchParams) {\n    for (const key in searchParams) {\n      if (searchParams.hasOwnProperty(key)) {\n        if (searchParams[key] === null) {\n          delete searchParams[key];\n        }\n      }\n    }\n    return this.http.request(new HttpRequest(\n      'POST',\n      this.tokenConfig.rForm_backend_url + '/templates/search',\n      searchParams,\n      {\n        reportProgress: true,\n        responseType: 'json'\n      }\n    )).pipe(\n      map(event => {\n        return event;\n      })\n    );\n  }\n\n  downloadTemplateDocument(template: ITemplate) {\n    this.getTemplateDocument(template.id, template.template_documents[0]).then(template_file => {\n      if (isPlatformBrowser(this.platform)) {\n        if (window && window.URL) {\n          const fileUrl = URL.createObjectURL(template_file);\n          saveAs(fileUrl, template.template_documents[0].name + '.pdf');\n        }\n      }\n    });\n  }\n\n  getTemplateDocument(templateId, templateDocument) {\n    return this.http.get(this.tokenConfig.rForm_backend_url + '/templates/' + templateId + '/documents/' +\n      templateDocument.id + '?file=true', { responseType: 'blob' }).toPromise();\n  }\n\n  updateTemplates(templates) {\n    this.templates.next(templates);\n  }\n\n  toggleBuilderSideNav() {\n    this.builderSideNavState = !this.builderSideNavState;\n    this.sideNavStateSubject.next(this.builderSideNavState);\n    if (this.builderSideNavState === false) {\n      this.initiateBuilderAutofocus.next(false);\n    }\n  }\n\n  canUserEdit(template: ITemplate) {\n    const response = this.templateGuard.canPerformAction(TemplateActions.WRITE, template);\n    return response['canPerform']\n  }\n\n  updateTemplate(templateId: string, body): Promise<ITemplate> {\n    return this.http\n      .put<ITemplate>(this.tokenConfig.rForm_backend_url + '/templates/' + templateId, body)\n      .toPromise().then(template => template);\n  }\n\n  openTemplate(template: ITemplate) {\n    if (this.canUserPreview(template)) {\n      location.href = `${this.tokenConfig.rForm_frontend_url}/document/${template.id}`;\n    } else if (this.canUserEdit(template)) {\n      location.href = `${this.tokenConfig.rForm_frontend_url}/builder/${template.id}/fields`;\n    } else {\n      this.snackbar.open(`Template is in build mode, and not ready for use.  Please check back soon.`)\n    }\n  }\n\n  openTemplates(searchKeyword?: string) {\n    if (this.tokenConfig.origin === 'rForm') {\n      if (searchKeyword.trim() !== '') {\n        this.router.navigate(['documents'], { queryParams: { name: searchKeyword } });\n      } else {\n        this.router.navigate(['documents']);\n      }\n    } else {\n      if (searchKeyword.trim() !== '') {\n        location.href = `${this.tokenConfig.rForm_frontend_url}/documents?name=${searchKeyword}`;\n      } else {\n        location.href = `${this.tokenConfig.rForm_frontend_url}/documents`;\n      }\n    }\n  }\n\n  getTemplateOwnerInfo(id: string): Promise<{ profile_id: string, email: string, name: string }> {\n    return this.http.get<{ profile_id: string, email: string, name: string }>(`${this.tokenConfig.rForm_backend_url}/templates/${id}?owner_info=true`)\n      .toPromise().then(res => {\n        return res;\n      });\n  }\n\n  canUserPreview(template: ITemplate) {\n    const hasPermission = (this.templateGuard.canPerformAction(TemplateActions.READ, template)).canPerform;\n    let canPreview;\n    const roles = template.roles;\n    const signers = filter(roles, { type: 'signer' });\n    canPreview = signers && signers.length > 0;\n    for (const signer of signers) {\n      canPreview = signer['fields'] && signer['fields'].length > 0;\n    }\n    return hasPermission && canPreview;\n  }\n\n  starTemplate(id): Observable<any> {\n    return this.http.post(this.tokenConfig.rForm_backend_url + `/templates/${id}/stars`, {}).pipe(\n      catchError(err => {\n        if (err && err.status === 401) {\n          const errorDialog = this.dialog.open(FourOhOneDialog, {\n            panelClass: 'error__dialog',\n            disableClose: true\n          })\n          errorDialog.componentInstance.error = err;\n        }\n        return EMPTY\n      }),\n      map(res => res)\n    );\n  }\n\n  unstarTemplate(id): Observable<any> {\n    return this.http.delete(this.tokenConfig.rForm_backend_url + `/templates/${id}/stars`).pipe(\n      catchError(err => {\n        if (err && err.status === 401) {\n          const errorDialog = this.dialog.open(FourOhOneDialog, {\n            panelClass: 'error__dialog',\n            disableClose: true\n          })\n          errorDialog.componentInstance.error = err;\n        }\n        return EMPTY\n      }),\n      map(res => res)\n    );\n  }\n\n  //Account Services\n  async updateTokens(sendMessage?: boolean) {\n    return new Promise((resolve, reject) => {\n      this.vTokenStateService.updateTokens(this.tokenConfig.rSecure_backend_url).subscribe(tokens => {\n        if (tokens && tokens.length > 0) {\n          if (sendMessage) {\n            this.snackbar.dismiss();\n            this.snackbar.open('Status updated');\n          }\n        }\n        this.getAccountData();\n        return resolve();\n      })\n    });\n  }\n\n  getAccountData() {\n    // might need if header needs to show condition\n    const profile = this.vTokenObjectService.getProfile();\n    if (profile) {\n      this.getProfiles();\n    }\n  }\n\n  getProfiles() {\n    return this.http.get(this.tokenConfig.rAccount_backend_url + '/profiles').toPromise().then((res: any[]) => {\n      const personal = res.splice(findIndex(res, p => p.organization.name === 'realster'), 1);\n      this.personalAccountSubject.next(personal[0]);\n      this.profileData = res.sort((a, b) => {\n        if (a.organization.name < b.organization.name) {\n          return -1;\n        }\n        if (a.organization.name > b.organization.name) {\n          return 1;\n        }\n        return 0;\n      });\n      this.profileData.unshift(personal[0]);\n      const currentIndex = findIndex(this.profileData, { current: true });\n      if (this.profileData[currentIndex]['first_name']) {\n        this.userFullname = this.profileData[currentIndex]['first_name'] + ' ' + this.profileData[currentIndex]['last_name'];\n        this.userInitial = this.profileData[currentIndex]['first_name'].charAt(0) +\n          this.profileData[currentIndex]['last_name'].charAt(0);\n      } else {\n        this.userFullname = '';\n      }\n      if (this.profileData[currentIndex]['phone']) {\n        this.userPhone = this.profileData[currentIndex]['phone'];\n      } else {\n        this.userPhone = '';\n      }\n      if (this.profileData[currentIndex]['email']) {\n        this.userEmail = this.profileData[currentIndex]['email'];\n      }\n      this.userData = {\n        name: this.userFullname,\n        initial: this.userInitial,\n        email: this.userEmail,\n        phone: this.userPhone\n      };\n      this.userProfileSubject.next(this.profileData);\n      const currentProfile = this.profileData[currentIndex];\n      this.currentProfileSubject.next(currentProfile);\n      this.currentOrganizationId = currentProfile.organization_id;\n      this.userDataSubject.next(this.userData);\n      return this.userData;\n    });\n  }\n\n  getProfileCollection(profiles) {\n    const profileModels: ProfileModel[] = [];\n    profiles.forEach(profile => {\n      profileModels.push(new ProfileModel(profile));\n    });\n    const profileCollection = new ProfileCollection(profileModels);\n    return profileCollection;\n  }\n\n  switchProfile(profile_id) {\n    this.profileLoadingSubject.next(true);\n    return this.http.post(this.tokenConfig.rAccount_backend_url + '/profiles/' + profile_id + '/switch', null).toPromise().then(async (res: any) => {\n      this.vTokenStateService.setTokens(res.tokens);\n      this.profileLoadingSubject.next(false);\n      return Promise.resolve(res);\n    });\n  }\n\n  resendEmailVerification() {\n    this.http.post(this.tokenConfig.rSecure_backend_url + '/user/email_verification', null).toPromise().then(() => {\n      this.snackbar.open('Verification email sent');\n    });\n  }\n\n  getNameValidity(name) {\n    return this.http.get(this.tokenConfig.rAccount_backend_url + '/organizations/is_valid?name=' + name, this.getOptions())\n      .toPromise()\n      .then(res => {\n        return Promise.resolve(res);\n      });\n  }\n\n  createOrganization(body) {\n    return this.http.post(this.tokenConfig.rAccount_backend_url + '/organizations', body, this.getOptions())\n      .toPromise()\n      .then(res => {\n        return Promise.resolve(res);\n      });\n  }\n\n  private getOptions(): any {\n    if (isPlatformServer(this.platform)) {\n      return;\n    }\n    const vTokenCookie = this.vTokenStateService.getOtherCookieObject('rAccount_Verdocs');\n    const authValue = 'Bearer ' + vTokenCookie['accessToken'];\n    const headers = new HttpHeaders({\n      'Cache-Control': 'no-cache',\n      'Pragma': 'no-cache',\n      'Expires': 'Sat, 01 Jan 2000 00:00:00 GMT',\n      'If-Modified-Since': '0',\n      'Content-Type': 'application/json',\n      'Authorization': authValue,\n      'Accept': 'application/json'\n    });\n    return { headers };\n  }\n\n  // End of Account Services\n\n  getRoleColor(name, index?) {\n    if (index) {\n      return this.getRGBA(index);\n    } else if (this.template && this.template.roles && this.template.roles.length > 0) {\n      index = findIndex(this.template.roles, { name: name });\n      if (index >= 0) {\n        return this.template.roles[index].rgba ? this.template.roles[index].rgba : this.getRGBA(index);\n      } else {\n        return this.nameToRGBA(name);\n      }\n    } else {\n      return this.nameToRGBA(name);\n    }\n  }\n\n  getRGB(rgba) {\n    const rgbNumbers = rgba.replace('rgba(', '').replace(')', '').split(',');\n    const rgbObject = {\n      red: rgbNumbers[0],\n      green: rgbNumbers[1],\n      blue: rgbNumbers[2],\n      alpha: rgbNumbers[3]\n    };\n    const alpha = 1 - rgbObject.alpha;\n    const red = Math.round((rgbObject.alpha * (rgbObject.red / 255) + alpha) * 255);\n    const green = Math.round((rgbObject.alpha * (rgbObject.green / 255) + alpha) * 255);\n    const blue = Math.round((rgbObject.alpha * (rgbObject.blue / 255) + alpha) * 255);\n    return ('#' + this.rgbToHex(red) + this.rgbToHex(green) + this.rgbToHex(blue));\n  }\n\n  rgbToHex(rgb: number) {\n    const hex = rgb.toString(16);\n    if (hex.length < 2) {\n      return '0' + hex;\n    }\n    return hex;\n  }\n\n  getRGBA(index) {\n    switch (index % 10) {\n      case 0:\n        return index === 0 ? 'rgba(255, 193, 7, 0.4)' : 'rgba(134, 134, 134, 0.3)'; //#FFE69C\n      case 1:\n        return 'rgba(156, 39, 176, .4)'; //'#E3C3E9'\n      case 2:\n        return 'rgba(33, 150, 243, .4)'; //'#C1E1FB'\n      case 3:\n        return 'rgba(220, 231, 117, 0.3)';\n      case 4:\n        return 'rgba(121, 134, 203, 0.3)';\n      case 5:\n        return 'rgba(77, 182, 172, 0.3)';\n      case 6:\n        return 'rgba(255, 202, 165, 0.3)';\n      case 7:\n        return 'rgba(2, 247, 190, 0.3)';\n      case 8:\n        return 'rgba(255, 138, 101, 0.3)';\n      case 9:\n        return 'rgba(82, 255, 79, 0.3)';\n      default:\n        return 'rgba(229, 115, 155, 0.3)';\n    }\n  }\n\n  nameToRGBA(str) {\n    if (!!str) {\n      const validNum = parseInt(str.slice(-1), 10);\n      if (!isNaN(validNum)) {\n        str += (validNum * 99).toString();\n      }\n      let hash = 0;\n      for (let i = 0; i < str.length; i++) {\n        hash = str.charCodeAt(i) + ((hash << 5) - hash);\n      }\n      hash = Math.round(hash / 1.3);\n      const c = (hash & 0x00FFFF08)\n        .toString(16)\n        .toUpperCase();\n      const hex = '#' + '00000'.substring(0, 6 - c.length) + c;\n      const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n      const color = {\n        r: parseInt(result[1], 16),\n        g: parseInt(result[2], 16),\n        b: parseInt(result[3], 16)\n      };\n      return `rgba(${color.r}, ${color.g}, ${color.b}, 0.2)`;\n    }\n  }\n}\n","import { Component, Input, OnChanges } from '@angular/core';\nimport { VerdocsTokenObjectService } from '@verdocs/tokens';\n\nimport { VerdocsHeaderService } from '../../services/header.service';\nimport { ITemplate, TemplateSenderTypes } from '../../models/verdocs.model';\n\n@Component({\n  selector: 'app-recipient-editor',\n  templateUrl: './recipients-editor.component.html',\n  styleUrls: ['./recipients-editor.component.scss']\n})\nexport class RecipientEditorComponent implements OnChanges{\n  public roles = [];\n  public sender = 'creator';\n  public sender_name = '';\n\n  @Input() template: ITemplate;\n\n  constructor(\n    private verdocsHeaderService: VerdocsHeaderService,\n    private vTokenObjectService: VerdocsTokenObjectService\n  ) {}\n\n  ngOnChanges() {\n    this.prepareSender();\n    this.prepareExistingRoles();\n  }\n\n  async prepareSender() {\n    this.sender = this.template.sender || 'creator';\n    await this.updateSenderName();\n  }\n\n  async updateSenderName() {\n    const profile = this.vTokenObjectService.getProfile();\n    const ownerInfo = await this.verdocsHeaderService.getTemplateOwnerInfo(this.template.id);\n    switch (this.sender) {\n      case TemplateSenderTypes.ORGANIZATION_MEMBER:\n        this.sender_name = 'Anyone at ' + (profile ? profile.organization.name : 'organization');\n        break;\n      case TemplateSenderTypes.EVERYONE:\n        this.sender_name = 'Anyone';\n        break;\n      case TemplateSenderTypes.EVERYONE_AS_CREATOR:\n      case TemplateSenderTypes.CREATOR:\n      case TemplateSenderTypes.ORGANIZATION_MEMBER_AS_CREATOR:\n        if (profile && this.template.profile_id === profile.id) {\n          this.sender_name = profile.first_name + ' ' + profile.last_name + ' (me)';\n        } else {\n          this.sender_name = ownerInfo.name + ' (creator)';\n        }\n        break;\n    }\n  }\n\n  prepareExistingRoles(recipients?) {\n    let roles = []\n    if (recipients && recipients.length > 0) {\n      roles = recipients;\n    } else {\n      roles = this.template.roles.sort((a, b) => {\n        return a.sequence - b.sequence;\n      }).slice();\n    }\n\n    roles = this.setStyles(roles);\n    this.roles = [];\n    for (let roleIndex = 0; roleIndex < roles.length; roleIndex++) {\n      if (roles[roleIndex]) {\n        const sequenceIndex = roles[roleIndex].sequence - 1;\n        if (!roles[roleIndex]['status']) {\n          roles[roleIndex]['status'] = null;\n        }\n        if (!roles[roleIndex]['old_name']) {\n          roles[roleIndex]['old_name'] = roles[roleIndex].name;\n        }\n        if (this.roles[sequenceIndex] === undefined) {\n          this.roles[sequenceIndex] = [roles[roleIndex]];\n        } else {\n          this.roles[sequenceIndex].push(roles[roleIndex]);\n        }\n      }\n    }\n    if (this.roles && this.roles.length === 0 && !this.roles[0]) {\n      this.roles = []\n      this.roles[0] = []\n    }\n  }\n\n  setStyles(roles) {\n    roles.forEach((role, index) => {\n      if (role) {\n        if (role.full_name && role.email) {\n          role['style'] = {\n            'border': '1px solid ' + this.verdocsHeaderService.getRGBA(index),\n            'background-color': 'transparent'\n          }\n        } else {\n          role['style'] = {\n            'background': this.verdocsHeaderService.getRGBA(index),\n            'border': '1px solid getRGBA(index)'\n          }\n        }\n      }\n    });\n    return roles;\n  }\n}\n","import { Component, Input, OnChanges, SimpleChanges } from '@angular/core';\n\nimport { VerdocsHeaderService } from '../../services/header.service';\nimport { ITemplate } from '../../models/verdocs.model';\n\n@Component({\n  selector: 'app-template-source',\n  templateUrl: './source-file.component.html',\n  styleUrls: ['./source-file.component.scss']\n})\n\nexport class TemplateSourceComponent implements OnChanges{\n  \n  @Input() template: ITemplate;\n\n  constructor(\n    private templatesService: VerdocsHeaderService\n  ) {}\n\n  ngOnChanges(changes: SimpleChanges) {\n    if (changes['template']) {\n\n    }\n  }\n\n  downloadTemplateDocument() {\n    this.templatesService.downloadTemplateDocument(this.template);\n  }\n\n}\n","import { Component, Input, OnInit, OnChanges, OnDestroy } from '@angular/core';\n\nimport { VerdocsHeaderService } from '../../services/header.service';\nimport { TemplatesGuardService } from '../../services/templates.guard';\nimport { ITemplate, TemplateActions } from '../../models/verdocs.model';\n\n@Component({\n  selector: 'app-preview-visibility',\n  templateUrl: 'visibility-editor.component.html',\n  styleUrls: ['./visibility-editor.component.scss']\n})\nexport class VisibilityEditorComponent implements OnInit, OnChanges, OnDestroy {\n  public template_visibility;\n  public updateVisibility = false;\n  public isSaving = false;\n\n  @Input() visibility;\n  @Input() isEditMode = false;\n  @Input() template;\n\n  private _canShareWithOrg = null;\n  private _canMakeItPrivate = null;\n  private _canShareWithPublic = null;\n\n  constructor(\n    private templateGuard: TemplatesGuardService,\n    private verdocsHeaderService: VerdocsHeaderService\n  ) { }\n\n  ngOnInit() {\n    this.template_visibility = this.getTemplateVisibility();\n  }\n  ngOnChanges() {\n    this.template_visibility = this.getTemplateVisibility();\n  }\n  ngOnDestroy() {\n    this.template_visibility = undefined;\n  }\n\n  getTemplateVisibility() {\n    if (this.visibility) {\n      if (this.visibility.is_personal) {\n        if (this.visibility.is_public) {\n          return 'personal & public'\n        } else {\n          return 'personal';\n        }\n      } else {\n        if (this.visibility.is_public) {\n          return 'public & org';\n        } else {\n          return 'org';\n        }\n      }\n    }\n    return undefined;\n  }\n\n  setUpdateVisibility() {\n    const original_visibility = this.getTemplateVisibility();\n    this.updateVisibility = original_visibility !== this.template_visibility;\n  }\n\n  async saveChanges() {\n    this.isSaving = true;\n    const body = {};\n      if (this.updateVisibility && this.template) {\n        switch (this.template_visibility) {\n          case 'personal':\n            body['is_personal'] = true;\n            body['is_public'] = false;\n            break;\n          case 'org':\n            body['is_personal'] = false;\n            body['is_public'] = false;\n            break;\n          case 'public & org':\n            body['is_personal'] = false;\n            body['is_public'] = true;\n            break;\n          case 'personal & public':\n            body['is_personal'] = true;\n            body['is_public'] = true;\n          default:\n            break;\n        }\n      }\n      const template: ITemplate = await this.verdocsHeaderService.updateTemplate(this.template.id, body);\n      this.updateVisibility = false;\n      this.isSaving = false;\n  }\n\n  get canShareWithPublic() {\n    if (this.template && typeof (this._canShareWithPublic) !== 'boolean') {\n      this._canShareWithPublic = (this.templateGuard.canPerformAction(TemplateActions.CHANGE_VISIBILITY_PUBLIC, this.template))['canPerform'];\n    }\n    return this._canShareWithPublic\n  }\n\n  get canChangeVisibility() {\n    return this.canMakeItPrivate || this.canShareWithOrg || this.canShareWithPublic\n  }\n\n  get canShareWithOrg() {\n    if (this.template && typeof (this._canShareWithOrg) !== 'boolean') {\n      this._canShareWithOrg = (this.templateGuard.canPerformAction(TemplateActions.CHANGE_VISIBILITY_ORG, this.template))['canPerform'];\n    }\n    return this._canShareWithOrg\n  }\n\n  get canMakeItPrivate() {\n    if (this.template && typeof (this._canMakeItPrivate) !== 'boolean') {\n      this._canMakeItPrivate =\n        (this.templateGuard.canPerformAction(TemplateActions.CHANGE_VISIBILITY_PERSONAL, this.template))['canPerform'];\n    }\n    return this._canMakeItPrivate\n  }\n\n}\n","import {\n  Component,\n  OnInit,\n  OnDestroy,\n  AfterViewChecked,\n  ViewChild,\n  ElementRef,\n  Compiler,\n  Input,\n  ChangeDetectorRef,\n  Injector,\n  Inject,\n  PLATFORM_ID\n} from '@angular/core';\nimport { Router, NavigationEnd, NavigationStart } from '@angular/router';\nimport { isPlatformBrowser } from '@angular/common';\nimport { HttpResponse } from '@angular/common/http';\nimport { VerdocsStateService, VerdocsAuthService, VerdocsTokenObjectService } from '@verdocs/tokens';\nimport { Subscription, fromEvent } from 'rxjs';\nimport { debounceTime, distinctUntilChanged } from 'rxjs/operators';\nimport { findIndex } from 'lodash';\n\nimport { VerdocsHeaderService } from './services/header.service';\nimport { TemplatesGuardService } from './services/templates.guard';\nimport { ITemplate, Envelope, TemplateActions } from './models/verdocs.model';\nimport { connectionConfig, connectionConfigToken } from './header.module';\n\n@Component({\n  selector: 'verdocs-header',\n  templateUrl: './header.component.html',\n  styleUrls: ['./header.component.scss']\n})\nexport class HeaderComponent implements OnInit, AfterViewChecked, OnDestroy {\n  public pageLoading = true;\n  public connections: connectionConfig;\n  public title: string;\n  public isAuthenticated = false;\n  public headerTitle = 'Envelope';\n  public mode = '';\n  public searchActive = false;\n  public templateName = '';\n  public newTemplateName = null;\n  public saveStatus = '';\n  public notifications: Notification[] = [];\n  public loading = false;\n  public myAccountUrl: string;\n  public termsUrl: string;\n  public privacyUrl: string;\n  public newProfile: any;\n  public organization_id: string;\n  public emailVerified: boolean;\n  public organizationImgSrc: string;\n  public csvBlob: Blob = null;\n  public templateDetailsExpanded = true;\n  public template: ITemplate = null;\n  public isSearching = false;\n  public envelopeResult: Envelope[];\n  public templateResult: ITemplate[];\n  public currentProfile: any = null;\n  public inputFocused: boolean = false;\n  public manageLink: string;\n  public templatesLink: string;\n  public rSecureFrontEnd: string;\n  public rFormFrontEnd: string;\n  public isLiveView = false;\n  public verdocs_url: string;\n  public image_url: string;\n  public isAtOriginalOrigin: boolean;\n  public app_version: string = '';\n  public currentAt: string = ''\n\n  @Input() currentOrigin: 'rForm' | 'rAccount' | 'rSecure';\n\n  @ViewChild('headerContainer', { static: false }) header: ElementRef;\n  @ViewChild('search', { static: false }) searchBar: ElementRef;\n  @ViewChild('templateTitle', { static: false }) templateTitleInput: ElementRef;\n  @ViewChild('previewInput', { static: false }) previewInput: ElementRef;\n  @ViewChild('generalInput', { static: false }) generalInput: ElementRef;\n\n  private sidenavOpen: boolean;\n  private _canStar: boolean = null;\n  private _canCreate: boolean = null;\n  private _canEdit: boolean = null;\n  private _userStarred: boolean = null;\n  private metaDataSubscription = new Subscription();\n  private titleSubscription = new Subscription();\n  private titleInputSubscription = new Subscription();\n  private titleKeyDownSubscription = new Subscription();\n  private templateNameSubscription = new Subscription();\n  private templateSubscription = new Subscription();\n  private saveStatusSubscription = new Subscription();\n  private profileLoadingSubscription = new Subscription();\n  private userDataSubscription = new Subscription();\n  private modeSubscription = new Subscription();\n  private previewInputSubscription = new Subscription();\n  private generalInputSubscription = new Subscription();\n  private navigationEventSubscription = new Subscription();\n  private csvBlobSubscription = new Subscription();\n  private inputTimer: NodeJS.Timeout;\n  private origin: string;\n\n  constructor(\n    private verdocsHeaderService: VerdocsHeaderService,\n    private vTokenStateService: VerdocsStateService,\n    private vTokenObjectService: VerdocsTokenObjectService,\n    private vAuthService: VerdocsAuthService,\n    private templateGuard: TemplatesGuardService,\n    private router: Router,\n    private cdr: ChangeDetectorRef,\n    private compiler: Compiler,\n    private injector: Injector,\n    @Inject(PLATFORM_ID) private platform\n  ) {\n    this.connections = this.injector.get(connectionConfigToken);\n    this.myAccountUrl = this.connections.rAccount_frontend_url + '/rAccount';\n    this.termsUrl = this.connections.rSecure_frontend_url + '/terms';\n    this.privacyUrl = this.connections.rSecure_frontend_url + '/privacy';\n    this.organizationImgSrc = `${this.connections.rAccount_frontend_url}/assets/organization/select-profile.png`;\n    this.verdocs_url = this.connections.rForm_frontend_url;\n    this.manageLink = `${this.verdocs_url}/manage`;\n    this.templatesLink = `${this.verdocs_url}/templates`;\n    this.rSecureFrontEnd = this.connections.rSecure_frontend_url;\n    this.rFormFrontEnd = this.connections.rForm_frontend_url;\n    this.currentOrigin = this.connections.origin;\n    this.currentAt = this.currentOrigin;\n  }\n\n  ngOnInit() {\n    this.templateSubscription = this.verdocsHeaderService.templateSubject.subscribe((template: ITemplate) => {\n      this.template = template;\n      this.updateStar();\n    });\n    if (isPlatformBrowser(this.platform)) {\n      if (window && window.location || this.connections.app_version) {\n        this.origin = window.location.protocol + \"//\" + window.location.hostname + (window.location.port ? ':' + window.location.port: '');\n      }\n      if (this.origin && this.origin.includes('/stage.') || this.origin.includes('/localhost')) {\n        this.app_version = this.connections.app_version;\n      } else {\n        this.app_version = '';\n      }\n    }\n    this.isAuthenticated = this.vAuthService.isAuthenticated();\n    this.emailVerified = this.vTokenStateService.getEmailVerification();\n    this.navigationEventSubscription = this.router.events.subscribe(event => {\n      if (event instanceof NavigationEnd) {\n        this.isAuthenticated = this.vAuthService.isAuthenticated();\n        if (event && event.url && ((event.url.includes('document/') && !event.url.includes('envelopes/document')) || event.url.includes('view/live/'))) {\n          this.isAtOriginalOrigin = this.verdocsHeaderService.getAtOrigin(this.currentOrigin);\n          this.currentAt = this.currentOrigin;\n          this.mode = 'preview';\n          if (event.url.includes('view/live/')) {\n            this.isLiveView = true;\n            this.templateDetailsExpanded = false;\n          } else {\n            this.isLiveView = false;\n          }\n        } else {\n          this.mode = 'not-preview';\n          this.isLiveView = false;\n        }\n        if (this.mode !== 'preview') {\n          this.image_url = `${this.connections.rForm_frontend_url}/assets/white-logo.svg`;\n        } else {\n          this.image_url = `${this.connections.rForm_frontend_url}/assets/break-black-logo.svg`;\n        }\n        this.getProfile();\n        this.updateStar();\n        this.checkCanStar();\n        this._canEdit = undefined;\n        this._canCreate = undefined;\n        this.pageLoading = false;\n      } else if (event instanceof NavigationStart) {\n        this.pageLoading = true;\n      }\n    });\n    this.titleSubscription = this.verdocsHeaderService.titleSubject.subscribe(title => {\n      if (title) {\n        this.title = title;\n      } else {\n        this.title = null;\n      }\n    });\n    this.csvBlobSubscription = this.verdocsHeaderService.csvBlobSubject.subscribe(blob => {\n      if (blob) {\n        this.csvBlob = blob;\n      } else {\n        this.csvBlob = null;\n      }\n    });\n    this.saveStatusSubscription = this.verdocsHeaderService.saveStatusSubject.subscribe(status => {\n      this.saveStatus = status;\n    });\n    this.profileLoadingSubscription = this.verdocsHeaderService.profileLoadingSubject.subscribe(status => {\n      this.loading = status;\n    });\n  }\n\n  ngAfterViewChecked() {\n    this.cdr.detectChanges();\n  }\n\n  ngOnDestroy() {\n    this.metaDataSubscription.unsubscribe();\n    this.titleSubscription.unsubscribe();\n    this.titleInputSubscription.unsubscribe();\n    this.titleKeyDownSubscription.unsubscribe();\n    this.templateNameSubscription.unsubscribe();\n    this.templateSubscription.unsubscribe();\n    this.saveStatusSubscription.unsubscribe();\n    this.profileLoadingSubscription.unsubscribe();\n    this.userDataSubscription.unsubscribe();\n    this.modeSubscription.unsubscribe();\n    if (!!this.generalInputSubscription) {\n      this.generalInputSubscription.unsubscribe();\n    }\n    if (!!this.previewInputSubscription) {\n      this.previewInputSubscription.unsubscribe();\n    }\n    this.navigationEventSubscription.unsubscribe();\n    this.csvBlobSubscription.unsubscribe();\n    this.compiler.clearCache();\n  }\n\n  async init() {\n    if (this.vAuthService.isAuthenticated() && this.mode !== 'view') {\n      await this.verdocsHeaderService.initNotificationService();\n    }\n  }\n\n  get home_url() {\n    return this.vTokenStateService.getIDToken() ? this.connections.rForm_frontend_url + '/dashboard' : this.connections.rForm_frontend_url;\n  }\n\n  previewInputEvent(event) {\n    clearTimeout(this.inputTimer);\n    this.inputTimer = setTimeout(() => {\n      this.getSearchResults(this.previewInput.nativeElement.value);\n      clearTimeout(this.inputTimer);\n    }, 500);\n  }\n\n  generalInputEvent(event) {\n    clearTimeout(this.inputTimer);\n    this.inputTimer = setTimeout(() => {\n      this.getSearchResults(this.generalInput.nativeElement.value);\n      clearTimeout(this.inputTimer);\n    }, 500);\n  }\n\n  prepareSearchInput() {\n    if (this.mode === 'preview') {\n      this.listenForPreviewInput();\n    } else {\n      this.listenForGeneralInput();\n    }\n  }\n\n  listenForPreviewInput() {\n    if (this.generalInputSubscription) {\n      this.generalInputSubscription.unsubscribe();\n    }\n    if (this.previewInput) {\n      if (!this.previewInputSubscription) {\n        this.previewInputSubscription = fromEvent(this.previewInput.nativeElement, 'keyup')\n          .pipe(\n            debounceTime(500),\n            distinctUntilChanged()\n          ).subscribe((event) => {\n            const keyName = event['code'] || event['key'];\n            if (keyName) {\n              if (keyName !== 'Enter' && keyName !== 'ArrowDown' && keyName !== 'ArrowUp') {\n                this.getSearchResults(this.previewInput.nativeElement.value);\n              }\n            } else {\n              this.getSearchResults(this.previewInput.nativeElement.value);\n            }\n          });\n      }\n    }\n  }\n\n  listenForGeneralInput() {\n    if (this.previewInputSubscription) {\n      this.previewInputSubscription.unsubscribe();\n    }\n    if (this.generalInput) {\n      if (!this.generalInputSubscription) {\n        this.generalInputSubscription = fromEvent(this.generalInput.nativeElement, 'keyup')\n          .pipe(\n            debounceTime(500),\n            distinctUntilChanged()\n          ).subscribe((event) => {\n            const keyName = event['code'] || event['key'];\n            if (keyName) {\n              if (keyName !== 'Enter' && keyName !== 'ArrowDown' && keyName !== 'ArrowUp') {\n                this.getSearchResults(this.generalInput.nativeElement.value);\n              }\n            } else {\n              this.getSearchResults(this.generalInput.nativeElement.value);\n            }\n          });\n      }\n    }\n  }\n\n  get canStar() {\n    return this._canStar;\n  }\n\n  get userStarred() {\n    return this._userStarred;\n  }\n\n  get canEdit() {\n    if (typeof (this._canEdit) !== 'boolean' && this.templateGuard && this.isAuthenticated && this.template) {\n      const response = this.templateGuard.canPerformAction(TemplateActions.WRITE, this.template);\n      this._canEdit = response['canPerform']\n    }\n    if (!this.isAuthenticated && this.template) {\n      this._canEdit = false;\n    }\n    return this._canEdit\n  }\n\n  get canCreate() {\n    if (this.isAuthenticated) {\n      if (typeof (this._canCreate) !== 'boolean') {\n        const permissions = this.vTokenObjectService.getVerdocsPermissions();\n        this._canCreate = false;\n        if (permissions && permissions.length > 0) {\n          permissions.forEach(permission => {\n            if (permission.includes('creator:create')) {\n              return this._canCreate = true;\n            }\n          });\n        }\n      }\n      return this._canCreate;\n    } else {\n      return false;\n    }\n  }\n\n  getProfile() {\n    if (this.isAuthenticated) {\n      this.currentProfile = this.vTokenObjectService.getProfile();\n    }\n  }\n\n  selected(event) {\n    if ((this.generalInput && this.generalInput.nativeElement.value) || (this.previewInput && this.previewInput.nativeElement.value)) {\n      event.option._element.nativeElement.click();\n    }\n  }\n\n  checkCanStar() {\n    this._canStar = this.isAuthenticated;\n  }\n\n  getSearchResults(search_string: string) {\n    this.isSearching = true;\n    if (this.isAuthenticated) {\n      this.verdocsHeaderService.searchEnvelopes({ envelope_name: search_string, row: 3 }).subscribe(result => {\n        if (result instanceof HttpResponse) {\n          this.envelopeResult = result.body['result'] as Envelope[];\n          this.verdocsHeaderService.searchTemplates({ name: search_string, row: 3 }).subscribe(result => {\n            if (result instanceof HttpResponse) {\n              this.templateResult = result.body['result'] as ITemplate[];\n              this.isSearching = false;\n            }\n          });\n        }\n      });\n    } else {\n      this.verdocsHeaderService.searchTemplates({ name: search_string, row: 3 }).subscribe(result => {\n        if (result instanceof HttpResponse) {\n          this.templateResult = result.body['result'] as ITemplate[];\n          this.isSearching = false;\n        }\n      });\n    }\n  }\n\n  recipientTracking(index, item) {\n    return index;\n  }\n\n  toggleMenu() {\n    this.verdocsHeaderService.toggleSidenav(!this.sidenavOpen);\n  }\n\n  setInputFocused(value: boolean) {\n    this.inputFocused = value;\n  }\n\n  hasProp(obj: any, key: string) {\n    return obj.hasOwnProperty(key);\n  }\n\n  roleColor(name) {\n    return this.verdocsHeaderService.getRoleColor(name);\n  }\n\n  toggleSidenav() {\n    this.verdocsHeaderService.toggleBuilderSideNav();\n  }\n\n  toggleTemplateDetails() {\n    this.templateDetailsExpanded = !this.templateDetailsExpanded;\n    if (this.templateDetailsExpanded) {\n      this.verdocsHeaderService.templateDetailToggleSubject.next(true);\n    }\n  }\n\n  reset() {\n    this.templateName = 'Unititled';\n    // this.verdocsHeaderService.templateNameSubject.next('Untitled');\n  }\n\n  getRoleNames(roles) {\n    if (roles && roles.length > 0) {\n      const last_index = roles.length - 1;\n      let names_string = '';\n      for (let x = 0; x < roles.length; x++) {\n        if (x < last_index) {\n          names_string += roles[x]['full_name'] + ', ' as string;\n        } else {\n          names_string += roles[x]['full_name'] as string;\n        }\n      }\n      return names_string;\n    }\n  }\n\n  getTemplateStats(template: ITemplate) {\n    return `${this.getTemplatePages(template)}  ${this.getTemplateSequence(template)}  ${this.getTemplateRecipients(template)}`;\n  }\n\n  getTemplatePages(template: ITemplate) {\n    if (template && template.pages) {\n      return `${template.pages.length >= 2 ? template.pages.length + ' Pages' : '1 Page'}`;\n    } else {\n      return '0 Page';\n    }\n  }\n\n  getTemplateSequence(template: ITemplate) {\n    if (template && template.roles) {\n      let hasPreparer = false;\n      let maxSequence = -1;\n      for (let x = 0; x < template.roles.length; x++) {\n        if (template.roles[x].sequence > maxSequence) {\n          maxSequence = template.roles[x].sequence;\n        }\n        if (template.roles[x].sequence === 0) {\n          hasPreparer = true;\n        }\n      }\n\n      const totalSequence = hasPreparer ? maxSequence + 1 : maxSequence;\n      return totalSequence > 1 ? totalSequence + ' Sequences' : '1 Sequence';\n    } else {\n      return '0 Sequence';\n    }\n  }\n\n  getTemplateRecipients(template: ITemplate) {\n    if (template && template.roles) {\n      const totalRecipients = template.roles.length;\n      return totalRecipients > 1 ? totalRecipients + ' Recipients' : '1 Recipient';\n    } else {\n      return '0 Recipient'\n    }\n  }\n\n  goToEnvelope(envelope_id: string) {\n    if (this.currentOrigin === 'rForm' && this.isAtOriginalOrigin) {\n      this.router.navigate([`/envelope/${envelope_id}`]);\n    } else {\n      location.href = `${this.connections.rForm_frontend_url}/envelope/${envelope_id}`;\n    }\n    this.clearSearchInputs();\n  }\n\n  goToTemplate(template: ITemplate) {\n    this.verdocsHeaderService.openTemplate(template);\n    this.clearSearchInputs();\n  }\n\n  goToTemplates(keyword) {\n    this.verdocsHeaderService.openTemplates(keyword);\n  }\n\n  searchEnvelopes() {\n    const keyword = this.getSearchKeyword();\n    if (keyword !== '') {\n      this.router.navigate([`/manage`], { queryParams: { envelope_name: keyword } });\n      this.clearSearchInputs();\n    }\n  }\n\n  searchRecipients() {\n    const keyword = this.getSearchKeyword();\n    if (keyword !== '') {\n      this.router.navigate([`/manage`], { queryParams: { recipient_name: keyword } });\n      this.clearSearchInputs();\n    }\n  }\n\n  searchTemplates() {\n    const keyword = this.getSearchKeyword();\n    if (keyword !== '') {\n      this.router.navigate([`/templates`], { queryParams: { name: keyword } });\n      this.clearSearchInputs();\n    }\n  }\n\n  getSearchKeyword() {\n    if (this.previewInput && this.previewInput.nativeElement.value) {\n      return this.previewInput.nativeElement.value;\n    } else if (this.generalInput && this.generalInput.nativeElement.value) {\n      return this.generalInput.nativeElement.value;\n    }\n    return '';\n  }\n\n  clearSearchInputs() {\n    if (this.previewInput) {\n      this.previewInput.nativeElement.value = '';\n    }\n    if (this.generalInput) {\n      this.generalInput.nativeElement.value = '';\n    }\n    this.envelopeResult = [];\n    this.templateResult = [];\n  }\n\n  updateStar() {\n    if (this.template && this.currentProfile && this.template.template_stars) {\n      const existingStarIndex = findIndex(this.template.template_stars, { profile_id: this.currentProfile.id, template_id: this.template.id });\n      this._userStarred = existingStarIndex > -1;\n    } else {\n      return false;\n    }\n  }\n\n  starTemplate() {\n    if (this.canStar) {\n      this.verdocsHeaderService.starTemplate(this.template.id).subscribe(res => {\n        this.template.template_stars.push(res);\n        this.updateStar();\n      });\n    } else if (!this.isAuthenticated) {\n      this.createTemplate();\n    }\n  }\n\n  unstarTemplate() {\n    if (this.canStar) {\n      this.verdocsHeaderService.unstarTemplate(this.template.id).subscribe(res => {\n        const removedStarIndex = findIndex(this.template.template_stars, { profile_id: this.currentProfile.id, template_id: this.template.id });\n        if (removedStarIndex > -1) {\n          this.template.template_stars.splice(removedStarIndex, 1);\n          this.updateStar();\n        }\n      });\n    } else if (!this.isAuthenticated) {\n      this.createTemplate();\n    }\n  }\n\n  editTemplate() {\n    if (this.canEdit) {\n      this.router.navigate([`/builder/${this.template.id}/fields`]);\n    } else if (!this.isAuthenticated) {\n      this.createTemplate();\n    }\n  }\n\n  createTemplate() {\n    this.verdocsHeaderService.toggleCreate();\n  }\n\n}\n","import { Component, OnInit, OnDestroy, Input, Injector, AfterContentChecked, Inject, PLATFORM_ID } from '@angular/core';\nimport { isPlatformBrowser } from '@angular/common';\nimport { Router } from '@angular/router';\nimport { MatSnackBar, MatSnackBarConfig } from '@angular/material/snack-bar';\nimport { NotificationService, Notification } from '@verdocs/notifications';\nimport { ProfileCollection, OrganizationDialogService, Override as ProfileOverride } from '@verdocs/profiles';\nimport { VerdocsStateService, VerdocsAuthGuardService, VerdocsTokenObjectService } from '@verdocs/tokens';\nimport { Subscription } from 'rxjs';\nimport { findIndex, includes } from 'lodash';\n\nimport { connectionConfig, connectionConfigToken } from '../header.module';\nimport { VerdocsHeaderService } from '../services/header.service';\n\n@Component({\n  selector: 'verdocs-header-tools',\n  templateUrl: './header-tools.component.html',\n  styleUrls: ['./header-tools.component.scss']\n})\nexport class HeaderToolsComponent implements OnInit, AfterContentChecked, OnDestroy {\n  public tokenConfig: connectionConfig;\n  public apps = [];\n  public emailVerified: boolean;\n  public notifications: Notification[] = [];\n  public profiles: ProfileCollection;\n  public newProfile: any;\n  public organization_id: string;\n  public myAccountUrl: string;\n  public rSecureUrl: string;\n  public rFormUrl: string;\n  public termsUrl: string;\n  public privacyUrl: string;\n  public loginUrl: string;\n  public signupUrl: string;\n  public organizationImgSrc: string;\n  public profileLoading = false;\n  public hasProfile = false;\n  public origin: 'rForm' | 'rSecure' | 'rAccount' | null;\n  public isAtOriginalOrigin: boolean;\n  public verdocs_logo_url: string;\n  @Input() public profileOverride: ProfileOverride = {\n    top:56,\n    right: 20\n  };\n  @Input() public sidenav = false;\n  @Input() public type = 'default';\n  @Input() public mode: string;\n  private notificationsSubscription = new Subscription();\n  private profileLoadingSubscription = new Subscription();\n\n  constructor(\n    private verdocsStateService: VerdocsStateService,\n    private verdocsObjectService: VerdocsTokenObjectService,\n    private verdocsAuthGuardService: VerdocsAuthGuardService,\n    private organizationDialogService: OrganizationDialogService,\n    private notificationsService: NotificationService,\n    private verdocsHeaderService: VerdocsHeaderService,\n    private snackbar: MatSnackBar,\n    private injector: Injector,\n    private router: Router,\n    @Inject(PLATFORM_ID) private platform\n  ) { \n    this.tokenConfig = this.injector.get(connectionConfigToken);\n    this.myAccountUrl = this.tokenConfig.rAccount_frontend_url;\n    this.rSecureUrl = this.tokenConfig.rSecure_frontend_url;\n    this.rFormUrl = this.tokenConfig.rForm_frontend_url;\n    this.termsUrl = this.tokenConfig.rSecure_frontend_url + '/terms';\n    this.privacyUrl = this.tokenConfig.rSecure_frontend_url + '/privacy';\n    this.loginUrl = this.tokenConfig.rSecure_frontend_url + '/login';\n    this.signupUrl = this.tokenConfig.rSecure_frontend_url + '/signup';\n    this.organizationImgSrc = `${this.tokenConfig.rAccount_frontend_url}/assets/organization/select-profile.png`;\n    this.verdocs_logo_url = `${this.rFormUrl}/assets/blue-logo.svg`;\n    this.origin = this.tokenConfig.origin;\n    this.isAtOriginalOrigin = this.verdocsHeaderService.getAtOrigin(this.origin);\n  }\n\n  ngOnInit() {\n    this.checkEmailVerification();\n    this.hasProfile = this.verdocsObjectService.getProfile();\n    this.verdocsHeaderService.userProfileSubject.subscribe(profiles => {\n      this.profiles = this.verdocsHeaderService.getProfileCollection(profiles);\n      this.verdocsHeaderService.profilesSubject.next(profiles);\n      const index = findIndex(profiles, { organization_id: this.organization_id });\n      if (index >= 0) {\n        this.newProfile = profiles[index];\n        this.organizationDialogService.setNewProfile(this.newProfile);\n      }\n    });\n    this.notificationsSubscription = this.notificationsService.Notificatations().subscribe(notifications => {\n      this.notifications = notifications;\n    });\n    this.profileLoadingSubscription = this.verdocsHeaderService.profileLoadingSubject.subscribe(status => {\n      this.profileLoading = status;\n    });\n\n    if (!this.profiles && this.hasProfile) {\n      this.verdocsHeaderService.getProfiles();\n    }\n  }\n\n  ngAfterContentChecked() {\n    if (isPlatformBrowser(this.platform)) {\n      if (typeof window !== 'undefined') {\n        if (window.innerWidth > 600) {\n          this.profileOverride.top = 60;\n        } else {\n          this.profileOverride.top = 56;\n        }\n      }\n    }\n  }\n\n  ngOnDestroy() {\n    this.notificationsSubscription.unsubscribe();\n    this.profileLoadingSubscription.unsubscribe();\n  }\n\n  private checkEmailVerification(): void {\n    this.emailVerified = this.verdocsStateService.getEmailVerification();\n    this.organizationDialogService.setEmailVerified(this.emailVerified);\n  }\n\n  public get admin_url() {\n    if (this.hasAccessToAdmin()) {\n      return `${this.tokenConfig.rAccount_frontend_url}/admin`;\n    }\n    return undefined;\n  }\n\n  removeNotification(notification: Notification) {\n    this.notificationsService.dismissNotification(notification);\n  }\n\n  signOut() {\n    this.verdocsAuthGuardService.signOut();\n  }\n\n  signIn() {\n    if (window) {\n      window.location.href = `${this.rSecureUrl}/login?redirect_url=${this.rFormUrl + this.router.url}`;\n    }\n  }\n\n  signUp() {\n    if (window) {\n      window.location.href = `${this.rSecureUrl}/signup?redirect_url=${this.rFormUrl + this.router.url}`;\n    }\n  }\n\n  switch(profile_id: string) {\n    this.verdocsHeaderService.switchProfile(profile_id).then(() => {\n      window.location.href = `${this.tokenConfig.rForm_frontend_url}`;\n    });\n  }\n\n  switchAndGoToAdmin() {\n    if (this.newProfile) {\n      this.verdocsHeaderService.switchProfile(this.newProfile.id).then(profile => {\n        window.location.href = `${this.myAccountUrl}/admin/profile/${this.newProfile.id}`;\n      });\n    }\n  }\n\n  updateTokenStatus(sendMessage?: boolean) {\n    this.createSnackbar('Checking email verification', 'OK');\n    this.verdocsHeaderService.updateTokens(sendMessage).then(() => {\n      this.emailVerified = this.verdocsStateService.getEmailVerification();\n      this.organizationDialogService.setEmailVerified(this.emailVerified);\n    });\n  }\n\n  resendEmailVerification() {\n    this.verdocsHeaderService.resendEmailVerification();\n  }\n\n  checkNameValidity(name: string) {\n    return this.verdocsHeaderService.getNameValidity(name)\n      .then(result => {\n        this.organizationDialogService.setNameValidation(result);\n      });\n  }\n\n  createOrganization(organizationGroup) {\n    this.verdocsHeaderService.createOrganization(organizationGroup)\n      .then(async organization => {\n        this.organization_id = organization['id'];\n        await this.verdocsHeaderService.getAccountData();\n        this.createSnackbar('Organization created', null);\n      });\n  }\n\n  switchProfile() {\n    this.switch(this.newProfile.id);\n  }\n\n  checkAccess(clientName) {\n    return this.verdocsStateService.hasAccessTo(clientName + '_Realster');\n  }\n\n  jumpTo(clientName) {\n    window.location.href = this.tokenConfig[clientName + '_frontend_url'];\n  }\n\n  private hasAccessToAdmin() {\n    const roles = this.verdocsStateService.getRAccountRoles();\n    return includes(roles, 'owner') || includes(roles, 'admin');\n  }\n\n  createSnackbar(message: string, buttonTitle?: string) {\n    if (!buttonTitle) {\n      buttonTitle = null;\n    }\n    let snackbarConfig: MatSnackBarConfig\n    if (window.innerWidth >= 920) {\n      snackbarConfig = {\n        verticalPosition: 'bottom',\n        horizontalPosition: 'left',\n        duration: 5000\n      }\n    } else {\n      snackbarConfig = {\n        verticalPosition: 'top',\n        duration: 5000\n      }\n    }\n    this.snackbar.open(message, buttonTitle, snackbarConfig);\n  }\n\n  lunchElevio() {\n    window['lunchElevio']();\n  }\n\n  lunchIntercom() {\n    window['lunchIntercom']()\n  }\n}\n","import { NgModule, InjectionToken } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { HttpClientModule } from '@angular/common/http';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\nimport { MatAutocompleteModule } from '@angular/material/autocomplete';\nimport { MatButtonModule } from '@angular/material/button';\nimport { MatChipsModule } from '@angular/material/chips';\nimport { MatDialogModule } from '@angular/material/dialog';\nimport { MatIconModule } from '@angular/material/icon';\nimport { MatRadioModule } from '@angular/material/radio';\nimport { MatSelectModule } from '@angular/material/select';\nimport { MatSnackBarModule } from '@angular/material/snack-bar';\nimport { MatProgressSpinnerModule } from '@angular/material/progress-spinner';\nimport { MatTooltipModule } from '@angular/material/tooltip';\nimport {\n  NotificationsModule\n} from '@verdocs/notifications'\nimport { TokensModule } from '@verdocs/tokens';\nimport { ProfilesModule } from '@verdocs/profiles';\nimport { RecipientEditorComponent } from './template/recipients/recipients-editor.component'\nimport { TemplateSourceComponent } from './template/source-file/source-file.component'\nimport { VisibilityEditorComponent } from './template/visibility/visibility-editor.component'\nimport { HeaderComponent } from './header.component';\nimport { VerdocsHeaderService } from './services/header.service';\nimport { TemplatesGuardService } from './services/templates.guard';\nimport { HeaderToolsComponent } from './components/header-tools.component';\nimport { FourOhOneDialog } from './error-dialogs/four-oh-one.dialog';\n\nexport interface connectionConfig {\n  rForm_backend_url: string;\n  rForm_frontend_url: string;\n  rSecure_frontend_url: string;\n  rSecure_backend_url: string;\n  rAccount_frontend_url: string;\n  rAccount_backend_url: string;\n  rNotification_backend_url: string;\n  origin?: 'rForm' | 'rAccount' | 'rSecure';\n  app_version?: string;\n}\n\nexport const connectionConfigToken = new InjectionToken<connectionConfig>('connectionConfig');\n\n@NgModule({\n  declarations: [\n    HeaderComponent,\n    RecipientEditorComponent,\n    TemplateSourceComponent,\n    VisibilityEditorComponent,\n    HeaderToolsComponent,\n    FourOhOneDialog\n  ],\n  entryComponents: [\n    FourOhOneDialog\n  ],\n  imports: [\n    CommonModule,\n    FormsModule,\n    HttpClientModule,\n    RouterModule,\n    ReactiveFormsModule,\n    MatSnackBarModule,\n    MatIconModule,\n    MatAutocompleteModule,\n    MatButtonModule,\n    MatSelectModule,\n    MatDialogModule,\n    MatChipsModule,\n    MatProgressSpinnerModule,\n    MatRadioModule,\n    MatTooltipModule,\n    NotificationsModule,\n    ProfilesModule,\n    TokensModule\n  ],\n  providers: [\n    TemplatesGuardService,\n    VerdocsHeaderService\n  ],\n  exports: [\n    HeaderComponent,\n    RecipientEditorComponent,\n    TemplateSourceComponent,\n    VisibilityEditorComponent,\n    HeaderToolsComponent,\n    FourOhOneDialog\n  ]\n})\nexport class HeaderModule {\n  static initVerdocsHeader(config: connectionConfig) {\n    return {\n      ngModule: HeaderModule,\n      providers: [\n        {\n          provide: connectionConfigToken,\n          useValue: config\n        }\n      ]\n    }\n  }\n}\n"]}